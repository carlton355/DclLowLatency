import { Vector3, Quaternion } from '@dcl/ecs-math';
import { CameraMode } from './Types';
/**
 * @public
 */
var Camera = /** @class */ (function () {
    function Camera() {
        var _this = this;
        /** Camera position, relative to the parcel. */
        this.position = new Vector3();
        /** Camera rotation */
        this.rotation = new Quaternion();
        /** Feet position, relative to the parcel.  */
        this.feetPosition = new Vector3();
        /** Camera position, absolute. */
        this.worldPosition = new Vector3();
        // @internal
        this.lastEventPosition = { x: 0, y: 0, z: 0 };
        // @internal
        this.lastEventWorldPosition = { x: 0, y: 0, z: 0 };
        // @internal
        this.lastEventRotation = { x: 0, y: 0, z: 0, w: 1.0 };
        // @internal
        this._playerHeight = 1.6;
        // @internal
        this._cameraMode = CameraMode.ThirdPerson;
        if (typeof dcl !== 'undefined') {
            dcl.subscribe('positionChanged');
            dcl.subscribe('rotationChanged');
            dcl.subscribe('cameraModeChanged');
            dcl.onEvent(function (event) {
                switch (event.type) {
                    case 'positionChanged':
                        _this.positionChanged(event.data);
                        break;
                    case 'rotationChanged':
                        _this.rotationChanged(event.data);
                        break;
                    case 'cameraModeChanged':
                        _this.cameraModeChanged(event.data);
                        break;
                }
            });
        }
        Object.defineProperty(this.position, 'x', {
            get: function () { return _this.lastEventPosition.x; }
        });
        Object.defineProperty(this.position, 'y', {
            get: function () { return _this.lastEventPosition.y; }
        });
        Object.defineProperty(this.position, 'z', {
            get: function () { return _this.lastEventPosition.z; }
        });
        Object.defineProperty(this.worldPosition, 'x', {
            get: function () { return _this.lastEventWorldPosition.x; }
        });
        Object.defineProperty(this.worldPosition, 'y', {
            get: function () { return _this.lastEventWorldPosition.y; }
        });
        Object.defineProperty(this.worldPosition, 'z', {
            get: function () { return _this.lastEventWorldPosition.z; }
        });
        Object.defineProperty(this.feetPosition, 'x', {
            get: function () { return _this.lastEventPosition.x; }
        });
        Object.defineProperty(this.feetPosition, 'y', {
            get: function () { return _this.lastEventPosition.y - _this.playerHeight; }
        });
        Object.defineProperty(this.feetPosition, 'z', {
            get: function () { return _this.lastEventPosition.z; }
        });
        Object.defineProperty(this.rotation, 'x', {
            get: function () { return _this.lastEventRotation.x; }
        });
        Object.defineProperty(this.rotation, 'y', {
            get: function () { return _this.lastEventRotation.y; }
        });
        Object.defineProperty(this.rotation, 'z', {
            get: function () { return _this.lastEventRotation.z; }
        });
        Object.defineProperty(this.rotation, 'w', {
            get: function () { return _this.lastEventRotation.w; }
        });
    }
    Object.defineProperty(Camera, "instance", {
        get: function () {
            if (!Camera._instance) {
                Camera._instance = new Camera();
            }
            return Camera._instance;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(Camera.prototype, "playerHeight", {
        /** Player height. */
        get: function () {
            return this._playerHeight;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(Camera.prototype, "cameraMode", {
        /** @deprecated Use onCameraModeChangedObservable Observable instead. */
        get: function () {
            return this._cameraMode;
        },
        enumerable: false,
        configurable: true
    });
    // @internal
    Camera.prototype.positionChanged = function (e) {
        this.lastEventPosition = e.position;
        this.lastEventWorldPosition = e.cameraPosition;
        this._playerHeight = e.playerHeight;
    };
    // @internal
    Camera.prototype.rotationChanged = function (e) {
        this.lastEventRotation = e.quaternion;
    };
    // @internal
    Camera.prototype.cameraModeChanged = function (e) {
        this._cameraMode = e.cameraMode;
    };
    return Camera;
}());
export { Camera };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ2FtZXJhLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2RlY2VudHJhbGFuZC9DYW1lcmEudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUE7QUFFbkQsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLFNBQVMsQ0FBQTtBQUVwQzs7R0FFRztBQUNIO0lBNENFO1FBQUEsaUJBd0VDO1FBekdELCtDQUErQztRQUMvQixhQUFRLEdBQVksSUFBSSxPQUFPLEVBQUUsQ0FBQTtRQUNqRCxzQkFBc0I7UUFDTixhQUFRLEdBQWUsSUFBSSxVQUFVLEVBQUUsQ0FBQTtRQUV2RCw4Q0FBOEM7UUFDOUIsaUJBQVksR0FBWSxJQUFJLE9BQU8sRUFBRSxDQUFBO1FBQ3JELGlDQUFpQztRQUNqQixrQkFBYSxHQUFZLElBQUksT0FBTyxFQUFFLENBQUE7UUFZdEQsWUFBWTtRQUNKLHNCQUFpQixHQUFvQixFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUE7UUFDakUsWUFBWTtRQUNKLDJCQUFzQixHQUFvQixFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUE7UUFFdEUsWUFBWTtRQUNKLHNCQUFpQixHQUF1QixFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQTtRQUU1RSxZQUFZO1FBQ0osa0JBQWEsR0FBVyxHQUFHLENBQUE7UUFDbkMsWUFBWTtRQUNKLGdCQUFXLEdBQWUsVUFBVSxDQUFDLFdBQVcsQ0FBQTtRQUd0RCxJQUFJLE9BQU8sR0FBRyxLQUFLLFdBQVcsRUFBRTtZQUM5QixHQUFHLENBQUMsU0FBUyxD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LENBQUMsY0FBYyxDQUFBO1FBQzlDLElBQUksQ0FBQyxhQUFhLEdBQUcsQ0FBQyxDQUFDLFlBQVksQ0FBQTtJQUNyQyxDQUFDO0lBRUQsWUFBWTtJQUNKLGdDQUFlLEdBQXZCLFVBQXdCLENBQTZCO1FBQ25ELElBQUksQ0FBQyxpQkFBaUIsR0FBRyxDQUFDLENBQUMsVUFBVSxDQUFBO0lBQ3ZDLENBQUM7SUFFRCxZQUFZO0lBQ0osa0NBQWlCLEdBQXpCLFVBQTBCLENBQStCO1FBQ3ZELElBQUksQ0FBQyxXQUFXLEdBQUcsQ0FBQyxDQUFDLFVBQVUsQ0FBQTtJQUNqQyxDQUFDO0lBQ0gsYUFBQztBQUFELENBQUMsQUF0SUQsSUFzSUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWZWN0b3IzLCBRdWF0ZXJuaW9uIH0gZnJvbSAnQGRjbC9lY3MtbWF0aCdcblxuaW1wb3J0IHsgQ2FtZXJhTW9kZSB9IGZyb20gJy4vVHlwZXMnXG5cbi8qKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgY2xhc3MgQ2FtZXJhIHtcbiAgLy8gQGludGVybmFsXG4gIHByaXZhdGUgc3RhdGljIF9pbnN0YW5jZTogQ2FtZXJhXG5cbiAgc3RhdGljIGdldCBpbnN0YW5jZSgpOiBDYW1lcmEge1xuICAgIGlmICghQ2FtZXJhLl9pbnN0YW5jZSkge1xuICAgICAgQ2FtZXJhLl9pbnN0YW5jZSA9IG5ldyBDYW1lcmEoKVxuICAgIH1cbiAgICByZXR1cm4gQ2FtZXJhLl9pbnN0YW5jZVxuICB9XG5cbiAgLyoqIENhbWVyYSBwb3NpdGlvbiwgcmVsYXRpdmUgdG8gdGhlIHBhcmNlbC4gKi9cbiAgcHVibGljIHJlYWRvbmx5IHBvc2l0aW9uOiBWZWN0b3IzID0gbmV3IFZlY3RvcjMoKVxuICAvKiogQ2FtZXJhIHJvdGF0aW9uICovXG4gIHB1YmxpYyByZWFkb25seSByb3RhdGlvbjogUXVhdGVybmlvbiA9IG5ldyBRdWF0ZXJuaW9uKClcblxuICAvKiogRmVldCBwb3NpdGlvbiwgcmVsYXRpdmUgdG8gdGhlIHBhcmNlbC4gICovXG4gIHB1YmxpYyByZWFkb25seSBmZWV0UG9zaXRpb246IFZlY3RvcjMgPSBuZXcgVmVjdG9yMygpXG4gIC8qKiBDYW1lcmEgcG9zaXRpb24sIGFic29sdXRlLiAqL1xuICBwdWJsaWMgcmVhZG9ubHkgd29ybGRQb3NpdGlvbjogVmVjdG9yMyA9IG5ldyBWZWN0b3IzKClcblxuICAvKiogUGxheWVyIGhlaWdodC4gKi9cbiAgZ2V0IHBsYXllckhlaWdodCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9wbGF5ZXJIZWlnaHRcbiAgfVxuXG4gIC8qKiBAZGVwcmVjYXRlZCBVc2Ugb25DYW1lcmFNb2RlQ2hhbmdlZE9ic2VydmFibGUgT2JzZXJ2YWJsZSBpbnN0ZWFkLiAqL1xuICBnZXQgY2FtZXJhTW9kZSgpOiBDYW1lcmFNb2RlIHtcbiAgICByZXR1cm4gdGhpcy5fY2FtZXJhTW9kZVxuICB9XG5cbiAgLy8gQGludGVybmFsXG4gIHByaXZhdGUgbGFzdEV2ZW50UG9zaXRpb246IFJlYWRPbmx5VmVjdG9yMyA9IHsgeDogMCwgeTogMCwgejogMCB9XG4gIC8vIEBpbnRlcm5hbFxuICBwcml2YXRlIGxhc3RFdmVudFdvcmxkUG9zaXRpb246IFJlYWRPbmx5VmVjdG9yMyA9IHsgeDogMCwgeTogMCwgejogMCB9XG5cbiAgLy8gQGludGVybmFsXG4gIHByaXZhdGUgbGFzdEV2ZW50Um90YXRpb246IFJlYWRPbmx5UXVhdGVybmlvbiA9IHsgeDogMCwgeTogMCwgejogMCwgdzogMS4wIH1cblxuICAvLyBAaW50ZXJuYWxcbiAgcHJpdmF0ZSBfcGxheWVySGVpZ2h0OiBudW1iZXIgPSAxLjZcbiAgLy8gQGludGVybmFsXG4gIHByaXZhdGUgX2NhbWVyYU1vZGU6IENhbWVyYU1vZGUgPSBDYW1lcmFNb2RlLlRoaXJkUGVyc29uXG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgaWYgKHR5cGVvZiBkY2wgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBkY2wuc3Vic2NyaWJlKCdwb3NpdGlvbkNoYW5nZWQnKVxuICAgICAgZGNsLnN1YnNjcmliZSgncm90YXRpb25DaGFuZ2VkJylcbiAgICAgIGRjbC5zdWJzY3JpYmUoJ2NhbWVyYU1vZGVDaGFuZ2VkJylcblxuICAgICAgZGNsLm9uRXZlbnQoKGV2ZW50KSA9PiB7XG4gICAgICAgIHN3aXRjaCAoZXZlbnQudHlwZSkge1xuICAgICAgICAgIGNhc2UgJ3Bvc2l0aW9uQ2hhbmdlZCc6XG4gICAgICAgICAgICB0aGlzLnBvc2l0aW9uQ2hhbmdlZChldmVudC5kYXRhIGFzIGFueSlcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgY2FzZSAncm90YXRpb25DaGFuZ2VkJzpcbiAgICAgICAgICAgIHRoaXMucm90YXRpb25DaGFuZ2VkKGV2ZW50LmRhdGEgYXMgYW55KVxuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICBjYXNlICdjYW1lcmFNb2RlQ2hhbmdlZCc6XG4gICAgICAgICAgICB0aGlzLmNhbWVyYU1vZGVDaGFuZ2VkKGV2ZW50LmRhdGEgYXMgYW55KVxuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcy5wb3NpdGlvbiwgJ3gnLCB7XG4gICAgICBnZXQ6ICgpID0+IHRoaXMubGFzdEV2ZW50UG9zaXRpb24ueFxuICAgIH0pXG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcy5wb3NpdGlvbiwgJ3knLCB7XG4gICAgICBnZXQ6ICgpID0+IHRoaXMubGFzdEV2ZW50UG9zaXRpb24ueVxuICAgIH0pXG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcy5wb3NpdGlvbiwgJ3onLCB7XG4gICAgICBnZXQ6ICgpID0+IHRoaXMubGFzdEV2ZW50UG9zaXRpb24uelxuICAgIH0pXG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcy53b3JsZFBvc2l0aW9uLCAneCcsIHtcbiAgICAgIGdldDogKCkgPT4gdGhpcy5sYXN0RXZlbnRXb3JsZFBvc2l0aW9uLnhcbiAgICB9KVxuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMud29ybGRQb3NpdGlvbiwgJ3knLCB7XG4gICAgICBnZXQ6ICgpID0+IHRoaXMubGFzdEV2ZW50V29ybGRQb3NpdGlvbi55XG4gICAgfSlcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLndvcmxkUG9zaXRpb24sICd6Jywge1xuICAgICAgZ2V0OiAoKSA9PiB0aGlzLmxhc3RFdmVudFdvcmxkUG9zaXRpb24uelxuICAgIH0pXG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcy5mZWV0UG9zaXRpb24sICd4Jywge1xuICAgICAgZ2V0OiAoKSA9PiB0aGlzLmxhc3RFdmVudFBvc2l0aW9uLnhcbiAgICB9KVxuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMuZmVldFBvc2l0aW9uLCAneScsIHtcbiAgICAgIGdldDogKCkgPT4gdGhpcy5sYXN0RXZlbnRQb3NpdGlvbi55IC0gdGhpcy5wbGF5ZXJIZWlnaHRcbiAgICB9KVxuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMuZmVldFBvc2l0aW9uLCAneicsIHtcbiAgICAgIGdldDogKCkgPT4gdGhpcy5sYXN0RXZlbnRQb3NpdGlvbi56XG4gICAgfSlcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLnJvdGF0aW9uLCAneCcsIHtcbiAgICAgIGdldDogKCkgPT4gdGhpcy5sYXN0RXZlbnRSb3RhdGlvbi54XG4gICAgfSlcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLnJvdGF0aW9uLCAneScsIHtcbiAgICAgIGdldDogKCkgPT4gdGhpcy5sYXN0RXZlbnRSb3RhdGlvbi55XG4gICAgfSlcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLnJvdGF0aW9uLCAneicsIHtcbiAgICAgIGdldDogKCkgPT4gdGhpcy5sYXN0RXZlbnRSb3RhdGlvbi56XG4gICAgfSlcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLnJvdGF0aW9uLCAndycsIHtcbiAgICAgIGdldDogKCkgPT4gdGhpcy5sYXN0RXZlbnRSb3RhdGlvbi53XG4gICAgfSlcbiAgfVxuXG4gIC8vIEBpbnRlcm5hbFxuICBwcml2YXRlIHBvc2l0aW9uQ2hhbmdlZChlOiBJRXZlbnRzWydwb3NpdGlvbkNoYW5nZWQnXSkge1xuICAgIHRoaXMubGFzdEV2ZW50UG9zaXRpb24gPSBlLnBvc2l0aW9uXG4gICAgdGhpcy5sYXN0RXZlbnRXb3JsZFBvc2l0aW9uID0gZS5jYW1lcmFQb3NpdGlvblxuICAgIHRoaXMuX3BsYXllckhlaWdodCA9IGUucGxheWVySGVpZ2h0XG4gIH1cblxuICAvLyBAaW50ZXJuYWxcbiAgcHJpdmF0ZSByb3RhdGlvbkNoYW5nZWQoZTogSUV2ZW50c1sncm90YXRpb25DaGFuZ2VkJ10pIHtcbiAgICB0aGlzLmxhc3RFdmVudFJvdGF0aW9uID0gZS5xdWF0ZXJuaW9uXG4gIH1cblxuICAvLyBAaW50ZXJuYWxcbiAgcHJpdmF0ZSBjYW1lcmFNb2RlQ2hhbmdlZChlOiBJRXZlbnRzWydjYW1lcmFNb2RlQ2hhbmdlZCddKSB7XG4gICAgdGhpcy5fY2FtZXJhTW9kZSA9IGUuY2FtZXJhTW9kZVxuICB9XG59XG4iXX0=