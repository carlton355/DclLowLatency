"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createWebSocket = void 0;
function createWebSocket({ canUseWebsocket, previewMode, log }) {
    return class RestrictedWebSocket extends WebSocket {
        constructor(url, protocols) {
            if (url.toString().toLowerCase().substr(0, 4) !== 'wss:') {
                if (previewMode) {
                    log("⚠️ Warning: can't connect to unsafe WebSocket (ws) server in deployed scenes, consider upgrading to wss.");
                }
                else {
                    throw new Error("Can't connect to unsafe WebSocket server");
                }
            }
            if (!canUseWebsocket) {
                throw new Error("This scene doesn't have allowed to use WebSocket");
            }
            super(url.toString(), protocols);
        }
    };
}
exports.createWebSocket = createWebSocket;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiV2ViU29ja2V0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3dvcmtlci9XZWJTb2NrZXQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBTUEsU0FBZ0IsZUFBZSxDQUFDLEVBQUUsZUFBZSxFQUFFLFdBQVcsRUFBRSxHQUFHLEVBQXlCO0lBQzFGLE9BQU8sTUFBTSxtQkFBb0IsU0FBUSxTQUFTO1FBQ2hELFlBQVksR0FBaUIsRUFBRSxTQUE2QjtZQUMxRCxJQUFJLEdBQUcsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxLQUFLLE1BQU0sRUFBRTtnQkFDeEQsSUFBSSxXQUFXLEVBQUU7b0JBQ2YsR0FBRyxDQUNELDBHQUEwRyxDQUMzRyxDQUFBO2lCQUNGO3FCQUFNO29CQUNMLE1BQU0sSUFBSSxLQUFLLENBQUMsMENBQTBDLENBQUMsQ0FBQTtpQkFDNUQ7YUFDRjtZQUVELElBQUksQ0FBQyxlQUFlLEVBQUU7Z0JBQ3BCLE1BQU0sSUFBSSxLQUFLLENBQUMsa0RBQWtELENBQUMsQ0FBQTthQUNwRTtZQUVELEtBQUssQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFFLEVBQUUsU0FBUyxDQUFDLENBQUE7UUFDbEMsQ0FBQztLQUNGLENBQUE7QUFDSCxDQUFDO0FBcEJELDBDQW9CQyJ9