(()=>{var mc=Object.create,Vr=Object.defineProperty;var Rc=Object.getOwnPropertyDescriptor;var Pc=Object.getOwnPropertyNames;var gc=Object.getPrototypeOf,Sc=Object.prototype.hasOwnProperty;var xc=n=>Vr(n,"__esModule",{value:!0});var Tc=(n,e)=>()=>(n&&(e=n(n=0)),e),x=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var Ic=(n,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Pc(e))!Sc.call(n,r)&&r!=="default"&&Vr(n,r,{get:()=>e[r],enumerable:!(t=Rc(e,r))||t.enumerable});return n},C=n=>Ic(xc(Vr(n!=null?mc(gc(n)):{},"default",n&&n.__esModule&&"default"in n?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0})),n);var f=Tc(()=>{globalThis.WebAssembly.Instance=function(){throw new Error("Wasm is not allowed in scene runtimes")};globalThis.WebAssembly.Module=function(){throw new Error("Wasm is not allowed in scene runtimes")}});var xo=x(So=>{f();"use strict";Object.defineProperty(So,"__esModule",{value:!0})});var rr=x((bh,To)=>{f();To.exports=function(n){return{all:n=n||new Map,on:function(e,t){var r=n.get(e);r?r.push(t):n.set(e,[t])},off:function(e,t){var r=n.get(e);r&&(t?r.splice(r.indexOf(t)>>>0,1):n.set(e,[]))},emit:function(e,t){var r=n.get(e);r&&r.slice().map(function(i){i(t)}),(r=n.get("*"))&&r.slice().map(function(i){i(e,t)})}}}});var Eo=x((Ah,Io)=>{f();"use strict";Io.exports=Ec;function Ec(n,e){for(var t=new Array(arguments.length-1),r=0,i=2,o=!0;i<arguments.length;)t[r++]=arguments[i++];return new Promise(function(d,s){t[r]=function(u){if(o)if(o=!1,u)s(u);else{for(var c=new Array(arguments.length-1),h=0;h<c.length;)c[h++]=arguments[h];d.apply(null,c)}};try{n.apply(e||null,t)}catch(l){o&&(o=!1,s(l))}})}});var wo=x(vo=>{f();"use strict";var ir=vo;ir.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&e.charAt(t)==="=";)++r;return Math.ceil(e.length*3)/4-r};var Gn=new Array(64),ko=new Array(123);for(var en=0;en<64;)ko[Gn[en]=en<26?en+65:en<52?en+71:en<62?en-4:en-59|43]=en++;ir.encode=function(e,t,r){for(var i=null,o=[],a=0,d=0,s;t<r;){var l=e[t++];switch(d){case 0:o[a++]=Gn[l>>2],s=(l&3)<<4,d=1;break;case 1:o[a++]=Gn[s|l>>4],s=(l&15)<<2,d=2;break;case 2:o[a++]=Gn[s|l>>6],o[a++]=Gn[l&63],d=0;break}a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0)}return d&&(o[a++]=Gn[s],o[a++]=61,d===1&&(o[a++]=61)),i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))};var _o="invalid encoding";ir.decode=function(e,t,r){for(var i=r,o=0,a,d=0;d<e.length;){var s=e.charCodeAt(d++);if(s===61&&o>1)break;if((s=ko[s])===void 0)throw Error(_o);switch(o){case 0:a=s,o=1;break;case 1:t[r++]=a<<2|(s&48)>>4,a=s,o=2;break;case 2:t[r++]=(a&15)<<4|(s&60)>>2,a=s,o=3;break;case 3:t[r++]=(a&3)<<6|s,o=0;break}}if(o===1)throw Error(_o);return r-i};ir.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var Bo=x((Oh,Co)=>{f();"use strict";Co.exports=or;function or(){this._listeners={}}or.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this};or.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var r=this._listeners[e],i=0;i<r.length;)r[i].fn===t?r.splice(i,1):++i;return this};or.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],i=1;i<arguments.length;)r.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,r)}return this}});var Do=x((Mh,Uo)=>{f();"use strict";Uo.exports=bo(bo);function bo(n){return typeof Float32Array!="undefined"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),r=t[3]===128;function i(s,l,u){e[0]=s,l[u]=t[0],l[u+1]=t[1],l[u+2]=t[2],l[u+3]=t[3]}function o(s,l,u){e[0]=s,l[u]=t[3],l[u+1]=t[2],l[u+2]=t[1],l[u+3]=t[0]}n.writeFloatLE=r?i:o,n.writeFloatBE=r?o:i;function a(s,l){return t[0]=s[l],t[1]=s[l+1],t[2]=s[l+2],t[3]=s[l+3],e[0]}function d(s,l){return t[3]=s[l],t[2]=s[l+1],t[1]=s[l+2],t[0]=s[l+3],e[0]}n.readFloatLE=r?a:d,n.readFloatBE=r?d:a}():function(){function e(r,i,o,a){var d=i<0?1:0;if(d&&(i=-i),i===0)r(1/i>0?0:2147483648,o,a);else if(isNaN(i))r(2143289344,o,a);else if(i>34028234663852886e22)r((d<<31|2139095040)>>>0,o,a);else if(i<11754943508222875e-54)r((d<<31|Math.round(i/1401298464324817e-60))>>>0,o,a);else{var s=Math.floor(Math.log(i)/Math.LN2),l=Math.round(i*Math.pow(2,-s)*8388608)&8388607;r((d<<31|s+127<<23|l)>>>0,o,a)}}n.writeFloatLE=e.bind(null,Ao),n.writeFloatBE=e.bind(null,No);function t(r,i,o){var a=r(i,o),d=(a>>31)*2+1,s=a>>>23&255,l=a&8388607;return s===255?l?NaN:d*Infinity:s===0?d*1401298464324817e-60*l:d*Math.pow(2,s-150)*(l+8388608)}n.readFloatLE=t.bind(null,Oo),n.readFloatBE=t.bind(null,Mo)}(),typeof Float64Array!="undefined"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),r=t[7]===128;function i(s,l,u){e[0]=s,l[u]=t[0],l[u+1]=t[1],l[u+2]=t[2],l[u+3]=t[3],l[u+4]=t[4],l[u+5]=t[5],l[u+6]=t[6],l[u+7]=t[7]}function o(s,l,u){e[0]=s,l[u]=t[7],l[u+1]=t[6],l[u+2]=t[5],l[u+3]=t[4],l[u+4]=t[3],l[u+5]=t[2],l[u+6]=t[1],l[u+7]=t[0]}n.writeDoubleLE=r?i:o,n.writeDoubleBE=r?o:i;function a(s,l){return t[0]=s[l],t[1]=s[l+1],t[2]=s[l+2],t[3]=s[l+3],t[4]=s[l+4],t[5]=s[l+5],t[6]=s[l+6],t[7]=s[l+7],e[0]}function d(s,l){return t[7]=s[l],t[6]=s[l+1],t[5]=s[l+2],t[4]=s[l+3],t[3]=s[l+4],t[2]=s[l+5],t[1]=s[l+6],t[0]=s[l+7],e[0]}n.readDoubleLE=r?a:d,n.readDoubleBE=r?d:a}():function(){function e(r,i,o,a,d,s){var l=a<0?1:0;if(l&&(a=-a),a===0)r(0,d,s+i),r(1/a>0?0:2147483648,d,s+o);else if(isNaN(a))r(0,d,s+i),r(2146959360,d,s+o);else if(a>17976931348623157e292)r(0,d,s+i),r((l<<31|2146435072)>>>0,d,s+o);else{var u;if(a<22250738585072014e-324)u=a/5e-324,r(u>>>0,d,s+i),r((l<<31|u/4294967296)>>>0,d,s+o);else{var c=Math.floor(Math.log(a)/Math.LN2);c===1024&&(c=1023),u=a*Math.pow(2,-c),r(u*4503599627370496>>>0,d,s+i),r((l<<31|c+1023<<20|u*1048576&1048575)>>>0,d,s+o)}}}n.writeDoubleLE=e.bind(null,Ao,0,4),n.writeDoubleBE=e.bind(null,No,4,0);function t(r,i,o,a,d){var s=r(a,d+i),l=r(a,d+o),u=(l>>31)*2+1,c=l>>>20&2047,h=4294967296*(l&1048575)+s;return c===2047?h?NaN:u*Infinity:c===0?u*5e-324*h:u*Math.pow(2,c-1075)*(h+4503599627370496)}n.readDoubleLE=t.bind(null,Oo,0,4),n.readDoubleBE=t.bind(null,Mo,4,0)}(),n}function Ao(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}function No(n,e,t){e[t]=n>>>24,e[t+1]=n>>>16&255,e[t+2]=n>>>8&255,e[t+3]=n&255}function Oo(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24)>>>0}function Mo(n,e){return(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}});var Wo=x((exports,module)=>{f();"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(n){}return null}});var Fo=x(qo=>{f();"use strict";var Zr=qo;Zr.length=function(e){for(var t=0,r=0,i=0;i<e.length;++i)r=e.charCodeAt(i),r<128?t+=1:r<2048?t+=2:(r&64512)==55296&&(e.charCodeAt(i+1)&64512)==56320?(++i,t+=4):t+=3;return t};Zr.read=function(e,t,r){var i=r-t;if(i<1)return"";for(var o=null,a=[],d=0,s;t<r;)s=e[t++],s<128?a[d++]=s:s>191&&s<224?a[d++]=(s&31)<<6|e[t++]&63:s>239&&s<365?(s=((s&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,a[d++]=55296+(s>>10),a[d++]=56320+(s&1023)):a[d++]=(s&15)<<12|(e[t++]&63)<<6|e[t++]&63,d>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),d=0);return o?(d&&o.push(String.fromCharCode.apply(String,a.slice(0,d))),o.join("")):String.fromCharCode.apply(String,a.slice(0,d))};Zr.write=function(e,t,r){for(var i=r,o,a,d=0;d<e.length;++d)o=e.charCodeAt(d),o<128?t[r++]=o:o<2048?(t[r++]=o>>6|192,t[r++]=o&63|128):(o&64512)==55296&&((a=e.charCodeAt(d+1))&64512)==56320?(o=65536+((o&1023)<<10)+(a&1023),++d,t[r++]=o>>18|240,t[r++]=o>>12&63|128,t[r++]=o>>6&63|128,t[r++]=o&63|128):(t[r++]=o>>12|224,t[r++]=o>>6&63|128,t[r++]=o&63|128);return r-i}});var zo=x((Dh,Jo)=>{f();"use strict";Jo.exports=kc;function kc(n,e,t){var r=t||8192,i=r>>>1,o=null,a=r;return function(s){if(s<1||s>i)return n(s);a+s>r&&(o=n(r),a=0);var l=e.call(o,a,a+=s);return a&7&&(a=(a|7)+1),l}}});var Go=x((Wh,Lo)=>{f();"use strict";Lo.exports=se;var dt=xn();function se(n,e){this.lo=n>>>0,this.hi=e>>>0}var Nn=se.zero=new se(0,0);Nn.toNumber=function(){return 0};Nn.zzEncode=Nn.zzDecode=function(){return this};Nn.length=function(){return 1};var _c=se.zeroHash="\0\0\0\0\0\0\0\0";se.fromNumber=function(e){if(e===0)return Nn;var t=e<0;t&&(e=-e);var r=e>>>0,i=(e-r)/4294967296>>>0;return t&&(i=~i>>>0,r=~r>>>0,++r>4294967295&&(r=0,++i>4294967295&&(i=0))),new se(r,i)};se.from=function(e){if(typeof e=="number")return se.fromNumber(e);if(dt.isString(e))if(dt.Long)e=dt.Long.fromString(e);else return se.fromNumber(parseInt(e,10));return e.low||e.high?new se(e.low>>>0,e.high>>>0):Nn};se.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+r*4294967296)}return this.lo+this.hi*4294967296};se.prototype.toLong=function(e){return dt.Long?new dt.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var Sn=String.prototype.charCodeAt;se.fromHash=function(e){return e===_c?Nn:new se((Sn.call(e,0)|Sn.call(e,1)<<8|Sn.call(e,2)<<16|Sn.call(e,3)<<24)>>>0,(Sn.call(e,4)|Sn.call(e,5)<<8|Sn.call(e,6)<<16|Sn.call(e,7)<<24)>>>0)};se.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};se.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};se.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};se.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return r===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}});var xn=x(jr=>{f();"use strict";var I=jr;I.asPromise=Eo();I.base64=wo();I.EventEmitter=Bo();I.float=Do();I.inquire=Wo();I.utf8=Fo();I.pool=zo();I.LongBits=Go();I.isNode=Boolean(typeof global!="undefined"&&global&&global.process&&global.process.versions&&global.process.versions.node);I.global=I.isNode&&global||typeof window!="undefined"&&window||typeof self!="undefined"&&self||jr;I.emptyArray=Object.freeze?Object.freeze([]):[];I.emptyObject=Object.freeze?Object.freeze({}):{};I.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};I.isString=function(e){return typeof e=="string"||e instanceof String};I.isObject=function(e){return e&&typeof e=="object"};I.isset=I.isSet=function(e,t){var r=e[t];return r!=null&&e.hasOwnProperty(t)?typeof r!="object"||(Array.isArray(r)?r.length:Object.keys(r).length)>0:!1};I.Buffer=function(){try{var n=I.inquire("buffer").Buffer;return n.prototype.utf8Write?n:null}catch(e){return null}}();I._Buffer_from=null;I._Buffer_allocUnsafe=null;I.newBuffer=function(e){return typeof e=="number"?I.Buffer?I._Buffer_allocUnsafe(e):new I.Array(e):I.Buffer?I._Buffer_from(e):typeof Uint8Array=="undefined"?e:new Uint8Array(e)};I.Array=typeof Uint8Array!="undefined"?Uint8Array:Array;I.Long=I.global.dcodeIO&&I.global.dcodeIO.Long||I.global.Long||I.inquire("long");I.key2Re=/^true|false|0|1$/;I.key32Re=/^-?(?:0|[1-9][0-9]*)$/;I.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;I.longToHash=function(e){return e?I.LongBits.from(e).toHash():I.LongBits.zeroHash};I.longFromHash=function(e,t){var r=I.LongBits.fromHash(e);return I.Long?I.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))};function $o(n,e,t){for(var r=Object.keys(e),i=0;i<r.length;++i)(n[r[i]]===void 0||!t)&&(n[r[i]]=e[r[i]]);return n}I.merge=$o;I.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function Ho(n){function e(t,r){if(!(this instanceof e))return new e(t,r);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),r&&$o(this,r)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return n}}),e.prototype.toString=function(){return this.name+": "+this.message},e}I.newError=Ho;I.ProtocolError=Ho("ProtocolError");I.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var i=Object.keys(this),o=i.length-1;o>-1;--o)if(t[i[o]]===1&&this[i[o]]!==void 0&&this[i[o]]!==null)return i[o]}};I.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}};I.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};I._configure=function(){var n=I.Buffer;if(!n){I._Buffer_from=I._Buffer_allocUnsafe=null;return}I._Buffer_from=n.from!==Uint8Array.from&&n.from||function(t,r){return new n(t,r)},I._Buffer_allocUnsafe=n.allocUnsafe||function(t){return new n(t)}}});var ai=x((Fh,Qo)=>{f();"use strict";Qo.exports=A;var Je=xn(),ei,ar=Je.LongBits,Yo=Je.base64,Ko=Je.utf8;function lt(n,e,t){this.fn=n,this.len=e,this.next=void 0,this.val=t}function ni(){}function vc(n){this.head=n.head,this.tail=n.tail,this.len=n.len,this.next=n.states}function A(){this.len=0,this.head=new lt(ni,0,0),this.tail=this.head,this.states=null}var Xo=function(){return Je.Buffer?function(){return(A.create=function(){return new ei})()}:function(){return new A}};A.create=Xo();A.alloc=function(e){return new Je.Array(e)};Je.Array!==Array&&(A.alloc=Je.pool(A.alloc,Je.Array.prototype.subarray));A.prototype._push=function(e,t,r){return this.tail=this.tail.next=new lt(e,t,r),this.len+=t,this};function ti(n,e,t){e[t]=n&255}function wc(n,e,t){for(;n>127;)e[t++]=n&127|128,n>>>=7;e[t]=n}function ri(n,e){this.len=n,this.next=void 0,this.val=e}ri.prototype=Object.create(lt.prototype);ri.prototype.fn=wc;A.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new ri((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};A.prototype.int32=function(e){return e<0?this._push(ii,10,ar.fromNumber(e)):this.uint32(e)};A.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function ii(n,e,t){for(;n.hi;)e[t++]=n.lo&127|128,n.lo=(n.lo>>>7|n.hi<<25)>>>0,n.hi>>>=7;for(;n.lo>127;)e[t++]=n.lo&127|128,n.lo=n.lo>>>7;e[t++]=n.lo}A.prototype.uint64=function(e){var t=ar.from(e);return this._push(ii,t.length(),t)};A.prototype.int64=A.prototype.uint64;A.prototype.sint64=function(e){var t=ar.from(e).zzEncode();return this._push(ii,t.length(),t)};A.prototype.bool=function(e){return this._push(ti,1,e?1:0)};function oi(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}A.prototype.fixed32=function(e){return this._push(oi,4,e>>>0)};A.prototype.sfixed32=A.prototype.fixed32;A.prototype.fixed64=function(e){var t=ar.from(e);return this._push(oi,4,t.lo)._push(oi,4,t.hi)};A.prototype.sfixed64=A.prototype.fixed64;A.prototype.float=function(e){return this._push(Je.float.writeFloatLE,4,e)};A.prototype.double=function(e){return this._push(Je.float.writeDoubleLE,8,e)};var Cc=Je.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var i=0;i<e.length;++i)t[r+i]=e[i]};A.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(ti,1,0);if(Je.isString(e)){var r=A.alloc(t=Yo.length(e));Yo.decode(e,r,0),e=r}return this.uint32(t)._push(Cc,t,e)};A.prototype.string=function(e){var t=Ko.length(e);return t?this.uint32(t)._push(Ko.write,t,e):this._push(ti,1,0)};A.prototype.fork=function(){return this.states=new vc(this),this.head=this.tail=new lt(ni,0,0),this.len=0,this};A.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new lt(ni,0,0),this.len=0),this};A.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this};A.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t};A._configure=function(n){ei=n,A.create=Xo(),ei._configure()}});var jo=x((Jh,Zo)=>{f();"use strict";Zo.exports=nn;var Vo=ai();(nn.prototype=Object.create(Vo.prototype)).constructor=nn;var Tn=xn();function nn(){Vo.call(this)}nn._configure=function(){nn.alloc=Tn._Buffer_allocUnsafe,nn.writeBytesBuffer=Tn.Buffer&&Tn.Buffer.prototype instanceof Uint8Array&&Tn.Buffer.prototype.set.name==="set"?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var i=0;i<e.length;)t[r++]=e[i++]}};nn.prototype.bytes=function(e){Tn.isString(e)&&(e=Tn._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(nn.writeBytesBuffer,t,e),this};function Bc(n,e,t){n.length<40?Tn.utf8.write(n,e,t):e.utf8Write?e.utf8Write(n,t):e.write(n,t)}nn.prototype.string=function(e){var t=Tn.Buffer.byteLength(e);return this.uint32(t),t&&this._push(Bc,t,e),this};nn._configure()});var li=x((zh,ia)=>{f();"use strict";ia.exports=te;var tn=xn(),si,ea=tn.LongBits,bc=tn.utf8;function Qe(n,e){return RangeError("index out of range: "+n.pos+" + "+(e||1)+" > "+n.len)}function te(n){this.buf=n,this.pos=0,this.len=n.length}var na=typeof Uint8Array!="undefined"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new te(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new te(e);throw Error("illegal buffer")},ta=function(){return tn.Buffer?function(t){return(te.create=function(i){return tn.Buffer.isBuffer(i)?new si(i):na(i)})(t)}:na};te.create=ta();te.prototype._slice=tn.Array.prototype.subarray||tn.Array.prototype.slice;te.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Qe(this,10);return e}}();te.prototype.int32=function(){return this.uint32()|0};te.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function di(){var n=new ea(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(n.lo=(n.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return n;if(n.lo=(n.lo|(this.buf[this.pos]&127)<<28)>>>0,n.hi=(n.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return n;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Qe(this);if(n.lo=(n.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return n}return n.lo=(n.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,n}if(this.len-this.pos>4){for(;e<5;++e)if(n.hi=(n.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return n}else for(;e<5;++e){if(this.pos>=this.len)throw Qe(this);if(n.hi=(n.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return n}throw Error("invalid varint encoding")}te.prototype.bool=function(){return this.uint32()!==0};function sr(n,e){return(n[e-4]|n[e-3]<<8|n[e-2]<<16|n[e-1]<<24)>>>0}te.prototype.fixed32=function(){if(this.pos+4>this.len)throw Qe(this,4);return sr(this.buf,this.pos+=4)};te.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Qe(this,4);return sr(this.buf,this.pos+=4)|0};function ra(){if(this.pos+8>this.len)throw Qe(this,8);return new ea(sr(this.buf,this.pos+=4),sr(this.buf,this.pos+=4))}te.prototype.float=function(){if(this.pos+4>this.len)throw Qe(this,4);var e=tn.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};te.prototype.double=function(){if(this.pos+8>this.len)throw Qe(this,4);var e=tn.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};te.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw Qe(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)};te.prototype.string=function(){var e=this.bytes();return bc.read(e,0,e.length)};te.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Qe(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Qe(this);while(this.buf[this.pos++]&128);return this};te.prototype.skipType=function(n){switch(n){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(n=this.uint32()&7)!=4;)this.skipType(n);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+n+" at offset "+this.pos)}return this};te._configure=function(n){si=n,te.create=ta(),si._configure();var e=tn.Long?"toLong":"toNumber";tn.merge(te.prototype,{int64:function(){return di.call(this)[e](!1)},uint64:function(){return di.call(this)[e](!0)},sint64:function(){return di.call(this).zzDecode()[e](!1)},fixed64:function(){return ra.call(this)[e](!0)},sfixed64:function(){return ra.call(this)[e](!1)}})}});var da=x((Lh,sa)=>{f();"use strict";sa.exports=On;var oa=li();(On.prototype=Object.create(oa.prototype)).constructor=On;var aa=xn();function On(n){oa.call(this,n)}On._configure=function(){aa.Buffer&&(On.prototype._slice=aa.Buffer.prototype.slice)};On.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};On._configure()});var ua=x((Gh,la)=>{f();"use strict";la.exports=ut;var ui=xn();(ut.prototype=Object.create(ui.EventEmitter.prototype)).constructor=ut;function ut(n,e,t){if(typeof n!="function")throw TypeError("rpcImpl must be a function");ui.EventEmitter.call(this),this.rpcImpl=n,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(t)}ut.prototype.rpcCall=function n(e,t,r,i,o){if(!i)throw TypeError("request must be specified");var a=this;if(!o)return ui.asPromise(n,a,e,t,r,i);if(!a.rpcImpl){setTimeout(function(){o(Error("already ended"))},0);return}try{return a.rpcImpl(e,t[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(s,l){if(s)return a.emit("error",s,e),o(s);if(l===null){a.end(!0);return}if(!(l instanceof r))try{l=r[a.responseDelimited?"decodeDelimited":"decode"](l)}catch(u){return a.emit("error",u,e),o(u)}return a.emit("data",l,e),o(null,l)})}catch(d){a.emit("error",d,e),setTimeout(function(){o(d)},0);return}};ut.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var fa=x(ca=>{f();"use strict";var Ac=ca;Ac.Service=ua()});var ha=x((Hh,pa)=>{f();"use strict";pa.exports={}});var Ra=x(ma=>{f();"use strict";var ve=ma;ve.build="minimal";ve.Writer=ai();ve.BufferWriter=jo();ve.Reader=li();ve.BufferReader=da();ve.util=xn();ve.rpc=fa();ve.roots=ha();ve.configure=ya;function ya(){ve.util._configure(),ve.Writer._configure(ve.BufferWriter),ve.Reader._configure(ve.BufferReader)}ya()});var $=x((Kh,Pa)=>{f();"use strict";Pa.exports=Ra()});var $n=x(B=>{f();"use strict";var Nc=B&&B.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(B,"__esModule",{value:!0});B.StreamMessage=B.Response=B.RemoteError=B.Request=B.ModuleProcedure=B.DestroyPort=B.RequestModuleResponse=B.RequestModule=B.CreatePortResponse=B.CreatePort=B.RpcMessageHeader=B.rpcMessageTypesToJSON=B.rpcMessageTypesFromJSON=B.RpcMessageTypes=B.protobufPackage=void 0;var N=Nc($());B.protobufPackage="";var J;(function(n){n[n.RpcMessageTypes_EMPTY=0]="RpcMessageTypes_EMPTY",n[n.RpcMessageTypes_REQUEST=1]="RpcMessageTypes_REQUEST",n[n.RpcMessageTypes_RESPONSE=2]="RpcMessageTypes_RESPONSE",n[n.RpcMessageTypes_STREAM_MESSAGE=3]="RpcMessageTypes_STREAM_MESSAGE",n[n.RpcMessageTypes_STREAM_ACK=4]="RpcMessageTypes_STREAM_ACK",n[n.RpcMessageTypes_CREATE_PORT=5]="RpcMessageTypes_CREATE_PORT",n[n.RpcMessageTypes_CREATE_PORT_RESPONSE=6]="RpcMessageTypes_CREATE_PORT_RESPONSE",n[n.RpcMessageTypes_REQUEST_MODULE=7]="RpcMessageTypes_REQUEST_MODULE",n[n.RpcMessageTypes_REQUEST_MODULE_RESPONSE=8]="RpcMessageTypes_REQUEST_MODULE_RESPONSE",n[n.RpcMessageTypes_REMOTE_ERROR_RESPONSE=9]="RpcMessageTypes_REMOTE_ERROR_RESPONSE",n[n.RpcMessageTypes_DESTROY_PORT=10]="RpcMessageTypes_DESTROY_PORT",n[n.RpcMessageTypes_SERVER_READY=11]="RpcMessageTypes_SERVER_READY",n[n.UNRECOGNIZED=-1]="UNRECOGNIZED"})(J=B.RpcMessageTypes||(B.RpcMessageTypes={}));function Oc(n){switch(n){case 0:case"RpcMessageTypes_EMPTY":return J.RpcMessageTypes_EMPTY;case 1:case"RpcMessageTypes_REQUEST":return J.RpcMessageTypes_REQUEST;case 2:case"RpcMessageTypes_RESPONSE":return J.RpcMessageTypes_RESPONSE;case 3:case"RpcMessageTypes_STREAM_MESSAGE":return J.RpcMessageTypes_STREAM_MESSAGE;case 4:case"RpcMessageTypes_STREAM_ACK":return J.RpcMessageTypes_STREAM_ACK;case 5:case"RpcMessageTypes_CREATE_PORT":return J.RpcMessageTypes_CREATE_PORT;case 6:case"RpcMessageTypes_CREATE_PORT_RESPONSE":return J.RpcMessageTypes_CREATE_PORT_RESPONSE;case 7:case"RpcMessageTypes_REQUEST_MODULE":return J.RpcMessageTypes_REQUEST_MODULE;case 8:case"RpcMessageTypes_REQUEST_MODULE_RESPONSE":return J.RpcMessageTypes_REQUEST_MODULE_RESPONSE;case 9:case"RpcMessageTypes_REMOTE_ERROR_RESPONSE":return J.RpcMessageTypes_REMOTE_ERROR_RESPONSE;case 10:case"RpcMessageTypes_DESTROY_PORT":return J.RpcMessageTypes_DESTROY_PORT;case 11:case"RpcMessageTypes_SERVER_READY":return J.RpcMessageTypes_SERVER_READY;case-1:case"UNRECOGNIZED":default:return J.UNRECOGNIZED}}B.rpcMessageTypesFromJSON=Oc;function Mc(n){switch(n){case J.RpcMessageTypes_EMPTY:return"RpcMessageTypes_EMPTY";case J.RpcMessageTypes_REQUEST:return"RpcMessageTypes_REQUEST";case J.RpcMessageTypes_RESPONSE:return"RpcMessageTypes_RESPONSE";case J.RpcMessageTypes_STREAM_MESSAGE:return"RpcMessageTypes_STREAM_MESSAGE";case J.RpcMessageTypes_STREAM_ACK:return"RpcMessageTypes_STREAM_ACK";case J.RpcMessageTypes_CREATE_PORT:return"RpcMessageTypes_CREATE_PORT";case J.RpcMessageTypes_CREATE_PORT_RESPONSE:return"RpcMessageTypes_CREATE_PORT_RESPONSE";case J.RpcMessageTypes_REQUEST_MODULE:return"RpcMessageTypes_REQUEST_MODULE";case J.RpcMessageTypes_REQUEST_MODULE_RESPONSE:return"RpcMessageTypes_REQUEST_MODULE_RESPONSE";case J.RpcMessageTypes_REMOTE_ERROR_RESPONSE:return"RpcMessageTypes_REMOTE_ERROR_RESPONSE";case J.RpcMessageTypes_DESTROY_PORT:return"RpcMessageTypes_DESTROY_PORT";case J.RpcMessageTypes_SERVER_READY:return"RpcMessageTypes_SERVER_READY";case J.UNRECOGNIZED:default:return"UNRECOGNIZED"}}B.rpcMessageTypesToJSON=Mc;function ga(){return{messageIdentifier:0}}B.RpcMessageHeader={encode(n,e=N.default.Writer.create()){return n.messageIdentifier!==0&&e.uint32(13).fixed32(n.messageIdentifier),e},decode(n,e){let t=n instanceof N.default.Reader?n:new N.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=ga();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.messageIdentifier=t.fixed32();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{messageIdentifier:U(n.messageIdentifier)?Number(n.messageIdentifier):0}},toJSON(n){let e={};return n.messageIdentifier!==void 0&&(e.messageIdentifier=Math.round(n.messageIdentifier)),e},fromPartial(n){var e;let t=ga();return t.messageIdentifier=(e=n.messageIdentifier)!==null&&e!==void 0?e:0,t}};function Sa(){return{messageIdentifier:0,portName:""}}B.CreatePort={encode(n,e=N.default.Writer.create()){return n.messageIdentifier!==0&&e.uint32(13).fixed32(n.messageIdentifier),n.portName!==""&&e.uint32(34).string(n.portName),e},decode(n,e){let t=n instanceof N.default.Reader?n:new N.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Sa();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.messageIdentifier=t.fixed32();break;case 4:i.portName=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{messageIdentifier:U(n.messageIdentifier)?Number(n.messageIdentifier):0,portName:U(n.portName)?String(n.portName):""}},toJSON(n){let e={};return n.messageIdentifier!==void 0&&(e.messageIdentifier=Math.round(n.messageIdentifier)),n.portName!==void 0&&(e.portName=n.portName),e},fromPartial(n){var e,t;let r=Sa();return r.messageIdentifier=(e=n.messageIdentifier)!==null&&e!==void 0?e:0,r.portName=(t=n.portName)!==null&&t!==void 0?t:"",r}};function xa(){return{messageIdentifier:0,portId:0}}B.CreatePortResponse={encode(n,e=N.default.Writer.create()){return n.messageIdentifier!==0&&e.uint32(13).fixed32(n.messageIdentifier),n.portId!==0&&e.uint32(21).fixed32(n.portId),e},decode(n,e){let t=n instanceof N.default.Reader?n:new N.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=xa();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.messageIdentifier=t.fixed32();break;case 2:i.portId=t.fixed32();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{messageIdentifier:U(n.messageIdentifier)?Number(n.messageIdentifier):0,portId:U(n.portId)?Number(n.portId):0}},toJSON(n){let e={};return n.messageIdentifier!==void 0&&(e.messageIdentifier=Math.round(n.messageIdentifier)),n.portId!==void 0&&(e.portId=Math.round(n.portId)),e},fromPartial(n){var e,t;let r=xa();return r.messageIdentifier=(e=n.messageIdentifier)!==null&&e!==void 0?e:0,r.portId=(t=n.portId)!==null&&t!==void 0?t:0,r}};function Ta(){return{messageIdentifier:0,portId:0,moduleName:""}}B.RequestModule={encode(n,e=N.default.Writer.create()){return n.messageIdentifier!==0&&e.uint32(13).fixed32(n.messageIdentifier),n.portId!==0&&e.uint32(21).fixed32(n.portId),n.moduleName!==""&&e.uint32(34).string(n.moduleName),e},decode(n,e){let t=n instanceof N.default.Reader?n:new N.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Ta();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.messageIdentifier=t.fixed32();break;case 2:i.portId=t.fixed32();break;case 4:i.moduleName=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{messageIdentifier:U(n.messageIdentifier)?Number(n.messageIdentifier):0,portId:U(n.portId)?Number(n.portId):0,moduleName:U(n.moduleName)?String(n.moduleName):""}},toJSON(n){let e={};return n.messageIdentifier!==void 0&&(e.messageIdentifier=Math.round(n.messageIdentifier)),n.portId!==void 0&&(e.portId=Math.round(n.portId)),n.moduleName!==void 0&&(e.moduleName=n.moduleName),e},fromPartial(n){var e,t,r;let i=Ta();return i.messageIdentifier=(e=n.messageIdentifier)!==null&&e!==void 0?e:0,i.portId=(t=n.portId)!==null&&t!==void 0?t:0,i.moduleName=(r=n.moduleName)!==null&&r!==void 0?r:"",i}};function Ia(){return{messageIdentifier:0,portId:0,procedures:[]}}B.RequestModuleResponse={encode(n,e=N.default.Writer.create()){n.messageIdentifier!==0&&e.uint32(13).fixed32(n.messageIdentifier),n.portId!==0&&e.uint32(21).fixed32(n.portId);for(let t of n.procedures)B.ModuleProcedure.encode(t,e.uint32(42).fork()).ldelim();return e},decode(n,e){let t=n instanceof N.default.Reader?n:new N.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Ia();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.messageIdentifier=t.fixed32();break;case 2:i.portId=t.fixed32();break;case 5:i.procedures.push(B.ModuleProcedure.decode(t,t.uint32()));break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{messageIdentifier:U(n.messageIdentifier)?Number(n.messageIdentifier):0,portId:U(n.portId)?Number(n.portId):0,procedures:Array.isArray(n==null?void 0:n.procedures)?n.procedures.map(e=>B.ModuleProcedure.fromJSON(e)):[]}},toJSON(n){let e={};return n.messageIdentifier!==void 0&&(e.messageIdentifier=Math.round(n.messageIdentifier)),n.portId!==void 0&&(e.portId=Math.round(n.portId)),n.procedures?e.procedures=n.procedures.map(t=>t?B.ModuleProcedure.toJSON(t):void 0):e.procedures=[],e},fromPartial(n){var e,t,r;let i=Ia();return i.messageIdentifier=(e=n.messageIdentifier)!==null&&e!==void 0?e:0,i.portId=(t=n.portId)!==null&&t!==void 0?t:0,i.procedures=((r=n.procedures)===null||r===void 0?void 0:r.map(o=>B.ModuleProcedure.fromPartial(o)))||[],i}};function Ea(){return{messageIdentifier:0,portId:0}}B.DestroyPort={encode(n,e=N.default.Writer.create()){return n.messageIdentifier!==0&&e.uint32(13).fixed32(n.messageIdentifier),n.portId!==0&&e.uint32(21).fixed32(n.portId),e},decode(n,e){let t=n instanceof N.default.Reader?n:new N.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Ea();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.messageIdentifier=t.fixed32();break;case 2:i.portId=t.fixed32();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{messageIdentifier:U(n.messageIdentifier)?Number(n.messageIdentifier):0,portId:U(n.portId)?Number(n.portId):0}},toJSON(n){let e={};return n.messageIdentifier!==void 0&&(e.messageIdentifier=Math.round(n.messageIdentifier)),n.portId!==void 0&&(e.portId=Math.round(n.portId)),e},fromPartial(n){var e,t;let r=Ea();return r.messageIdentifier=(e=n.messageIdentifier)!==null&&e!==void 0?e:0,r.portId=(t=n.portId)!==null&&t!==void 0?t:0,r}};function ka(){return{procedureId:0,procedureName:""}}B.ModuleProcedure={encode(n,e=N.default.Writer.create()){return n.procedureId!==0&&e.uint32(13).fixed32(n.procedureId),n.procedureName!==""&&e.uint32(18).string(n.procedureName),e},decode(n,e){let t=n instanceof N.default.Reader?n:new N.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=ka();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.procedureId=t.fixed32();break;case 2:i.procedureName=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{procedureId:U(n.procedureId)?Number(n.procedureId):0,procedureName:U(n.procedureName)?String(n.procedureName):""}},toJSON(n){let e={};return n.procedureId!==void 0&&(e.procedureId=Math.round(n.procedureId)),n.procedureName!==void 0&&(e.procedureName=n.procedureName),e},fromPartial(n){var e,t;let r=ka();return r.procedureId=(e=n.procedureId)!==null&&e!==void 0?e:0,r.procedureName=(t=n.procedureName)!==null&&t!==void 0?t:"",r}};function _a(){return{messageIdentifier:0,portId:0,procedureId:0,clientStream:0,payload:new Uint8Array}}B.Request={encode(n,e=N.default.Writer.create()){return n.messageIdentifier!==0&&e.uint32(13).fixed32(n.messageIdentifier),n.portId!==0&&e.uint32(21).fixed32(n.portId),n.procedureId!==0&&e.uint32(37).fixed32(n.procedureId),n.clientStream!==0&&e.uint32(45).fixed32(n.clientStream),n.payload.length!==0&&e.uint32(50).bytes(n.payload),e},decode(n,e){let t=n instanceof N.default.Reader?n:new N.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=_a();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.messageIdentifier=t.fixed32();break;case 2:i.portId=t.fixed32();break;case 4:i.procedureId=t.fixed32();break;case 5:i.clientStream=t.fixed32();break;case 6:i.payload=t.bytes();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{messageIdentifier:U(n.messageIdentifier)?Number(n.messageIdentifier):0,portId:U(n.portId)?Number(n.portId):0,procedureId:U(n.procedureId)?Number(n.procedureId):0,clientStream:U(n.clientStream)?Number(n.clientStream):0,payload:U(n.payload)?ci(n.payload):new Uint8Array}},toJSON(n){let e={};return n.messageIdentifier!==void 0&&(e.messageIdentifier=Math.round(n.messageIdentifier)),n.portId!==void 0&&(e.portId=Math.round(n.portId)),n.procedureId!==void 0&&(e.procedureId=Math.round(n.procedureId)),n.clientStream!==void 0&&(e.clientStream=Math.round(n.clientStream)),n.payload!==void 0&&(e.payload=fi(n.payload!==void 0?n.payload:new Uint8Array)),e},fromPartial(n){var e,t,r,i,o;let a=_a();return a.messageIdentifier=(e=n.messageIdentifier)!==null&&e!==void 0?e:0,a.portId=(t=n.portId)!==null&&t!==void 0?t:0,a.procedureId=(r=n.procedureId)!==null&&r!==void 0?r:0,a.clientStream=(i=n.clientStream)!==null&&i!==void 0?i:0,a.payload=(o=n.payload)!==null&&o!==void 0?o:new Uint8Array,a}};function va(){return{messageIdentifier:0,errorCode:0,errorMessage:""}}B.RemoteError={encode(n,e=N.default.Writer.create()){return n.messageIdentifier!==0&&e.uint32(13).fixed32(n.messageIdentifier),n.errorCode!==0&&e.uint32(21).fixed32(n.errorCode),n.errorMessage!==""&&e.uint32(26).string(n.errorMessage),e},decode(n,e){let t=n instanceof N.default.Reader?n:new N.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=va();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.messageIdentifier=t.fixed32();break;case 2:i.errorCode=t.fixed32();break;case 3:i.errorMessage=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{messageIdentifier:U(n.messageIdentifier)?Number(n.messageIdentifier):0,errorCode:U(n.errorCode)?Number(n.errorCode):0,errorMessage:U(n.errorMessage)?String(n.errorMessage):""}},toJSON(n){let e={};return n.messageIdentifier!==void 0&&(e.messageIdentifier=Math.round(n.messageIdentifier)),n.errorCode!==void 0&&(e.errorCode=Math.round(n.errorCode)),n.errorMessage!==void 0&&(e.errorMessage=n.errorMessage),e},fromPartial(n){var e,t,r;let i=va();return i.messageIdentifier=(e=n.messageIdentifier)!==null&&e!==void 0?e:0,i.errorCode=(t=n.errorCode)!==null&&t!==void 0?t:0,i.errorMessage=(r=n.errorMessage)!==null&&r!==void 0?r:"",i}};function wa(){return{messageIdentifier:0,payload:new Uint8Array}}B.Response={encode(n,e=N.default.Writer.create()){return n.messageIdentifier!==0&&e.uint32(13).fixed32(n.messageIdentifier),n.payload.length!==0&&e.uint32(50).bytes(n.payload),e},decode(n,e){let t=n instanceof N.default.Reader?n:new N.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=wa();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.messageIdentifier=t.fixed32();break;case 6:i.payload=t.bytes();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{messageIdentifier:U(n.messageIdentifier)?Number(n.messageIdentifier):0,payload:U(n.payload)?ci(n.payload):new Uint8Array}},toJSON(n){let e={};return n.messageIdentifier!==void 0&&(e.messageIdentifier=Math.round(n.messageIdentifier)),n.payload!==void 0&&(e.payload=fi(n.payload!==void 0?n.payload:new Uint8Array)),e},fromPartial(n){var e,t;let r=wa();return r.messageIdentifier=(e=n.messageIdentifier)!==null&&e!==void 0?e:0,r.payload=(t=n.payload)!==null&&t!==void 0?t:new Uint8Array,r}};function Ca(){return{messageIdentifier:0,portId:0,sequenceId:0,payload:new Uint8Array,closed:!1,ack:!1}}B.StreamMessage={encode(n,e=N.default.Writer.create()){return n.messageIdentifier!==0&&e.uint32(13).fixed32(n.messageIdentifier),n.portId!==0&&e.uint32(21).fixed32(n.portId),n.sequenceId!==0&&e.uint32(37).fixed32(n.sequenceId),n.payload.length!==0&&e.uint32(50).bytes(n.payload),n.closed===!0&&e.uint32(56).bool(n.closed),n.ack===!0&&e.uint32(64).bool(n.ack),e},decode(n,e){let t=n instanceof N.default.Reader?n:new N.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Ca();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.messageIdentifier=t.fixed32();break;case 2:i.portId=t.fixed32();break;case 4:i.sequenceId=t.fixed32();break;case 6:i.payload=t.bytes();break;case 7:i.closed=t.bool();break;case 8:i.ack=t.bool();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{messageIdentifier:U(n.messageIdentifier)?Number(n.messageIdentifier):0,portId:U(n.portId)?Number(n.portId):0,sequenceId:U(n.sequenceId)?Number(n.sequenceId):0,payload:U(n.payload)?ci(n.payload):new Uint8Array,closed:U(n.closed)?Boolean(n.closed):!1,ack:U(n.ack)?Boolean(n.ack):!1}},toJSON(n){let e={};return n.messageIdentifier!==void 0&&(e.messageIdentifier=Math.round(n.messageIdentifier)),n.portId!==void 0&&(e.portId=Math.round(n.portId)),n.sequenceId!==void 0&&(e.sequenceId=Math.round(n.sequenceId)),n.payload!==void 0&&(e.payload=fi(n.payload!==void 0?n.payload:new Uint8Array)),n.closed!==void 0&&(e.closed=n.closed),n.ack!==void 0&&(e.ack=n.ack),e},fromPartial(n){var e,t,r,i,o,a;let d=Ca();return d.messageIdentifier=(e=n.messageIdentifier)!==null&&e!==void 0?e:0,d.portId=(t=n.portId)!==null&&t!==void 0?t:0,d.sequenceId=(r=n.sequenceId)!==null&&r!==void 0?r:0,d.payload=(i=n.payload)!==null&&i!==void 0?i:new Uint8Array,d.closed=(o=n.closed)!==null&&o!==void 0?o:!1,d.ack=(a=n.ack)!==null&&a!==void 0?a:!1,d}};var In=(()=>{if(typeof In!="undefined")return In;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw"Unable to locate global object"})();function ci(n){if(In.Buffer)return Uint8Array.from(In.Buffer.from(n,"base64"));{let e=In.atob(n),t=new Uint8Array(e.length);for(let r=0;r<e.length;++r)t[r]=e.charCodeAt(r);return t}}function fi(n){if(In.Buffer)return In.Buffer.from(n).toString("base64");{let e=[];return n.forEach(t=>{e.push(String.fromCharCode(t))}),In.btoa(e.join(""))}}function U(n){return n!=null}});var ct=x(we=>{f();"use strict";Object.defineProperty(we,"__esModule",{value:!0});we.parseProtocolMessage=we.calculateMessageIdentifier=we.parseMessageIdentifier=we.streamAckMessage=we.streamMessage=we.closeStreamMessage=void 0;var Uc=$(),W=$n(),yn=new Uc.Writer,Ba=Uint8Array.of();function Dc(n,e,t){return yn.reset(),W.StreamMessage.encode({messageIdentifier:dr(W.RpcMessageTypes.RpcMessageTypes_STREAM_MESSAGE,n),sequenceId:e,portId:t,ack:!1,closed:!0,payload:Ba},yn),yn.finish()}we.closeStreamMessage=Dc;function Wc(n,e,t,r){return yn.reset(),W.StreamMessage.encode({messageIdentifier:dr(W.RpcMessageTypes.RpcMessageTypes_STREAM_MESSAGE,n),sequenceId:e,portId:t,ack:!1,closed:!1,payload:r},yn),yn.finish()}we.streamMessage=Wc;function qc(n,e,t){return yn.reset(),W.StreamMessage.encode({messageIdentifier:dr(W.RpcMessageTypes.RpcMessageTypes_STREAM_ACK,n),sequenceId:e,portId:t,ack:!0,closed:!1,payload:Ba},yn),yn.finish()}we.streamAckMessage=qc;function ba(n){return[n>>27&15,n&134217727]}we.parseMessageIdentifier=ba;function dr(n,e){return(n&15)<<27|e&134217727}we.calculateMessageIdentifier=dr;function Fc(n){let e=n.pos,[t,r]=ba(W.RpcMessageHeader.decode(n).messageIdentifier);switch(n.pos=e,t){case W.RpcMessageTypes.RpcMessageTypes_CREATE_PORT_RESPONSE:return[t,W.CreatePortResponse.decode(n),r];case W.RpcMessageTypes.RpcMessageTypes_RESPONSE:return[t,W.Response.decode(n),r];case W.RpcMessageTypes.RpcMessageTypes_REQUEST_MODULE_RESPONSE:return[t,W.RequestModuleResponse.decode(n),r];case W.RpcMessageTypes.RpcMessageTypes_STREAM_MESSAGE:return[t,W.StreamMessage.decode(n),r];case W.RpcMessageTypes.RpcMessageTypes_SERVER_READY:return[t,null,r];case W.RpcMessageTypes.RpcMessageTypes_REMOTE_ERROR_RESPONSE:return[t,W.RemoteError.decode(n),r];case W.RpcMessageTypes.RpcMessageTypes_REQUEST:return[t,W.Request.decode(n),r];case W.RpcMessageTypes.RpcMessageTypes_CREATE_PORT:return[t,W.CreatePort.decode(n),r];case W.RpcMessageTypes.RpcMessageTypes_STREAM_ACK:return[t,W.StreamMessage.decode(n),r];case W.RpcMessageTypes.RpcMessageTypes_REQUEST_MODULE:return[t,W.RequestModule.decode(n),r];case W.RpcMessageTypes.RpcMessageTypes_DESTROY_PORT:return[t,W.DestroyPort.decode(n),r]}return null}we.parseProtocolMessage=Fc});var hi=x(lr=>{f();"use strict";Object.defineProperty(lr,"__esModule",{value:!0});lr.messageDispatcher=void 0;var Aa=$(),Na=ct(),pi=$n();function Jc(n){let e=new Map,t=new Map,r;n.on("message",s=>{try{let l=Aa.Reader.create(s),u=(0,Na.parseProtocolMessage)(l);if(u){let[c,h,p]=u;if(r&&r(c,h,p),p>0){let y=e.get(p);try{if(y){let[E]=y;l.pos=0,E({reader:l,messageType:c,messageNumber:p,message:h}),e.delete(p)}let g=t.get(p);g&&(l.pos=0,g(l,c,p,h)),(c==pi.RpcMessageTypes.RpcMessageTypes_STREAM_ACK||c==pi.RpcMessageTypes.RpcMessageTypes_STREAM_MESSAGE)&&d(h,p)}catch(g){n.emit("error",g)}}}else n.emit("error",new Error(`Transport received unknown message: ${s}`))}catch(l){n.emit("error",l)}});let i=new Map,o=new Aa.Writer;function a(){i.forEach(([s])=>s({closed:!0,ack:!1})),e.forEach(([,s])=>s(new Error("RPC Transport closed"))),i.clear()}n.on("close",a),n.on("error",s=>{i.forEach(([,l])=>l(s)),e.forEach(([,l])=>l(s)),i.clear()});function d(s,l){let u=`${l},${s.sequenceId}`,c=i.get(u);c&&(i.delete(u),c[0](s))}return{transport:n,setGlobalHandler(s){r=s},addOneTimeListener(s){return new Promise((l,u)=>{e.set(s,[l,u])})},addListener(s,l){if(t.has(s))throw new Error("There is already a handler for messageId "+s);t.set(s,l)},removeListener(s){if(!t.has(s))throw new Error("A handler is missing for messageId "+s);t.delete(s)},async sendStreamMessage(s){let[l,u]=(0,Na.parseMessageIdentifier)(s.messageIdentifier),c=`${u},${s.sequenceId}`,h=new Promise(function(y,g){i.set(c,[y,g])});return o.reset(),pi.StreamMessage.encode(s,o),n.sendMessage(o.finish()),h}}}lr.messageDispatcher=Jc});var Ua=x(En=>{f();"use strict";Object.defineProperty(En,"__esModule",{value:!0});En.AsyncQueue=En.pushableChannel=En.linkedList=void 0;var Oa=class{constructor(e,t){this.value=e,this.prev=t,this.next=void 0}};function ur(){let n,e;function t(a){let d=new Oa(a,e);e&&(e.next=d),n||(n=d),e=d}function r(a){if(!a.next)e=a.prev;else{let d=a.next;d.prev=a.prev}if(!a.prev)n=a.next;else{let d=a.prev;d.next=a.next}}function i(){let a=n;if(a){r(a),delete a.next,delete a.prev;let d=a.value;return delete a.value,d}}function o(){return!n}return{enqueue:t,dequeue:i,isEmpty:o}}En.linkedList=ur;function zc(n){let e=null,t=ur(),r=!1,i=null;function o(){if(!t.isEmpty()){let p=i||new Error("Channel was closed before deliverying the message");for(;!t.isEmpty();){let{resolve:y}=t.dequeue();y&&y(p)}}}function a(){if(e){let p=e;e=null,p()}}function d(p,y){if(r){y(new Error("Channel is closed"));return}if(i){y(i);return}t.enqueue({value:p,resolve:y}),a()}function s(p){i=p,u(),o()}function l(){if(i&&t.isEmpty())throw i;if(r&&t.isEmpty())return{done:!0,value:void 0};if(!t.isEmpty()){let p=t.dequeue();return p.resolve&&p.resolve(i||void 0),{done:!1,value:p.value}}}function u(){r||(r=!0,a(),n())}let c={async next(){for(;;)try{let p=l();if(p)return p;await new Promise(y=>e=y)}catch(p){throw s(p),p}},async return(p){return u(),o(),{done:!0,value:p}},async throw(p){if(i)throw i;return s(p),{done:!0,value:void 0}},[Symbol.asyncIterator](){return c}};function h(){return r}return{iterable:c,push:d,close:u,failAndClose:s,isClosed:h,[Symbol.asyncIterator]:()=>c}}En.pushableChannel=zc;var Ma=class{constructor(e){this.requestingNext=e,this.values=ur(),this.settlers=ur(),this.closed=!1,this.error=void 0}[Symbol.asyncIterator](){return this}enqueue(e){if(this.closed)throw new Error("Channel is closed");if(this.settlers.isEmpty())this.values.enqueue({value:e});else{if(!this.values.isEmpty())throw new Error("Illegal internal state");let t=this.settlers.dequeue();e instanceof Error?t.reject(e):t.resolve({value:e})}}async next(){if(!this.values.isEmpty())return this.values.dequeue();if(this.error)throw this.error;if(this.closed){if(!this.settlers.isEmpty())throw new Error("Illegal internal state");return{done:!0,value:void 0}}return new Promise((e,t)=>{this.requestingNext(this,"next"),this.settlers.enqueue({resolve:e,reject:t})})}async return(e){return this.close(e),{done:!0,value:e}}async throw(e){return this.close(e),{done:!0,value:void 0}}close(e){if(e)for(;!this.settlers.isEmpty();)this.settlers.dequeue().reject(e);else for(;!this.settlers.isEmpty();)this.settlers.dequeue().resolve({done:!0,value:void 0});e&&(this.error=e),this.closed||(this.closed=!0,this.requestingNext(this,"close"))}};En.AsyncQueue=Ma});var yi=x(Hn=>{f();"use strict";Object.defineProperty(Hn,"__esModule",{value:!0});Hn.streamFromDispatcher=Hn.sendStreamThroughTransport=void 0;var cr=$n(),fr=ct(),Lc=Ua();async function Gc(n,e,t,r,i){let o=cr.StreamMessage.fromJSON({closed:!1,ack:!1,sequenceId:0,messageIdentifier:(0,fr.calculateMessageIdentifier)(cr.RpcMessageTypes.RpcMessageTypes_STREAM_MESSAGE,i),payload:Uint8Array.of(),portId:r}),a=0;for await(let d of t){a++,o.sequenceId=a,o.payload=d;let s=await n.sendStreamMessage(o);if(!s.ack&&s.closed)return}e.sendMessage((0,fr.closeStreamMessage)(i,a,r))}Hn.sendStreamThroughTransport=Gc;function $c(n,e,t){let r=0,i=!1,o=!1,a=new Lc.AsyncQueue(d);n.transport.on("close",()=>{a.close(new Error("RPC Transport closed"))}),n.transport.on("error",()=>{a.close(new Error("RPC Transport failed"))});function d(l,u){u=="close"&&n.removeListener(t),i||(u=="close"?n.transport.sendMessage((0,fr.closeStreamMessage)(t,r,e)):u=="next"&&(o=!0,n.transport.sendMessage((0,fr.streamAckMessage)(t,r,e))))}function s(l){r=l.sequenceId,l.closed?(i=!0,a.close()):a.enqueue(l.payload)}return n.addListener(t,(l,u,c,h)=>{u==cr.RpcMessageTypes.RpcMessageTypes_STREAM_MESSAGE?s(h):u==cr.RpcMessageTypes.RpcMessageTypes_REMOTE_ERROR_RESPONSE?(i=!0,a.close(new Error("RemoteError: "+(h.errorMessage||"Unknown remote error")))):a.close(new Error("RemoteError: Protocol error, unkown message"))}),{generator:a,closeIfNotOpened(){o||a.close(new Error("ClientStream lost"))}}}Hn.streamFromDispatcher=$c});var Ya=x(de=>{f();"use strict";var Hc=de&&de.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(de,"__esModule",{value:!0});de.createRpcServer=de.handleRequest=de.sendServerStream=de.handleDestroyPort=de.handleRequestModule=de.handleCreatePort=de.createServerPort=void 0;var Da=Hc(rr()),Yc=$(),Mn=ct(),ee=$n(),Kc=hi(),Wa=yi(),qa=0,Fa=Uint8Array.from([]),re=new Yc.Writer;function Xc(){return re.reset(),ee.RpcMessageHeader.encode({messageIdentifier:(0,Mn.calculateMessageIdentifier)(ee.RpcMessageTypes.RpcMessageTypes_SERVER_READY,0)},re),re.finish()}var Qc=Xc();function Vc(n){return Array.from(Object.entries(n)).filter(([e,t])=>typeof t=="function")}function Ja(n,e,t){let r=(0,Da.default)(),i=new Map,o=new Map,a=new Map,d={get portId(){return n},get portName(){return e},...r,registerModule:l,loadModule:c,close:s,callProcedure:h};async function s(){i.clear(),o.clear(),a.clear(),r.emit("close",{})}async function l(p,y){if(a.has(p))throw new Error(`module ${p} is already registered for port ${e} (${n}))`);a.set(p,y)}async function u(p){let y=await p,g={procedures:[]};for(let[E,M]of Vc(y)){let T=o.size+1;o.set(T,M),g.procedures.push({procedureName:E,callable:M,procedureId:T})}return g}function c(p){if(i.has(p))return i.get(p);let y=a.get(p);if(!y)throw new Error(`Module ${p} is not available for port ${e} (${n}))`);let g=u(y(d,t));return i.set(p,g),g}function h(p,y,g){let E=o.get(p);if(!E)throw new Error(`procedureId ${p} is missing in ${e} (${n}))`);return E(y,g)}return d}de.createServerPort=Ja;function mi(n,e,t){var r;return(r=t.portsByTransport.get(e))===null||r===void 0?void 0:r.get(n)}async function za(n,e,t,r,i,o,a){qa++;let d=Ja(qa,e.portName,a),s=o.portsByTransport.get(n)||new Map;return s.set(d.portId,d),o.ports.set(d.portId,d),o.portsByTransport.set(n,s),await i(d,n,a),re.reset(),ee.CreatePortResponse.encode({messageIdentifier:(0,Mn.calculateMessageIdentifier)(ee.RpcMessageTypes.RpcMessageTypes_CREATE_PORT_RESPONSE,t),portId:d.portId},re),n.sendMessage(re.finish()),d}de.handleCreatePort=za;async function La(n,e,t,r){let i=mi(e.portId,n,r);if(!i)throw new Error(`Cannot find port ${e.portId}`);let o=await i.loadModule(e.moduleName);re.reset(),ee.RequestModuleResponse.encode({procedures:o.procedures,messageIdentifier:(0,Mn.calculateMessageIdentifier)(ee.RpcMessageTypes.RpcMessageTypes_REQUEST_MODULE_RESPONSE,t),portId:i.portId},re),n.sendMessage(re.finish())}de.handleRequestModule=La;async function Ga(n,e,t,r){let i=mi(e.portId,n,r);i&&i.emit("close",{})}de.handleDestroyPort=Ga;async function $a(n,e,t,r,i){let o=ee.StreamMessage.fromJSON({closed:!1,ack:!1,sequenceId:0,messageIdentifier:(0,Mn.calculateMessageIdentifier)(ee.RpcMessageTypes.RpcMessageTypes_STREAM_MESSAGE,i),payload:Fa,portId:r}),a=await n.sendStreamMessage(o);if(!a.closed){if(!a.ack)throw new Error("Error in logic, ACK must be true");await(0,Wa.sendStreamThroughTransport)(n,e,t,r,i)}}de.sendServerStream=$a;async function Ha(n,e,t,r,i,o){let a=mi(n.portId,r,t);if(!a){re.reset(),ee.RemoteError.encode({messageIdentifier:(0,Mn.calculateMessageIdentifier)(ee.RpcMessageTypes.RpcMessageTypes_REMOTE_ERROR_RESPONSE,e),errorCode:0,errorMessage:"invalid portId"},re),r.sendMessage(re.finish());return}let{clientStream:d}=n,s=d?(0,Wa.streamFromDispatcher)(o,n.portId,n.clientStream):null,l=n.clientStream?await a.callProcedure(n.procedureId,s.generator,i):await a.callProcedure(n.procedureId,n.payload,i),u=ee.Response.fromJSON({messageIdentifier:(0,Mn.calculateMessageIdentifier)(ee.RpcMessageTypes.RpcMessageTypes_RESPONSE,e),payload:Fa});l instanceof Uint8Array?(u.payload=l,re.reset(),ee.Response.encode(u,re),r.sendMessage(re.finish())):l&&Symbol.asyncIterator in l?await $a(o,r,l,a.portId,e):(re.reset(),ee.Response.encode(u,re),r.sendMessage(re.finish())),s==null||s.closeIfNotOpened()}de.handleRequest=Ha;function Zc(n){let e=(0,Da.default)(),t={ports:new Map,portsByTransport:new Map,transports:new Set};function r(d){let s=t.portsByTransport.get(d);t.portsByTransport.delete(d),s&&s.size&&s.forEach(l=>l.close()),t.transports.delete(d)&&e.emit("transportClosed",{transport:d})}e.on("portClosed",d=>{let{port:s,transport:l}=d;t.ports.delete(s.portId);let u=t.portsByTransport.get(l);u&&u.delete(s.portId)});function i(d,s){e.emit("transportError",{transport:d,error:s}),d.close(),r(d)}let o;async function a(d,s,l,u,c,h){if(d==ee.RpcMessageTypes.RpcMessageTypes_REQUEST)await Ha(s,l,t,u,c,h);else if(d==ee.RpcMessageTypes.RpcMessageTypes_REQUEST_MODULE)await La(u,s,l,t);else if(d==ee.RpcMessageTypes.RpcMessageTypes_CREATE_PORT){let p=await za(u,s,l,n,o,t,c);p.on("close",()=>e.emit("portClosed",{port:p,transport:u}))}else d==ee.RpcMessageTypes.RpcMessageTypes_DESTROY_PORT?await Ga(u,s,l,t):d==ee.RpcMessageTypes.RpcMessageTypes_STREAM_ACK||d==ee.RpcMessageTypes.RpcMessageTypes_STREAM_MESSAGE||u.emit("error",new Error(`Unknown message from client ${JSON.stringify([d,s,l])}`))}return{...e,setHandler(d){o=d},attachTransport(d,s){if(!o)throw new Error("A handler was not set for this RpcServer");t.transports.add(d);let l=(0,Kc.messageDispatcher)(d);l.setGlobalHandler((u,c,h)=>{a(u,c,h,d,s,l).catch(p=>{var y;(y=n.logger)===null||y===void 0||y.error("Error handling remote request",{message:p.message,name:p.name,stack:p.stack}),re.reset(),ee.RemoteError.encode({messageIdentifier:(0,Mn.calculateMessageIdentifier)(ee.RpcMessageTypes.RpcMessageTypes_REMOTE_ERROR_RESPONSE,h),errorMessage:p.message||"Error processing the request",errorCode:0},re),d.sendMessage(re.finish())})}),d.on("close",()=>{r(d)}),d.on("error",u=>{var c;(c=n.logger)===null||c===void 0||c.error("Error in transport",{message:u.message,name:u.name,stack:u.stack}),i(d,u)}),d.sendMessage(Qc)}}}de.createRpcServer=Zc});var Ka=x(pr=>{f();"use strict";Object.defineProperty(pr,"__esModule",{value:!0});pr.createClientRequestDispatcher=void 0;var jc=$(),Ri=0;function ef(n){function e(){let t=++Ri;return Ri>16777216&&(Ri=0),t}return{dispatcher:n,async request(t){let r=e(),i=new jc.Writer;t(i,r),n.transport.sendMessage(i.finish());let{reader:o}=await n.addOneTimeListener(r);return o},nextMessageNumber:e}}pr.createClientRequestDispatcher=ef});var Va=x(kn=>{f();"use strict";var nf=kn&&kn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(kn,"__esModule",{value:!0});kn.createRpcClient=kn.createPort=void 0;var tf=nf(rr()),rf=$(),Ie=$n(),of=hi(),Un=ct(),af=Ka(),Xa=yi(),Pi=new Uint8Array(0);function Qa(n,e,t){let r=(0,tf.default)(),i="open";return r.on("close",()=>{i="closed"}),{...r,portName:e,portId:n,get state(){return i},close(){let o=new rf.Writer;Ie.DestroyPort.encode({messageIdentifier:(0,Un.calculateMessageIdentifier)(Ie.RpcMessageTypes.RpcMessageTypes_DESTROY_PORT,0),portId:n},o),t.dispatcher.transport.sendMessage(o.finish()),r.emit("close",{})},async loadModule(o){let a=await t.request((s,l)=>{Ie.RequestModule.encode({messageIdentifier:(0,Un.calculateMessageIdentifier)(Ie.RpcMessageTypes.RpcMessageTypes_REQUEST_MODULE,l),moduleName:o,portId:n},s)}),d=(0,Un.parseProtocolMessage)(a);if(d){let[s,l]=d;if(s==Ie.RpcMessageTypes.RpcMessageTypes_REQUEST_MODULE_RESPONSE){let u={};for(let c of l.procedures)u[c.procedureName]=sf(n,c.procedureId,t);return u}else s==Ie.RpcMessageTypes.RpcMessageTypes_REMOTE_ERROR_RESPONSE&&gi(l)}throw new Error("Unknown response received from server.")}}}kn.createPort=Qa;function gi(n){throw new Error("RemoteError: "+n.errorMessage)}function sf(n,e,t){let r={portId:n,messageIdentifier:0,payload:Pi,procedureId:e,clientStream:0};return async function(i){if(i)if(Symbol.asyncIterator in i){let a=t.nextMessageNumber();r.clientStream=a,r.payload=Pi,t.dispatcher.addOneTimeListener(a).then(d=>{let s=d.message;if(!s.closed){if(!s.ack)throw new Error("Error in logic, ACK must be true");(0,Xa.sendStreamThroughTransport)(t.dispatcher,t.dispatcher.transport,i,n,a)}}).catch(d=>{t.dispatcher.transport.emit("error",d)})}else r.payload=i;else r.payload=Pi;let o=(0,Un.parseProtocolMessage)(await t.request((a,d)=>{r.messageIdentifier=(0,Un.calculateMessageIdentifier)(Ie.RpcMessageTypes.RpcMessageTypes_REQUEST,d),Ie.Request.encode(r,a)}));if(o){let[a,d,s]=o;if(a==Ie.RpcMessageTypes.RpcMessageTypes_RESPONSE){let l=d.payload;return l.length?l:void 0}else if(a==Ie.RpcMessageTypes.RpcMessageTypes_STREAM_MESSAGE){let l=d,{generator:u}=(0,Xa.streamFromDispatcher)(t.dispatcher,l.portId,s);return u}else a==Ie.RpcMessageTypes.RpcMessageTypes_REMOTE_ERROR_RESPONSE&&gi(d)}}}async function df(n){let e=new Map,t=(0,of.messageDispatcher)(n),r=(0,af.createClientRequestDispatcher)(t);async function i(o){let a=await r.request((s,l)=>{Ie.CreatePort.encode({messageIdentifier:(0,Un.calculateMessageIdentifier)(Ie.RpcMessageTypes.RpcMessageTypes_CREATE_PORT,l),portName:o},s)}),d=(0,Un.parseProtocolMessage)(a);if(d){let[s,l]=d;if(s==Ie.RpcMessageTypes.RpcMessageTypes_CREATE_PORT_RESPONSE){let u=l.portId;return Qa(u,o,r)}else s==Ie.RpcMessageTypes.RpcMessageTypes_REMOTE_ERROR_RESPONSE&&gi(l)}throw new Error("Unknown response received from server.")}return await new Promise((o,a)=>{n.on("connect",o),n.on("error",a)}),{async createPort(o){if(e.has(o))return e.get(o);let a=i(o);e.set(o,a);let d=await a;return n.on("close",()=>{d.close()}),d.on("close",()=>{e.get(o)===a&&e.delete(o)}),d}}}kn.createRpcClient=df});var Za=x(mn=>{f();"use strict";var lf=mn&&mn.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Si=mn&&mn.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&lf(e,n,t)};Object.defineProperty(mn,"__esModule",{value:!0});Si(xo(),mn);Si(Ya(),mn);Si(Va(),mn)});var ja=x(Yn=>{f();"use strict";var uf=Yn&&Yn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Yn,"__esModule",{value:!0});Yn.WebWorkerTransport=void 0;var cf=uf(rr());function ff(n){let e=(0,cf.default)();return n.addEventListener("message",()=>e.emit("connect",{}),{once:!0}),n.addEventListener("error",r=>{r.error?e.emit("error",r.error):r.message&&e.emit("error",Object.assign(new Error(r.message),{colno:r.colno,error:r.error,filename:r.filename,lineno:r.lineno,message:r.message}))}),n.addEventListener("message",r=>{if(r.data instanceof ArrayBuffer||r.data instanceof Uint8Array)e.emit("message",r.data);else throw new Error("WebWorkerTransport: Received unknown type of message, expecting Uint8Array")}),{...e,sendMessage(r){if(r instanceof ArrayBuffer||r instanceof Uint8Array)n.postMessage(r);else throw new Error("WebWorkerTransport: Received unknown type of message, expecting Uint8Array")},close(){"terminate"in n?n.terminate():"close"in n&&n.close(),e.emit("close",{})}}}Yn.WebWorkerTransport=ff});var fe=x(ne=>{f();"use strict";Object.defineProperty(ne,"__esModule",{value:!0});ne.registerService=ne.loadService=ne.serverProcedureBidirectionalStream=ne.serverProcedureServerStream=ne.serverProcedureClientStream=ne.serverProcedureUnary=ne.clientProcedureBidirectionalStream=ne.clientProcedureServerStream=ne.clientProcedureClientStream=ne.clientProcedureUnary=void 0;var hr=new Uint8Array;function es(n,e){return async r=>{let i=await n;if(!(e.name in i))throw new Error("Method "+e.name+" not implemented in server port");let o=await i[e.name](e.requestType.encode(r).finish());return e.responseType.decode(o??hr)}}ne.clientProcedureUnary=es;async function*ns(n,e){for await(let t of n)yield e.requestType.encode(t).finish()}function ts(n,e){return async r=>{let i=await n;if(!(e.name in i))throw new Error("Method "+e.name+" not implemented in server port");let o=await i[e.name](ns(r,e));return e.responseType.decode(o??hr)}}ne.clientProcedureClientStream=ts;function rs(n,e){return function(r){let i;async function o(){let s=await n;if(!(e.name in s))throw new Error("Method "+e.name+" not implemented in server port");return(await s[e.name](e.requestType.encode(r).finish()))[Symbol.asyncIterator]()}function a(){return i||(i=o()),i}let d={[Symbol.asyncIterator]:()=>d,async next(){var s;let l=await(await a()).next();return{value:e.responseType.decode((s=l.value)!==null&&s!==void 0?s:hr),done:l.done}},async return(s){let l=await(await a()).return(s);return{value:l.value?e.responseType.decode(l.value):l.value,done:l.done}},async throw(s){let l=await(await a()).throw(s);return{value:l.value?e.responseType.decode(l.value):l.value,done:l.done}}};return d}}ne.clientProcedureServerStream=rs;function is(n,e){return function(r){let i;async function o(){let s=await n;if(!(e.name in s))throw new Error("Method "+e.name+" not implemented in server port");return(await s[e.name](ns(r,e)))[Symbol.asyncIterator]()}function a(){return i||(i=o()),i}let d={[Symbol.asyncIterator]:()=>d,async next(){var s;let l=await(await a()).next();return{value:e.responseType.decode((s=l.value)!==null&&s!==void 0?s:hr),done:l.done}},async return(s){let l=await(await a()).return(s);return{value:l.value?e.responseType.decode(l.value):l.value,done:l.done}},async throw(s){let l=await(await a()).throw(s);return{value:l.value?e.responseType.decode(l.value):l.value,done:l.done}}};return d}}ne.clientProcedureBidirectionalStream=is;function os(n,e){return async function(t,r){let i=e.requestType.decode(t),o=await n(i,r);if(!o)throw new Error("Empty or null responses are not allowed. Procedure: "+e.name);return e.responseType.encode(o).finish()}}ne.serverProcedureUnary=os;async function*as(n,e){for await(let t of n)yield e.requestType.decode(t)}function ss(n,e){return async function(t,r){let i=await n(as(t,e),r);if(!i)throw new Error("Empty or null responses are not allowed. Procedure: "+e.name);return e.responseType.encode(i).finish()}}ne.serverProcedureClientStream=ss;function ds(n,e){return function(t,r){let i,o=e.requestType.decode(t);async function a(){let l=await n(o,r);if(!l)throw new Error("Empty or null responses are not allowed. Procedure: "+e.name);return l[Symbol.asyncIterator]()}function d(){return i||(i=a()),i}let s={[Symbol.asyncIterator]:()=>s,async next(){let l=await(await d()).next();return{value:l.value?e.responseType.encode(l.value).finish():l.value,done:l.done}},async return(l){let u=await(await d()).return(l);return{value:u.value?e.responseType.encode(u.value).finish():u.value,done:u.done}},async throw(l){let u=await(await d()).throw(l);return{value:u.value?e.responseType.encode(u.value).finish():u.value,done:u.done}}};return s}}ne.serverProcedureServerStream=ds;function ls(n,e){return function(t,r){let i;async function o(){let s=await n(as(t,e),r);if(!s)throw new Error("Empty or null responses are not allowed. Procedure: "+e.name);return s[Symbol.asyncIterator]()}function a(){return i||(i=o()),i}let d={[Symbol.asyncIterator]:()=>d,async next(){let s=await(await a()).next();return{value:s.value?e.responseType.encode(s.value).finish():s.value,done:s.done}},async return(s){let l=await(await a()).return(s);return{value:l.value?e.responseType.encode(l.value).finish():l.value,done:l.done}},async throw(s){let l=await(await a()).throw(s);return{value:l.value?e.responseType.encode(l.value).finish():l.value,done:l.done}}};return d}}ne.serverProcedureBidirectionalStream=ls;function pf(n,e){let t=n.loadModule(e.name),r={};for(let[i,o]of Object.entries(e.methods))o.responseStream&&o.requestStream?r[i]=is(t,o):o.responseStream?r[i]=rs(t,o):o.requestStream?r[i]=ts(t,o):r[i]=es(t,o);return r}ne.loadService=pf;function hf(n,e,t){n.registerModule(e.name,async(r,i)=>{let o=await t(r,i),a={};for(let[d,s]of Object.entries(e.methods))s.responseStream&&s.requestStream?a[s.name]=ls(o[d].bind(o),s):s.responseStream?a[s.name]=ds(o[d].bind(o),s):s.requestStream?a[s.name]=ss(o[d].bind(o),s):a[s.name]=os(o[d].bind(o),s);return a})}ne.registerService=hf});var Ze=x(le=>{f();"use strict";Object.defineProperty(le,"__esModule",{value:!0});le.RAD2DEG=le.DEG2RAD=le.Epsilon=le.ToLinearSpace=le.ToGammaSpace=le.Space=le.Orientation=void 0;var Lp;(function(n){n[n.CW=0]="CW",n[n.CCW=1]="CCW"})(Lp=le.Orientation||(le.Orientation={}));var Gp;(function(n){n[n.LOCAL=0]="LOCAL",n[n.WORLD=1]="WORLD",n[n.BONE=2]="BONE"})(Gp=le.Space||(le.Space={}));le.ToGammaSpace=1/2.2;le.ToLinearSpace=2.2;le.Epsilon=1e-6;le.DEG2RAD=Math.PI/180;le.RAD2DEG=360/(Math.PI*2)});var Ql=x(mr=>{f();"use strict";Object.defineProperty(mr,"__esModule",{value:!0});mr.buildArray=void 0;function $p(n,e){let t=[];for(let r=0;r<n;++r)t.push(e());return t}mr.buildArray=$p});var Rn=x(Rr=>{f();"use strict";Object.defineProperty(Rr,"__esModule",{value:!0});Rr.Scalar=void 0;var ke=class{static WithinEpsilon(e,t,r=1401298e-51){let i=e-t;return-r<=i&&i<=r}static ToHex(e){let t=e.toString(16);return e<=15?("0"+t).toUpperCase():t.toUpperCase()}static Sign(e){let t=+e;return t===0||isNaN(t)?t:t>0?1:-1}static Clamp(e,t=0,r=1){return Math.min(r,Math.max(t,e))}static Log2(e){return Math.log(e)*Math.LOG2E}static Repeat(e,t){return e-Math.floor(e/t)*t}static Normalize(e,t,r){return(e-t)/(r-t)}static Denormalize(e,t,r){return e*(r-t)+t}static DeltaAngle(e,t){let r=ke.Repeat(t-e,360);return r>180&&(r-=360),r}static PingPong(e,t){let r=ke.Repeat(e,t*2);return t-Math.abs(r-t)}static SmoothStep(e,t,r){let i=ke.Clamp(r);return i=-2*i*i*i+3*i*i,t*i+e*(1-i)}static MoveTowards(e,t,r){let i=0;return Math.abs(t-e)<=r?i=t:i=e+ke.Sign(t-e)*r,i}static MoveTowardsAngle(e,t,r){let i=ke.DeltaAngle(e,t),o=0;return-r<i&&i<r?o=t:o=ke.MoveTowards(e,e+i,r),o}static Lerp(e,t,r){return e+(t-e)*r}static LerpAngle(e,t,r){let i=ke.Repeat(t-e,360);return i>180&&(i-=360),e+i*ke.Clamp(r)}static InverseLerp(e,t,r){let i=0;return e!==t?i=ke.Clamp((r-e)/(t-e)):i=0,i}static Hermite(e,t,r,i,o){let a=o*o,d=o*a,s=2*d-3*a+1,l=-2*d+3*a,u=d-2*a+o,c=d-a;return e*s+r*l+t*u+i*c}static RandomRange(e,t){return e===t?e:Math.random()*(t-e)+e}static RangeToPercent(e,t,r){return(e-t)/(r-t)}static PercentToRange(e,t,r){return(r-t)*e+t}static NormalizeRadians(e){return e-ke.TwoPi*Math.floor((e+Math.PI)/ke.TwoPi)}};Rr.Scalar=ke;ke.TwoPi=Math.PI*2});var zi=x(gr=>{f();"use strict";Object.defineProperty(gr,"__esModule",{value:!0});gr.Vector4=void 0;var Hp=Ze(),Pr=Rn(),Yp=sn(),z=class{constructor(e,t,r,i){this.x=e,this.y=t,this.z=r,this.w=i}static Add(e,t){return new z(e.x,e.y,e.z,e.w).addInPlace(t)}static FromArray(e,t=0){return new z(e[t],e[t+1],e[t+2],e[t+3])}static FromArrayToRef(e,t,r){r.x=e[t],r.y=e[t+1],r.z=e[t+2],r.w=e[t+3]}static FromFloatArrayToRef(e,t,r){z.FromArrayToRef(e,t,r)}static FromFloatsToRef(e,t,r,i,o){o.x=e,o.y=t,o.z=r,o.w=i}static Zero(){return new z(0,0,0,0)}static One(){return new z(1,1,1,1)}static Normalize(e){let t=z.Zero();return z.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){t.copyFrom(e),t.normalize()}static Minimize(e,t){let r=new z(e.x,e.y,e.z,e.w);return r.minimizeInPlace(t),r}static Maximize(e,t){let r=new z(e.x,e.y,e.z,e.w);return r.maximizeInPlace(t),r}static Distance(e,t){return Math.sqrt(z.DistanceSquared(e,t))}static DistanceSquared(e,t){let r=e.x-t.x,i=e.y-t.y,o=e.z-t.z,a=e.w-t.w;return r*r+i*i+o*o+a*a}static Center(e,t){let r=z.Add(e,t);return r.scaleInPlace(.5),r}static TransformNormal(e,t){let r=z.Zero();return z.TransformNormalToRef(e,t,r),r}static TransformNormalToRef(e,t,r){let i=t.m,o=e.x*i[0]+e.y*i[4]+e.z*i[8],a=e.x*i[1]+e.y*i[5]+e.z*i[9],d=e.x*i[2]+e.y*i[6]+e.z*i[10];r.x=o,r.y=a,r.z=d,r.w=e.w}static TransformNormalFromFloatsToRef(e,t,r,i,o,a){let d=o.m;a.x=e*d[0]+t*d[4]+r*d[8],a.y=e*d[1]+t*d[5]+r*d[9],a.z=e*d[2]+t*d[6]+r*d[10],a.w=i}toString(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+" W:"+this.w+"}"}getClassName(){return"Vector4"}getHashCode(){let e=this.x||0;return e=e*397^(this.y||0),e=e*397^(this.z||0),e=e*397^(this.w||0),e}asArray(){let e=new Array;return this.toArray(e,0),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,this}addInPlace(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}add(e){return new z(this.x+e.x,this.y+e.y,this.z+e.z,this.w+e.w)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,t.z=this.z+e.z,t.w=this.w+e.w,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subtract(e){return new z(this.x-e.x,this.y-e.y,this.z-e.z,this.w-e.w)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z,t.w=this.w-e.w,this}subtractFromFloats(e,t,r,i){return new z(this.x-e,this.y-t,this.z-r,this.w-i)}subtractFromFloatsToRef(e,t,r,i,o){return o.x=this.x-e,o.y=this.y-t,o.z=this.z-r,o.w=this.w-i,this}negate(){return new z(-this.x,-this.y,-this.z,-this.w)}scaleInPlace(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}scale(e){return new z(this.x*e,this.y*e,this.z*e,this.w*e)}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,t.z=this.z*e,t.w=this.w*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,t.z+=this.z*e,t.w+=this.w*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y&&this.z===e.z&&this.w===e.w}equalsWithEpsilon(e,t=Hp.Epsilon){return e&&Pr.Scalar.WithinEpsilon(this.x,e.x,t)&&Pr.Scalar.WithinEpsilon(this.y,e.y,t)&&Pr.Scalar.WithinEpsilon(this.z,e.z,t)&&Pr.Scalar.WithinEpsilon(this.w,e.w,t)}equalsToFloats(e,t,r,i){return this.x===e&&this.y===t&&this.z===r&&this.w===i}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiply(e){return new z(this.x*e.x,this.y*e.y,this.z*e.z,this.w*e.w)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,t.z=this.z*e.z,t.w=this.w*e.w,this}multiplyByFloats(e,t,r,i){return new z(this.x*e,this.y*t,this.z*r,this.w*i)}divide(e){return new z(this.x/e.x,this.y/e.y,this.z/e.z,this.w/e.w)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,t.z=this.z/e.z,t.w=this.w/e.w,this}divideInPlace(e){return this.divideToRef(e,this)}minimizeInPlace(e){return e.x<this.x&&(this.x=e.x),e.y<this.y&&(this.y=e.y),e.z<this.z&&(this.z=e.z),e.w<this.w&&(this.w=e.w),this}maximizeInPlace(e){return e.x>this.x&&(this.x=e.x),e.y>this.y&&(this.y=e.y),e.z>this.z&&(this.z=e.z),e.w>this.w&&(this.w=e.w),this}floor(){return new z(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z),Math.floor(this.w))}fract(){return new z(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z),this.w-Math.floor(this.w))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}normalize(){let e=this.length();return e===0?this:this.scaleInPlace(1/e)}toVector3(){return new Yp.Vector3(this.x,this.y,this.z)}clone(){return new z(this.x,this.y,this.z,this.w)}copyFrom(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}copyFromFloats(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}set(e,t,r,i){return this.copyFromFloats(e,t,r,i)}setAll(e){return this.x=this.y=this.z=this.w=e,this}};gr.Vector4=z});var Vt=x(Sr=>{f();"use strict";Object.defineProperty(Sr,"__esModule",{value:!0});Sr.Matrix=void 0;var De=sn(),Li=Zt(),H=Zn(),Kp=zi(),m=class{constructor(){this._isIdentity=!1,this._isIdentityDirty=!0,this._isIdentity3x2=!0,this._isIdentity3x2Dirty=!0,this._m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this._updateIdentityStatus(!1)}get m(){return this._m}static get IdentityReadOnly(){return m._identityReadOnly}static FromArray(e,t=0){let r=new m;return m.FromArrayToRef(e,t,r),r}static FromArrayToRef(e,t,r){for(let i=0;i<16;i++)r._m[i]=e[i+t];r._markAsUpdated()}static FromFloatArrayToRefScaled(e,t,r,i){for(let o=0;o<16;o++)i._m[o]=e[o+t]*r;i._markAsUpdated()}static FromValuesToRef(e,t,r,i,o,a,d,s,l,u,c,h,p,y,g,E,M){let T=M._m;T[0]=e,T[1]=t,T[2]=r,T[3]=i,T[4]=o,T[5]=a,T[6]=d,T[7]=s,T[8]=l,T[9]=u,T[10]=c,T[11]=h,T[12]=p,T[13]=y,T[14]=g,T[15]=E,M._markAsUpdated()}static FromValues(e,t,r,i,o,a,d,s,l,u,c,h,p,y,g,E){let M=new m,T=M._m;return T[0]=e,T[1]=t,T[2]=r,T[3]=i,T[4]=o,T[5]=a,T[6]=d,T[7]=s,T[8]=l,T[9]=u,T[10]=c,T[11]=h,T[12]=p,T[13]=y,T[14]=g,T[15]=E,M._markAsUpdated(),M}static Compose(e,t,r){let i=new m;return m.ComposeToRef(e,t,r,i),i}static ComposeToRef(e,t,r,i){m.ScalingToRef(e.x,e.y,e.z,H.MathTmp.Matrix[1]),t.toRotationMatrix(H.MathTmp.Matrix[0]),H.MathTmp.Matrix[1].multiplyToRef(H.MathTmp.Matrix[0],i),i.setTranslation(r)}static Identity(){let e=m.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return e._updateIdentityStatus(!0),e}static IdentityToRef(e){m.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,e),e._updateIdentityStatus(!0)}static Zero(){let e=m.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return e._updateIdentityStatus(!1),e}static RotationX(e){let t=new m;return m.RotationXToRef(e,t),t}static Invert(e){let t=new m;return e.invertToRef(t),t}static RotationXToRef(e,t){let r=Math.sin(e),i=Math.cos(e);m.FromValuesToRef(1,0,0,0,0,i,r,0,0,-r,i,0,0,0,0,1,t),t._updateIdentityStatus(i===1&&r===0)}static RotationY(e){let t=new m;return m.RotationYToRef(e,t),t}static RotationYToRef(e,t){let r=Math.sin(e),i=Math.cos(e);m.FromValuesToRef(i,0,-r,0,0,1,0,0,r,0,i,0,0,0,0,1,t),t._updateIdentityStatus(i===1&&r===0)}static RotationZ(e){let t=new m;return m.RotationZToRef(e,t),t}static RotationZToRef(e,t){let r=Math.sin(e),i=Math.cos(e);m.FromValuesToRef(i,r,0,0,-r,i,0,0,0,0,1,0,0,0,0,1,t),t._updateIdentityStatus(i===1&&r===0)}static RotationAxis(e,t){let r=new m;return m.RotationAxisToRef(e,t,r),r}static RotationAxisToRef(e,t,r){let i=Math.sin(-t),o=Math.cos(-t),a=1-o;e.normalize();let d=r._m;d[0]=e.x*e.x*a+o,d[1]=e.x*e.y*a-e.z*i,d[2]=e.x*e.z*a+e.y*i,d[3]=0,d[4]=e.y*e.x*a+e.z*i,d[5]=e.y*e.y*a+o,d[6]=e.y*e.z*a-e.x*i,d[7]=0,d[8]=e.z*e.x*a-e.y*i,d[9]=e.z*e.y*a+e.x*i,d[10]=e.z*e.z*a+o,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,r._markAsUpdated()}static RotationYawPitchRoll(e,t,r){let i=new m;return m.RotationYawPitchRollToRef(e,t,r,i),i}static RotationYawPitchRollToRef(e,t,r,i){Li.Quaternion.RotationYawPitchRollToRef(e,t,r,H.MathTmp.Quaternion[0]),H.MathTmp.Quaternion[0].toRotationMatrix(i)}static Scaling(e,t,r){let i=new m;return m.ScalingToRef(e,t,r,i),i}static ScalingToRef(e,t,r,i){m.FromValuesToRef(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1,i),i._updateIdentityStatus(e===1&&t===1&&r===1)}static Translation(e,t,r){let i=new m;return m.TranslationToRef(e,t,r,i),i}static TranslationToRef(e,t,r,i){m.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,e,t,r,1,i),i._updateIdentityStatus(e===0&&t===0&&r===0)}static Lerp(e,t,r){let i=new m;return m.LerpToRef(e,t,r,i),i}static LerpToRef(e,t,r,i){for(let o=0;o<16;o++)i._m[o]=e._m[o]*(1-r)+t._m[o]*r;i._markAsUpdated()}static DecomposeLerp(e,t,r){let i=new m;return m.DecomposeLerpToRef(e,t,r,i),i}static DecomposeLerpToRef(e,t,r,i){let o=H.MathTmp.Vector3[0],a=H.MathTmp.Quaternion[0],d=H.MathTmp.Vector3[1];e.decompose(o,a,d);let s=H.MathTmp.Vector3[2],l=H.MathTmp.Quaternion[1],u=H.MathTmp.Vector3[3];t.decompose(s,l,u);let c=H.MathTmp.Vector3[4];De.Vector3.LerpToRef(o,s,r,c);let h=H.MathTmp.Quaternion[2];Li.Quaternion.SlerpToRef(a,l,r,h);let p=H.MathTmp.Vector3[5];De.Vector3.LerpToRef(d,u,r,p),m.ComposeToRef(c,h,p,i)}static LookAtLH(e,t,r){let i=new m;return m.LookAtLHToRef(e,t,r,i),i}static LookAtLHToRef(e,t,r,i){let o=H.MathTmp.Vector3[0],a=H.MathTmp.Vector3[1],d=H.MathTmp.Vector3[2];t.subtractToRef(e,d),d.normalize(),De.Vector3.CrossToRef(r,d,o);let s=o.lengthSquared();s===0?o.x=1:o.normalizeFromLength(Math.sqrt(s)),De.Vector3.CrossToRef(d,o,a),a.normalize();let l=-De.Vector3.Dot(o,e),u=-De.Vector3.Dot(a,e),c=-De.Vector3.Dot(d,e);m.FromValuesToRef(o.x,a.x,d.x,0,o.y,a.y,d.y,0,o.z,a.z,d.z,0,l,u,c,1,i)}static LookAtRH(e,t,r){let i=new m;return m.LookAtRHToRef(e,t,r,i),i}static LookAtRHToRef(e,t,r,i){let o=H.MathTmp.Vector3[0],a=H.MathTmp.Vector3[1],d=H.MathTmp.Vector3[2];e.subtractToRef(t,d),d.normalize(),De.Vector3.CrossToRef(r,d,o);let s=o.lengthSquared();s===0?o.x=1:o.normalizeFromLength(Math.sqrt(s)),De.Vector3.CrossToRef(d,o,a),a.normalize();let l=-De.Vector3.Dot(o,e),u=-De.Vector3.Dot(a,e),c=-De.Vector3.Dot(d,e);m.FromValuesToRef(o.x,a.x,d.x,0,o.y,a.y,d.y,0,o.z,a.z,d.z,0,l,u,c,1,i)}static OrthoLH(e,t,r,i){let o=new m;return m.OrthoLHToRef(e,t,r,i,o),o}static OrthoLHToRef(e,t,r,i,o){let a=r,d=i,s=2/e,l=2/t,u=2/(d-a),c=-(d+a)/(d-a);m.FromValuesToRef(s,0,0,0,0,l,0,0,0,0,u,0,0,0,c,1,o),o._updateIdentityStatus(s===1&&l===1&&u===1&&c===0)}static OrthoOffCenterLH(e,t,r,i,o,a){let d=new m;return m.OrthoOffCenterLHToRef(e,t,r,i,o,a,d),d}static OrthoOffCenterLHToRef(e,t,r,i,o,a,d){let s=o,l=a,u=2/(t-e),c=2/(i-r),h=2/(l-s),p=-(l+s)/(l-s),y=(e+t)/(e-t),g=(i+r)/(r-i);m.FromValuesToRef(u,0,0,0,0,c,0,0,0,0,h,0,y,g,p,1,d),d._markAsUpdated()}static OrthoOffCenterRH(e,t,r,i,o,a){let d=new m;return m.OrthoOffCenterRHToRef(e,t,r,i,o,a,d),d}static OrthoOffCenterRHToRef(e,t,r,i,o,a,d){m.OrthoOffCenterLHToRef(e,t,r,i,o,a,d),d._m[10]*=-1}static PerspectiveLH(e,t,r,i){let o=new m,a=r,d=i,s=2*a/e,l=2*a/t,u=(d+a)/(d-a),c=-2*d*a/(d-a);return m.FromValuesToRef(s,0,0,0,0,l,0,0,0,0,u,1,0,0,c,0,o),o._updateIdentityStatus(!1),o}static PerspectiveFovLH(e,t,r,i){let o=new m;return m.PerspectiveFovLHToRef(e,t,r,i,o),o}static PerspectiveFovLHToRef(e,t,r,i,o,a=!0){let d=r,s=i,l=1/Math.tan(e*.5),u=a?l/t:l,c=a?l:l*t,h=(s+d)/(s-d),p=-2*s*d/(s-d);m.FromValuesToRef(u,0,0,0,0,c,0,0,0,0,h,1,0,0,p,0,o),o._updateIdentityStatus(!1)}static PerspectiveFovRH(e,t,r,i){let o=new m;return m.PerspectiveFovRHToRef(e,t,r,i,o),o}static PerspectiveFovRHToRef(e,t,r,i,o,a=!0){let d=r,s=i,l=1/Math.tan(e*.5),u=a?l/t:l,c=a?l:l*t,h=-(s+d)/(s-d),p=-2*s*d/(s-d);m.FromValuesToRef(u,0,0,0,0,c,0,0,0,0,h,-1,0,0,p,0,o),o._updateIdentityStatus(!1)}static PerspectiveFovWebVRToRef(e,t,r,i,o=!1){let a=o?-1:1,d=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),l=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),c=2/(l+u),h=2/(d+s),p=i._m;p[0]=c,p[1]=p[2]=p[3]=p[4]=0,p[5]=h,p[6]=p[7]=0,p[8]=(l-u)*c*.5,p[9]=-((d-s)*h*.5),p[10]=-r/(t-r),p[11]=1*a,p[12]=p[13]=p[15]=0,p[14]=-(2*r*t)/(r-t),i._markAsUpdated()}static GetAsMatrix2x2(e){return[e._m[0],e._m[1],e._m[4],e._m[5]]}static GetAsMatrix3x3(e){return[e._m[0],e._m[1],e._m[2],e._m[4],e._m[5],e._m[6],e._m[8],e._m[9],e._m[10]]}static Transpose(e){let t=new m;return m.TransposeToRef(e,t),t}static TransposeToRef(e,t){let r=t._m,i=e._m;r[0]=i[0],r[1]=i[4],r[2]=i[8],r[3]=i[12],r[4]=i[1],r[5]=i[5],r[6]=i[9],r[7]=i[13],r[8]=i[2],r[9]=i[6],r[10]=i[10],r[11]=i[14],r[12]=i[3],r[13]=i[7],r[14]=i[11],r[15]=i[15],t._updateIdentityStatus(e._isIdentity,e._isIdentityDirty)}static Reflection(e){let t=new m;return m.ReflectionToRef(e,t),t}static ReflectionToRef(e,t){e.normalize();let r=e.normal.x,i=e.normal.y,o=e.normal.z,a=-2*r,d=-2*i,s=-2*o;m.FromValuesToRef(a*r+1,d*r,s*r,0,a*i,d*i+1,s*i,0,a*o,d*o,s*o+1,0,a*e.d,d*e.d,s*e.d,1,t)}static FromXYZAxesToRef(e,t,r,i){m.FromValuesToRef(e.x,e.y,e.z,0,t.x,t.y,t.z,0,r.x,r.y,r.z,0,0,0,0,1,i)}static FromQuaternionToRef(e,t){let r=e.x*e.x,i=e.y*e.y,o=e.z*e.z,a=e.x*e.y,d=e.z*e.w,s=e.z*e.x,l=e.y*e.w,u=e.y*e.z,c=e.x*e.w;t._m[0]=1-2*(i+o),t._m[1]=2*(a+d),t._m[2]=2*(s-l),t._m[3]=0,t._m[4]=2*(a-d),t._m[5]=1-2*(o+r),t._m[6]=2*(u+c),t._m[7]=0,t._m[8]=2*(s+l),t._m[9]=2*(u-c),t._m[10]=1-2*(i+r),t._m[11]=0,t._m[12]=0,t._m[13]=0,t._m[14]=0,t._m[15]=1,t._markAsUpdated()}_markAsUpdated(){this.updateFlag=m._updateFlagSeed++,this._isIdentity=!1,this._isIdentity3x2=!1,this._isIdentityDirty=!0,this._isIdentity3x2Dirty=!0}isIdentity(){if(this._isIdentityDirty){this._isIdentityDirty=!1;let e=this._m;this._isIdentity=e[0]===1&&e[1]===0&&e[2]===0&&e[3]===0&&e[4]===0&&e[5]===1&&e[6]===0&&e[7]===0&&e[8]===0&&e[9]===0&&e[10]===1&&e[11]===0&&e[12]===0&&e[13]===0&&e[14]===0&&e[15]===1}return this._isIdentity}isIdentityAs3x2(){return this._isIdentity3x2Dirty&&(this._isIdentity3x2Dirty=!1,this._m[0]!==1||this._m[5]!==1||this._m[15]!==1?this._isIdentity3x2=!1:this._m[1]!==0||this._m[2]!==0||this._m[3]!==0||this._m[4]!==0||this._m[6]!==0||this._m[7]!==0||this._m[8]!==0||this._m[9]!==0||this._m[10]!==0||this._m[11]!==0||this._m[12]!==0||this._m[13]!==0||this._m[14]!==0?this._isIdentity3x2=!1:this._isIdentity3x2=!0),this._isIdentity3x2}determinant(){if(this._isIdentity===!0)return 1;let e=this._m,t=e[0],r=e[1],i=e[2],o=e[3],a=e[4],d=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],p=e[11],y=e[12],g=e[13],E=e[14],M=e[15],T=h*M-E*p,F=c*M-g*p,V=c*E-g*h,ue=u*M-y*p,ge=u*E-h*y,Se=u*g-y*c,xe=+(d*T-s*F+l*V),qe=-(a*T-s*ue+l*ge),Fe=+(a*F-d*ue+l*Se),Ke=-(a*V-d*ge+s*Se);return t*xe+r*qe+i*Fe+o*Ke}toArray(){return this._m}asArray(){return this._m}invert(){return this.invertToRef(this),this}reset(){return m.FromValuesToRef(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,this),this._updateIdentityStatus(!1),this}add(e){let t=new m;return this.addToRef(e,t),t}addToRef(e,t){for(let r=0;r<16;r++)t._m[r]=this._m[r]+e._m[r];return t._markAsUpdated(),this}addToSelf(e){for(let t=0;t<16;t++)this._m[t]+=e._m[t];return this._markAsUpdated(),this}invertToRef(e){if(this._isIdentity===!0)return m.IdentityToRef(e),this;let t=this._m,r=t[0],i=t[1],o=t[2],a=t[3],d=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],p=t[10],y=t[11],g=t[12],E=t[13],M=t[14],T=t[15],F=p*T-M*y,V=h*T-E*y,ue=h*M-E*p,ge=c*T-g*y,Se=c*M-p*g,xe=c*E-g*h,qe=+(s*F-l*V+u*ue),Fe=-(d*F-l*ge+u*Se),Ke=+(d*V-s*ge+u*xe),Xe=-(d*ue-s*Se+l*xe),pn=r*qe+i*Fe+o*Ke+a*Xe;if(pn===0)return e.copyFrom(this),this;let Z=1/pn,D=l*T-M*u,j=s*T-E*u,ce=s*M-E*l,Te=d*T-g*u,hn=d*M-g*l,bn=d*E-g*s,An=l*y-p*u,yo=s*y-h*u,mo=s*p-h*l,Ro=d*y-c*u,Po=d*p-c*l,go=d*h-c*s,ic=-(i*F-o*V+a*ue),oc=+(r*F-o*ge+a*Se),ac=-(r*V-i*ge+a*xe),sc=+(r*ue-i*Se+o*xe),dc=+(i*D-o*j+a*ce),lc=-(r*D-o*Te+a*hn),uc=+(r*j-i*Te+a*bn),cc=-(r*ce-i*hn+o*bn),fc=-(i*An-o*yo+a*mo),pc=+(r*An-o*Ro+a*Po),hc=-(r*yo-i*Ro+a*go),yc=+(r*mo-i*Po+o*go);return m.FromValuesToRef(qe*Z,ic*Z,dc*Z,fc*Z,Fe*Z,oc*Z,lc*Z,pc*Z,Ke*Z,ac*Z,uc*Z,hc*Z,Xe*Z,sc*Z,cc*Z,yc*Z,e),this}addAtIndex(e,t){return this._m[e]+=t,this._markAsUpdated(),this}multiplyAtIndex(e,t){return this._m[e]*=t,this._markAsUpdated(),this}setTranslationFromFloats(e,t,r){return this._m[12]=e,this._m[13]=t,this._m[14]=r,this._markAsUpdated(),this}setTranslation(e){return this.setTranslationFromFloats(e.x,e.y,e.z)}getTranslation(){return new De.Vector3(this._m[12],this._m[13],this._m[14])}getTranslationToRef(e){return e.x=this._m[12],e.y=this._m[13],e.z=this._m[14],this}removeRotationAndScaling(){let e=this.m;return m.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,e[12],e[13],e[14],e[15],this),this._updateIdentityStatus(e[12]===0&&e[13]===0&&e[14]===0&&e[15]===1),this}multiply(e){let t=new m;return this.multiplyToRef(e,t),t}copyFrom(e){e.copyToArray(this._m);let t=e;return this._updateIdentityStatus(t._isIdentity,t._isIdentityDirty,t._isIdentity3x2,t._isIdentity3x2Dirty),this}copyToArray(e,t=0){for(let r=0;r<16;r++)e[t+r]=this._m[r];return this}multiplyToRef(e,t){return this._isIdentity?(t.copyFrom(e),this):e._isIdentity?(t.copyFrom(this),this):(this.multiplyToArray(e,t._m,0),t._markAsUpdated(),this)}multiplyToArray(e,t,r){let i=this._m,o=e.m,a=i[0],d=i[1],s=i[2],l=i[3],u=i[4],c=i[5],h=i[6],p=i[7],y=i[8],g=i[9],E=i[10],M=i[11],T=i[12],F=i[13],V=i[14],ue=i[15],ge=o[0],Se=o[1],xe=o[2],qe=o[3],Fe=o[4],Ke=o[5],Xe=o[6],pn=o[7],Z=o[8],D=o[9],j=o[10],ce=o[11],Te=o[12],hn=o[13],bn=o[14],An=o[15];return t[r]=a*ge+d*Fe+s*Z+l*Te,t[r+1]=a*Se+d*Ke+s*D+l*hn,t[r+2]=a*xe+d*Xe+s*j+l*bn,t[r+3]=a*qe+d*pn+s*ce+l*An,t[r+4]=u*ge+c*Fe+h*Z+p*Te,t[r+5]=u*Se+c*Ke+h*D+p*hn,t[r+6]=u*xe+c*Xe+h*j+p*bn,t[r+7]=u*qe+c*pn+h*ce+p*An,t[r+8]=y*ge+g*Fe+E*Z+M*Te,t[r+9]=y*Se+g*Ke+E*D+M*hn,t[r+10]=y*xe+g*Xe+E*j+M*bn,t[r+11]=y*qe+g*pn+E*ce+M*An,t[r+12]=T*ge+F*Fe+V*Z+ue*Te,t[r+13]=T*Se+F*Ke+V*D+ue*hn,t[r+14]=T*xe+F*Xe+V*j+ue*bn,t[r+15]=T*qe+F*pn+V*ce+ue*An,this}equals(e){let t=e;if(!t)return!1;if((this._isIdentity||t._isIdentity)&&!this._isIdentityDirty&&!t._isIdentityDirty)return this._isIdentity&&t._isIdentity;let r=this.m,i=t.m;return r[0]===i[0]&&r[1]===i[1]&&r[2]===i[2]&&r[3]===i[3]&&r[4]===i[4]&&r[5]===i[5]&&r[6]===i[6]&&r[7]===i[7]&&r[8]===i[8]&&r[9]===i[9]&&r[10]===i[10]&&r[11]===i[11]&&r[12]===i[12]&&r[13]===i[13]&&r[14]===i[14]&&r[15]===i[15]}clone(){let e=new m;return e.copyFrom(this),e}getClassName(){return"Matrix"}getHashCode(){let e=this._m[0]||0;for(let t=1;t<16;t++)e=e*397^(this._m[t]||0);return e}decompose(e,t,r){if(this._isIdentity)return r&&r.setAll(0),e&&e.setAll(1),t&&t.copyFromFloats(0,0,0,1),!0;let i=this._m;r&&r.copyFromFloats(i[12],i[13],i[14]);let o=e||H.MathTmp.Vector3[0];if(o.x=Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]),o.y=Math.sqrt(i[4]*i[4]+i[5]*i[5]+i[6]*i[6]),o.z=Math.sqrt(i[8]*i[8]+i[9]*i[9]+i[10]*i[10]),this.determinant()<=0&&(o.y*=-1),o.x===0||o.y===0||o.z===0)return t&&t.copyFromFloats(0,0,0,1),!1;if(t){let a=1/o.x,d=1/o.y,s=1/o.z;m.FromValuesToRef(i[0]*a,i[1]*a,i[2]*a,0,i[4]*d,i[5]*d,i[6]*d,0,i[8]*s,i[9]*s,i[10]*s,0,0,0,0,1,H.MathTmp.Matrix[0]),Li.Quaternion.FromRotationMatrixToRef(H.MathTmp.Matrix[0],t)}return!0}getRow(e){if(e<0||e>3)return null;let t=e*4;return new Kp.Vector4(this._m[t+0],this._m[t+1],this._m[t+2],this._m[t+3])}setRow(e,t){return this.setRowFromFloats(e,t.x,t.y,t.z,t.w)}transpose(){return m.Transpose(this)}transposeToRef(e){return m.TransposeToRef(this,e),this}setRowFromFloats(e,t,r,i,o){if(e<0||e>3)return this;let a=e*4;return this._m[a+0]=t,this._m[a+1]=r,this._m[a+2]=i,this._m[a+3]=o,this._markAsUpdated(),this}scale(e){let t=new m;return this.scaleToRef(e,t),t}scaleToRef(e,t){for(let r=0;r<16;r++)t._m[r]=this._m[r]*e;return t._markAsUpdated(),this}scaleAndAddToRef(e,t){for(let r=0;r<16;r++)t._m[r]+=this._m[r]*e;return t._markAsUpdated(),this}toNormalMatrix(e){let t=H.MathTmp.Matrix[0];this.invertToRef(t),t.transposeToRef(e);let r=e._m;m.FromValuesToRef(r[0],r[1],r[2],0,r[4],r[5],r[6],0,r[8],r[9],r[10],0,0,0,0,1,e)}getRotationMatrix(){let e=new m;return this.getRotationMatrixToRef(e),e}getRotationMatrixToRef(e){let t=H.MathTmp.Vector3[0];if(!this.decompose(t))return m.IdentityToRef(e),this;let r=this._m,i=1/t.x,o=1/t.y,a=1/t.z;return m.FromValuesToRef(r[0]*i,r[1]*i,r[2]*i,0,r[4]*o,r[5]*o,r[6]*o,0,r[8]*a,r[9]*a,r[10]*a,0,0,0,0,1,e),this}toggleModelMatrixHandInPlace(){let e=this._m;e[2]*=-1,e[6]*=-1,e[8]*=-1,e[9]*=-1,e[14]*=-1,this._markAsUpdated()}toggleProjectionMatrixHandInPlace(){let e=this._m;e[8]*=-1,e[9]*=-1,e[10]*=-1,e[11]*=-1,this._markAsUpdated()}_updateIdentityStatus(e,t=!1,r=!1,i=!0){this.updateFlag=m._updateFlagSeed++,this._isIdentity=e,this._isIdentity3x2=e||r,this._isIdentityDirty=this._isIdentity?!1:t,this._isIdentity3x2Dirty=this._isIdentity3x2?!1:i}};Sr.Matrix=m;m._updateFlagSeed=0;m._identityReadOnly=m.Identity()});var Zt=x(Tr=>{f();"use strict";Object.defineProperty(Tr,"__esModule",{value:!0});Tr.Quaternion=void 0;var Vl=Vt(),Fn=sn(),xr=Zn(),Re=Ze(),Gi=Rn(),w=class{constructor(e=0,t=0,r=0,i=1){this.x=e,this.y=t,this.z=r,this.w=i}static FromRotationMatrix(e){let t=new w;return w.FromRotationMatrixToRef(e,t),t}static FromRotationMatrixToRef(e,t){let r=e.m,i=r[0],o=r[4],a=r[8],d=r[1],s=r[5],l=r[9],u=r[2],c=r[6],h=r[10],p=i+s+h,y;p>0?(y=.5/Math.sqrt(p+1),t.w=.25/y,t.x=(c-l)*y,t.y=(a-u)*y,t.z=(d-o)*y):i>s&&i>h?(y=2*Math.sqrt(1+i-s-h),t.w=(c-l)/y,t.x=.25*y,t.y=(o+d)/y,t.z=(a+u)/y):s>h?(y=2*Math.sqrt(1+s-i-h),t.w=(a-u)/y,t.x=(o+d)/y,t.y=.25*y,t.z=(l+c)/y):(y=2*Math.sqrt(1+h-i-s),t.w=(d-o)/y,t.x=(a+u)/y,t.y=(l+c)/y,t.z=.25*y)}static Dot(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w}static AreClose(e,t){return w.Dot(e,t)>=0}static Zero(){return new w(0,0,0,0)}static Inverse(e){return new w(-e.x,-e.y,-e.z,e.w)}static IsIdentity(e){return e&&e.x===0&&e.y===0&&e.z===0&&e.w===1}static RotationAxis(e,t){let r=t*Re.DEG2RAD;return w.RotationAxisToRef(e,r,new w)}static RotationAxisToRef(e,t,r){let i=t*Re.DEG2RAD,o=Math.sin(i/2);return e.normalize(),r.w=Math.cos(i/2),r.x=e.x*o,r.y=e.y*o,r.z=e.z*o,r}static FromArray(e,t=0){return new w(e[t],e[t+1],e[t+2],e[t+3])}static FromEulerAnglesRef(e,t,r,i){return w.RotationYawPitchRollToRef(t*Re.DEG2RAD,e*Re.DEG2RAD,r*Re.DEG2RAD,i)}static RotationYawPitchRoll(e,t,r){let i=new w;return w.RotationYawPitchRollToRef(e,t,r,i),i}static RotationYawPitchRollToRef(e,t,r,i){let o=t*.5,a=e*.5,d=r*.5,s=Math.cos(o),l=Math.cos(a),u=Math.cos(d),c=Math.sin(o),h=Math.sin(a),p=Math.sin(d);i.x=l*c*u+h*s*p,i.y=h*s*u-l*c*p,i.z=l*s*p-h*c*u,i.w=l*s*u+h*c*p}static RotationAlphaBetaGamma(e,t,r){let i=new w;return w.RotationAlphaBetaGammaToRef(e,t,r,i),i}static RotationAlphaBetaGammaToRef(e,t,r,i){let o=(r+e)*.5,a=(r-e)*.5,d=t*.5;i.x=Math.cos(a)*Math.sin(d),i.y=Math.sin(a)*Math.sin(d),i.z=Math.sin(o)*Math.cos(d),i.w=Math.cos(o)*Math.cos(d)}static RotationQuaternionFromAxis(e,t,r){let i=new w(0,0,0,0);return w.RotationQuaternionFromAxisToRef(e,t,r,i),i}static RotationQuaternionFromAxisToRef(e,t,r,i){let o=xr.MathTmp.Matrix[0];Vl.Matrix.FromXYZAxesToRef(e.normalize(),t.normalize(),r.normalize(),o),w.FromRotationMatrixToRef(o,i)}static Slerp(e,t,r){let i=w.Identity;return w.SlerpToRef(e,t,r,i),i}static SlerpToRef(e,t,r,i){let o,a,d=e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w,s=!1;if(d<0&&(s=!0,d=-d),d>.999999)a=1-r,o=s?-r:r;else{let l=Math.acos(d),u=1/Math.sin(l);a=Math.sin((1-r)*l)*u,o=s?-Math.sin(r*l)*u:Math.sin(r*l)*u}i.x=a*e.x+o*t.x,i.y=a*e.y+o*t.y,i.z=a*e.z+o*t.z,i.w=a*e.w+o*t.w}static Hermite(e,t,r,i,o){let a=o*o,d=o*a,s=2*d-3*a+1,l=-2*d+3*a,u=d-2*a+o,c=d-a,h=e.x*s+r.x*l+t.x*u+i.x*c,p=e.y*s+r.y*l+t.y*u+i.y*c,y=e.z*s+r.z*l+t.z*u+i.z*c,g=e.w*s+r.w*l+t.w*u+i.w*c;return new w(h,p,y,g)}static get Identity(){return new w(0,0,0,1)}static Angle(e,t){let r=w.Dot(e,t);return Math.acos(Math.min(Math.abs(r),1))*2*Re.RAD2DEG}static Euler(e,t,r){return w.RotationYawPitchRoll(t*Re.DEG2RAD,e*Re.DEG2RAD,r*Re.DEG2RAD)}static LookRotation(e,t=xr.MathTmp.staticUp){let r=Fn.Vector3.Normalize(e),i=Fn.Vector3.Normalize(Fn.Vector3.Cross(t,r)),o=Fn.Vector3.Cross(r,i),a=i.x,d=i.y,s=i.z,l=o.x,u=o.y,c=o.z,h=r.x,p=r.y,y=r.z,g=a+u+y,E=new w;if(g>0){let F=Math.sqrt(g+1);return E.w=F*.5,F=.5/F,E.x=(c-p)*F,E.y=(h-s)*F,E.z=(d-l)*F,E}if(a>=u&&a>=y){let F=Math.sqrt(1+a-u-y),V=.5/F;return E.x=.5*F,E.y=(d+l)*V,E.z=(s+h)*V,E.w=(c-p)*V,E}if(u>y){let F=Math.sqrt(1+u-a-y),V=.5/F;return E.x=(l+d)*V,E.y=.5*F,E.z=(p+c)*V,E.w=(h-s)*V,E}let M=Math.sqrt(1+y-a-u),T=.5/M;return E.x=(h+s)*T,E.y=(p+c)*T,E.z=.5*M,E.w=(d-l)*T,E}static RotateTowards(e,t,r){let i=w.Angle(e,t);if(i===0)return t;let o=Math.min(1,r/i);return w.Slerp(e,t,o)}static FromToRotation(e,t,r=xr.MathTmp.staticUp){let i=e.normalize(),o=t.normalize(),a=Fn.Vector3.Cross(i,o),d=Math.sqrt(i.lengthSquared()*o.lengthSquared())+Fn.Vector3.Dot(i,o);return a.lengthSquared()<1e-4?Math.abs(d)<1e-4?new w(r.x,r.y,r.z,0).normalized:w.Identity:new w(a.x,a.y,a.z,d).normalized}get normalized(){return this.normalize()}setFromToRotation(e,t,r=xr.MathTmp.staticUp){let i=w.FromToRotation(e,t,r);this.x=i.x,this.y=i.y,this.z=i.z,this.w=i.w}set eulerAngles(e){this.setEuler(e.x,e.y,e.z)}get eulerAngles(){let e=new Fn.Vector3,t=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w,r=this.x*this.w-this.y*this.z;return r>.4995*t?(e.x=Math.PI/2,e.y=2*Math.atan2(this.y,this.x),e.z=0):r<-.4995*t?(e.x=-Math.PI/2,e.y=-2*Math.atan2(this.y,this.x),e.z=0):(e.x=Math.asin(2*(this.w*this.x-this.y*this.z)),e.y=Math.atan2(2*this.w*this.y+2*this.z*this.x,1-2*(this.x*this.x+this.y*this.y)),e.z=Math.atan2(2*this.w*this.z+2*this.x*this.y,1-2*(this.z*this.z+this.x*this.x))),e.x*=Re.RAD2DEG,e.y*=Re.RAD2DEG,e.z*=Re.RAD2DEG,e.x=Gi.Scalar.Repeat(e.x,360),e.y=Gi.Scalar.Repeat(e.y,360),e.z=Gi.Scalar.Repeat(e.z,360),e}toString(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`}get length(){return Math.sqrt(this.lengthSquared)}get lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}getClassName(){return"Quaternion"}getHashCode(){let e=this.x||0;return e=e*397^(this.y||0),e=e*397^(this.z||0),e=e*397^(this.w||0),e}asArray(){return[this.x,this.y,this.z,this.w]}equals(e){return e&&this.x===e.x&&this.y===e.y&&this.z===e.z&&this.w===e.w}clone(){return new w(this.x,this.y,this.z,this.w)}copyFrom(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}copyFromFloats(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}set(e,t,r,i){return this.copyFromFloats(e,t,r,i)}setEuler(e,t,r){return w.RotationYawPitchRollToRef(t*Re.DEG2RAD,e*Re.DEG2RAD,r*Re.DEG2RAD,this),this}add(e){return new w(this.x+e.x,this.y+e.y,this.z+e.z,this.w+e.w)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}subtract(e){return new w(this.x-e.x,this.y-e.y,this.z-e.z,this.w-e.w)}scale(e){return new w(this.x*e,this.y*e,this.z*e,this.w*e)}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,t.z=this.z*e,t.w=this.w*e,this}scaleInPlace(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,t.z+=this.z*e,t.w+=this.w*e,this}multiply(e){let t=new w(0,0,0,1);return this.multiplyToRef(e,t),t}multiplyToRef(e,t){let r=this.x*e.w+this.y*e.z-this.z*e.y+this.w*e.x,i=-this.x*e.z+this.y*e.w+this.z*e.x+this.w*e.y,o=this.x*e.y-this.y*e.x+this.z*e.w+this.w*e.z,a=-this.x*e.x-this.y*e.y-this.z*e.z+this.w*e.w;return t.copyFromFloats(r,i,o,a),this}multiplyInPlace(e){return this.multiplyToRef(e,this),this}conjugateToRef(e){return e.copyFromFloats(-this.x,-this.y,-this.z,this.w),this}conjugateInPlace(){return this.x*=-1,this.y*=-1,this.z*=-1,this}conjugate(){return new w(-this.x,-this.y,-this.z,this.w)}normalize(){let e=1/this.length;return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}angleAxis(e,t){if(t.lengthSquared()===0)return w.Identity;let r=w.Identity,i=e*Re.DEG2RAD;i*=.5;let o=t.normalize();return o=t.scaleInPlace(Math.sin(i)),r.x=o.x,r.y=o.y,r.z=o.z,r.w=Math.cos(i),r.normalize()}toRotationMatrix(e){return Vl.Matrix.FromQuaternionToRef(this,e),this}fromRotationMatrix(e){return w.FromRotationMatrixToRef(e,this),this}};Tr.Quaternion=w});var sn=x(Er=>{f();"use strict";Object.defineProperty(Er,"__esModule",{value:!0});Er.Vector3=void 0;var Ir=Zn(),Xp=Ze(),Zl=Zt(),$i=Rn(),_=class{constructor(e=0,t=0,r=0){this.x=e,this.y=t,this.z=r}get isNonUniform(){let e=Math.abs(this.x),t=Math.abs(this.y);if(e!==t)return!0;let r=Math.abs(this.z);return e!==r||t!==r}static Add(e,t){return new _(e.x,e.y,e.z).addInPlace(t)}static GetClipFactor(e,t,r,i){let o=_.Dot(e,r)-i,a=_.Dot(t,r)-i;return o/(o-a)}static GetAngleBetweenVectors(e,t,r){let i=e.normalizeToRef(Ir.MathTmp.Vector3[1]),o=t.normalizeToRef(Ir.MathTmp.Vector3[2]),a=_.Dot(i,o),d=Ir.MathTmp.Vector3[3];return _.CrossToRef(i,o,d),_.Dot(d,r)>0?Math.acos(a):-Math.acos(a)}static FromArray(e,t=0){return new _(e[t],e[t+1],e[t+2])}static FromFloatArray(e,t){return _.FromArray(e,t)}static FromArrayToRef(e,t,r){r.x=e[t],r.y=e[t+1],r.z=e[t+2]}static FromFloatArrayToRef(e,t,r){return _.FromArrayToRef(e,t,r)}static FromFloatsToRef(e,t,r,i){i.copyFromFloats(e,t,r)}static Zero(){return new _(0,0,0)}static One(){return new _(1,1,1)}static Up(){return new _(0,1,0)}static Down(){return new _(0,-1,0)}static Forward(){return new _(0,0,1)}static Backward(){return new _(0,0,-1)}static Right(){return new _(1,0,0)}static Left(){return new _(-1,0,0)}static TransformCoordinates(e,t){let r=_.Zero();return _.TransformCoordinatesToRef(e,t,r),r}static TransformCoordinatesToRef(e,t,r){return _.TransformCoordinatesFromFloatsToRef(e.x,e.y,e.z,t,r)}static TransformCoordinatesFromFloatsToRef(e,t,r,i,o){let a=i.m,d=e*a[0]+t*a[4]+r*a[8]+a[12],s=e*a[1]+t*a[5]+r*a[9]+a[13],l=e*a[2]+t*a[6]+r*a[10]+a[14],u=1/(e*a[3]+t*a[7]+r*a[11]+a[15]);o.x=d*u,o.y=s*u,o.z=l*u}static TransformNormal(e,t){let r=_.Zero();return _.TransformNormalToRef(e,t,r),r}static TransformNormalToRef(e,t,r){this.TransformNormalFromFloatsToRef(e.x,e.y,e.z,t,r)}static TransformNormalFromFloatsToRef(e,t,r,i,o){let a=i.m;o.x=e*a[0]+t*a[4]+r*a[8],o.y=e*a[1]+t*a[5]+r*a[9],o.z=e*a[2]+t*a[6]+r*a[10]}static CatmullRom(e,t,r,i,o){let a=o*o,d=o*a,s=.5*(2*t.x+(-e.x+r.x)*o+(2*e.x-5*t.x+4*r.x-i.x)*a+(-e.x+3*t.x-3*r.x+i.x)*d),l=.5*(2*t.y+(-e.y+r.y)*o+(2*e.y-5*t.y+4*r.y-i.y)*a+(-e.y+3*t.y-3*r.y+i.y)*d),u=.5*(2*t.z+(-e.z+r.z)*o+(2*e.z-5*t.z+4*r.z-i.z)*a+(-e.z+3*t.z-3*r.z+i.z)*d);return new _(s,l,u)}static Clamp(e,t,r){let i=new _;return _.ClampToRef(e,t,r,i),i}static ClampToRef(e,t,r,i){let o=e.x;o=o>r.x?r.x:o,o=o<t.x?t.x:o;let a=e.y;a=a>r.y?r.y:a,a=a<t.y?t.y:a;let d=e.z;d=d>r.z?r.z:d,d=d<t.z?t.z:d,i.copyFromFloats(o,a,d)}static Hermite(e,t,r,i,o){let a=o*o,d=o*a,s=2*d-3*a+1,l=-2*d+3*a,u=d-2*a+o,c=d-a,h=e.x*s+r.x*l+t.x*u+i.x*c,p=e.y*s+r.y*l+t.y*u+i.y*c,y=e.z*s+r.z*l+t.z*u+i.z*c;return new _(h,p,y)}static Lerp(e,t,r){let i=new _(0,0,0);return _.LerpToRef(e,t,r,i),i}static LerpToRef(e,t,r,i){i.x=e.x+(t.x-e.x)*r,i.y=e.y+(t.y-e.y)*r,i.z=e.z+(t.z-e.z)*r}static Dot(e,t){return e.x*t.x+e.y*t.y+e.z*t.z}static Cross(e,t){let r=_.Zero();return _.CrossToRef(e,t,r),r}static CrossToRef(e,t,r){let i=e.y*t.z-e.z*t.y,o=e.z*t.x-e.x*t.z,a=e.x*t.y-e.y*t.x;r.copyFromFloats(i,o,a)}static Normalize(e){let t=_.Zero();return _.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){e.normalizeToRef(t)}static Minimize(e,t){let r=new _(e.x,e.y,e.z);return r.minimizeInPlace(t),r}static Maximize(e,t){let r=new _(e.x,e.y,e.z);return r.maximizeInPlace(t),r}static Distance(e,t){return Math.sqrt(_.DistanceSquared(e,t))}static DistanceSquared(e,t){let r=e.x-t.x,i=e.y-t.y,o=e.z-t.z;return r*r+i*i+o*o}static Center(e,t){let r=_.Add(e,t);return r.scaleInPlace(.5),r}static RotationFromAxis(e,t,r){let i=_.Zero();return _.RotationFromAxisToRef(e,t,r,i),i}static RotationFromAxisToRef(e,t,r,i){let o=Ir.MathTmp.Quaternion[0];Zl.Quaternion.RotationQuaternionFromAxisToRef(e,t,r,o),i.copyFrom(o.eulerAngles)}toString(){return`(${this.x}, ${this.y}, ${this.z})`}getClassName(){return"Vector3"}getHashCode(){let e=this.x||0;return e=e*397^(this.y||0),e=e*397^(this.z||0),e}asArray(){let e=[];return this.toArray(e,0),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,this}toQuaternion(){return Zl.Quaternion.Identity.setEuler(this.y,this.x,this.z)}addInPlace(e){return this.addInPlaceFromFloats(e.x,e.y,e.z)}addInPlaceFromFloats(e,t,r){return this.x+=e,this.y+=t,this.z+=r,this}add(e){return new _(this.x+e.x,this.y+e.y,this.z+e.z)}addToRef(e,t){return t.copyFromFloats(this.x+e.x,this.y+e.y,this.z+e.z)}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subtract(e){return new _(this.x-e.x,this.y-e.y,this.z-e.z)}subtractToRef(e,t){return this.subtractFromFloatsToRef(e.x,e.y,e.z,t)}subtractFromFloats(e,t,r){return new _(this.x-e,this.y-t,this.z-r)}subtractFromFloatsToRef(e,t,r,i){return i.copyFromFloats(this.x-e,this.y-t,this.z-r)}applyMatrix4(e){this.applyMatrix4ToRef(e,this)}applyMatrix4ToRef(e,t){let{x:r,y:i,z:o}=this,{m:a}=e,d=1/(a[3]*r+a[7]*i+a[11]*o+a[15]);return t.x=(a[0]*r+a[4]*i+a[8]*o+a[12])*d,t.y=(a[1]*r+a[5]*i+a[9]*o+a[13])*d,t.z=(a[2]*r+a[6]*i+a[10]*o+a[14])*d,t}rotate(e){return this.rotateToRef(e,this)}rotateToRef(e,t){let{x:r,y:i,z:o}=this,{x:a,y:d,z:s,w:l}=e,u=l*r+d*o-s*i,c=l*i+s*r-a*o,h=l*o+a*i-d*r,p=-a*r-d*i-s*o;return t.x=u*l+p*-a+c*-s-h*-d,t.y=c*l+p*-d+h*-a-u*-s,t.z=h*l+p*-s+u*-d-c*-a,t}negate(){return new _(-this.x,-this.y,-this.z)}scaleInPlace(e){return this.x*=e,this.y*=e,this.z*=e,this}scale(e){return new _(this.x*e,this.y*e,this.z*e)}scaleToRef(e,t){return t.copyFromFloats(this.x*e,this.y*e,this.z*e)}scaleAndAddToRef(e,t){return t.addInPlaceFromFloats(this.x*e,this.y*e,this.z*e)}equals(e){return e&&this.x===e.x&&this.y===e.y&&this.z===e.z}equalsWithEpsilon(e,t=Xp.Epsilon){return e&&$i.Scalar.WithinEpsilon(this.x,e.x,t)&&$i.Scalar.WithinEpsilon(this.y,e.y,t)&&$i.Scalar.WithinEpsilon(this.z,e.z,t)}equalsToFloats(e,t,r){return this.x===e&&this.y===t&&this.z===r}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiply(e){return this.multiplyByFloats(e.x,e.y,e.z)}multiplyToRef(e,t){return t.copyFromFloats(this.x*e.x,this.y*e.y,this.z*e.z)}multiplyByFloats(e,t,r){return new _(this.x*e,this.y*t,this.z*r)}divide(e){return new _(this.x/e.x,this.y/e.y,this.z/e.z)}divideToRef(e,t){return t.copyFromFloats(this.x/e.x,this.y/e.y,this.z/e.z)}divideInPlace(e){return this.divideToRef(e,this)}minimizeInPlace(e){return this.minimizeInPlaceFromFloats(e.x,e.y,e.z)}maximizeInPlace(e){return this.maximizeInPlaceFromFloats(e.x,e.y,e.z)}minimizeInPlaceFromFloats(e,t,r){return e<this.x&&(this.x=e),t<this.y&&(this.y=t),r<this.z&&(this.z=r),this}maximizeInPlaceFromFloats(e,t,r){return e>this.x&&(this.x=e),t>this.y&&(this.y=t),r>this.z&&(this.z=r),this}floor(){return new _(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))}fract(){return new _(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}normalize(){return this.normalizeFromLength(this.length())}normalizeFromLength(e){return e===0||e===1?this:this.scaleInPlace(1/e)}normalizeToNew(){let e=new _(0,0,0);return this.normalizeToRef(e),e}normalizeToRef(e){let t=this.length();return t===0||t===1?e.copyFromFloats(this.x,this.y,this.z):this.scaleToRef(1/t,e)}clone(){return new _(this.x,this.y,this.z)}copyFrom(e){return this.copyFromFloats(e.x,e.y,e.z)}copyFromFloats(e,t,r){return this.x=e,this.y=t,this.z=r,this}set(e,t,r){return this.copyFromFloats(e,t,r)}setAll(e){return this.x=this.y=this.z=e,this}};Er.Vector3=_});var Zn=x(kr=>{f();"use strict";Object.defineProperty(kr,"__esModule",{value:!0});kr.MathTmp=void 0;var Hi=Ql(),jl=sn(),Qp=Zt(),eu=Vt();kr.MathTmp={Vector3:(0,Hi.buildArray)(6,jl.Vector3.Zero),Matrix:(0,Hi.buildArray)(2,eu.Matrix.Identity),Quaternion:(0,Hi.buildArray)(3,Qp.Quaternion.Zero),staticUp:jl.Vector3.Up(),tmpMatrix:eu.Matrix.Zero()}});var Yi=x(_r=>{f();"use strict";Object.defineProperty(_r,"__esModule",{value:!0});_r.Angle=void 0;var jn=class{constructor(e){this._radians=e,this._radians<0&&(this._radians+=2*Math.PI)}static BetweenTwoPoints(e,t){let r=t.subtract(e),i=Math.atan2(r.y,r.x);return new jn(i)}static FromRadians(e){return new jn(e)}static FromDegrees(e){return new jn(e*Math.PI/180)}degrees(){return this._radians*180/Math.PI}radians(){return this._radians}};_r.Angle=jn});var wr=x(vr=>{f();"use strict";Object.defineProperty(vr,"__esModule",{value:!0});vr.Vector2=void 0;var Vp=Ze(),nu=Rn(),O=class{constructor(e=0,t=0){this.x=e,this.y=t}static Zero(){return new O(0,0)}static One(){return new O(1,1)}static Add(e,t){return new O(e.x,e.y).addInPlace(t)}static FromArray(e,t=0){return new O(e[t],e[t+1])}static FromArrayToRef(e,t,r){r.x=e[t],r.y=e[t+1]}static CatmullRom(e,t,r,i,o){let a=o*o,d=o*a,s=.5*(2*t.x+(-e.x+r.x)*o+(2*e.x-5*t.x+4*r.x-i.x)*a+(-e.x+3*t.x-3*r.x+i.x)*d),l=.5*(2*t.y+(-e.y+r.y)*o+(2*e.y-5*t.y+4*r.y-i.y)*a+(-e.y+3*t.y-3*r.y+i.y)*d);return new O(s,l)}static Clamp(e,t,r){let i=e.x;i=i>r.x?r.x:i,i=i<t.x?t.x:i;let o=e.y;return o=o>r.y?r.y:o,o=o<t.y?t.y:o,new O(i,o)}static Hermite(e,t,r,i,o){let a=o*o,d=o*a,s=2*d-3*a+1,l=-2*d+3*a,u=d-2*a+o,c=d-a,h=e.x*s+r.x*l+t.x*u+i.x*c,p=e.y*s+r.y*l+t.y*u+i.y*c;return new O(h,p)}static Lerp(e,t,r){let i=e.x+(t.x-e.x)*r,o=e.y+(t.y-e.y)*r;return new O(i,o)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=new O(e.x,e.y);return t.normalize(),t}static Minimize(e,t){let r=e.x<t.x?e.x:t.x,i=e.y<t.y?e.y:t.y;return new O(r,i)}static Maximize(e,t){let r=e.x>t.x?e.x:t.x,i=e.y>t.y?e.y:t.y;return new O(r,i)}static Transform(e,t){let r=O.Zero();return O.TransformToRef(e,t,r),r}static TransformToRef(e,t,r){let i=t.m,o=e.x*i[0]+e.y*i[4]+i[12],a=e.x*i[1]+e.y*i[5]+i[13];r.x=o,r.y=a}static PointInTriangle(e,t,r,i){let o=1/2*(-r.y*i.x+t.y*(-r.x+i.x)+t.x*(r.y-i.y)+r.x*i.y),a=o<0?-1:1,d=(t.y*i.x-t.x*i.y+(i.y-t.y)*e.x+(t.x-i.x)*e.y)*a,s=(t.x*r.y-t.y*r.x+(t.y-r.y)*e.x+(r.x-t.x)*e.y)*a;return d>0&&s>0&&d+s<2*o*a}static Distance(e,t){return Math.sqrt(O.DistanceSquared(e,t))}static DistanceSquared(e,t){let r=e.x-t.x,i=e.y-t.y;return r*r+i*i}static Center(e,t){let r=O.Add(e,t);return r.scaleInPlace(.5),r}static DistanceOfPointFromSegment(e,t,r){let i=O.DistanceSquared(t,r);if(i===0)return O.Distance(e,t);let o=r.subtract(t),a=Math.max(0,Math.min(1,O.Dot(e.subtract(t),o)/i)),d=t.add(o.multiplyByFloats(a,a));return O.Distance(e,d)}toString(){return"{X: "+this.x+" Y:"+this.y+"}"}getClassName(){return"Vector2"}getHashCode(){let e=this.x||0;return e=e*397^(this.y||0),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new O(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}addVector3(e){return new O(this.x+e.x,this.y+e.y)}subtract(e){return new O(this.x-e.x,this.y-e.y)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new O(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new O(this.x*e,this.y*t)}divide(e){return new O(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new O(-this.x,-this.y)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new O(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}equalsWithEpsilon(e,t=Vp.Epsilon){return e&&nu.Scalar.WithinEpsilon(this.x,e.x,t)&&nu.Scalar.WithinEpsilon(this.y,e.y,t)}floor(){return new O(Math.floor(this.x),Math.floor(this.y))}fract(){return new O(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){let e=this.length();if(e===0)return this;let t=1/e;return this.x*=t,this.y*=t,this}clone(){return new O(this.x,this.y)}};vr.Vector2=O});var Xi=x(Br=>{f();"use strict";Object.defineProperty(Br,"__esModule",{value:!0});Br.Arc2=void 0;var Cr=Yi(),Zp=wr(),Ki=Ze(),tu=class{constructor(e,t,r){this.startPoint=e,this.midPoint=t,this.endPoint=r;let i=Math.pow(t.x,2)+Math.pow(t.y,2),o=(Math.pow(e.x,2)+Math.pow(e.y,2)-i)/2,a=(i-Math.pow(r.x,2)-Math.pow(r.y,2))/2,d=(e.x-t.x)*(t.y-r.y)-(t.x-r.x)*(e.y-t.y);this.centerPoint=new Zp.Vector2((o*(t.y-r.y)-a*(e.y-t.y))/d,((e.x-t.x)*a-(t.x-r.x)*o)/d),this.radius=this.centerPoint.subtract(this.startPoint).length(),this.startAngle=Cr.Angle.BetweenTwoPoints(this.centerPoint,this.startPoint);let s=this.startAngle.degrees(),l=Cr.Angle.BetweenTwoPoints(this.centerPoint,this.midPoint).degrees(),u=Cr.Angle.BetweenTwoPoints(this.centerPoint,this.endPoint).degrees();l-s>180&&(l-=360),l-s<-180&&(l+=360),u-l>180&&(u-=360),u-l<-180&&(u+=360),this.orientation=l-s<0?Ki.Orientation.CW:Ki.Orientation.CCW,this.angle=Cr.Angle.FromDegrees(this.orientation===Ki.Orientation.CW?s-u:u-s)}};Br.Arc2=tu});var ru=x(br=>{f();"use strict";Object.defineProperty(br,"__esModule",{value:!0});br.Axis=void 0;var Qi=sn(),jt=class{};br.Axis=jt;jt.X=new Qi.Vector3(1,0,0);jt.Y=new Qi.Vector3(0,1,0);jt.Z=new Qi.Vector3(0,0,1)});var ou=x(Ar=>{f();"use strict";Object.defineProperty(Ar,"__esModule",{value:!0});Ar.BezierCurve=void 0;var iu=class{static Interpolate(e,t,r,i,o){let a=1-3*i+3*t,d=3*i-6*t,s=3*t,l=e;for(let u=0;u<5;u++){let c=l*l,h=c*l,p=a*h+d*c+s*l,y=1/(3*a*c+2*d*l+s);l-=(p-e)*y,l=Math.min(1,Math.max(0,l))}return 3*Math.pow(1-l,2)*l*r+3*(1-l)*Math.pow(l,2)*o+Math.pow(l,3)}};Ar.BezierCurve=iu});var Vi=x(Nr=>{f();"use strict";Object.defineProperty(Nr,"__esModule",{value:!0});Nr.Color4=void 0;var wn=Rn(),et=Ze(),q=class{constructor(e=0,t=0,r=0,i=1){this.r=e,this.g=t,this.b=r,this.a=i}static FromHexString(e){if(e.substring(0,1)!=="#"||e.length!==9)return new q(0,0,0,0);let t=parseInt(e.substring(1,3),16),r=parseInt(e.substring(3,5),16),i=parseInt(e.substring(5,7),16),o=parseInt(e.substring(7,9),16);return q.FromInts(t,r,i,o)}static Lerp(e,t,r){let i=new q(0,0,0,0);return q.LerpToRef(e,t,r,i),i}static LerpToRef(e,t,r,i){i.r=e.r+(t.r-e.r)*r,i.g=e.g+(t.g-e.g)*r,i.b=e.b+(t.b-e.b)*r,i.a=e.a+(t.a-e.a)*r}static Red(){return new q(1,0,0,1)}static Green(){return new q(0,1,0,1)}static Blue(){return new q(0,0,1,1)}static Black(){return new q(0,0,0,1)}static White(){return new q(1,1,1,1)}static Purple(){return new q(.5,0,.5,1)}static Magenta(){return new q(1,0,1,1)}static Yellow(){return new q(1,1,0,1)}static Gray(){return new q(.5,.5,.5,1)}static Teal(){return new q(0,1,1,1)}static Clear(){return new q(0,0,0,0)}static FromColor3(e,t=1){return new q(e.r,e.g,e.b,t)}static FromArray(e,t=0){return new q(e[t],e[t+1],e[t+2],e[t+3])}static FromInts(e,t,r,i){return new q(e/255,t/255,r/255,i/255)}static CheckColors4(e,t){if(e.length===t*3){let r=[];for(let i=0;i<e.length;i+=3){let o=i/3*4;r[o]=e[i],r[o+1]=e[i+1],r[o+2]=e[i+2],r[o+3]=1}return r}return e}addInPlace(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this.a+=e.a,this}asArray(){let e=new Array;return this.toArray(e,0),e}toArray(e,t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e[t+3]=this.a,this}add(e){return new q(this.r+e.r,this.g+e.g,this.b+e.b,this.a+e.a)}subtract(e){return new q(this.r-e.r,this.g-e.g,this.b-e.b,this.a-e.a)}subtractToRef(e,t){return t.r=this.r-e.r,t.g=this.g-e.g,t.b=this.b-e.b,t.a=this.a-e.a,this}scale(e){return new q(this.r*e,this.g*e,this.b*e,this.a*e)}scaleToRef(e,t){return t.r=this.r*e,t.g=this.g*e,t.b=this.b*e,t.a=this.a*e,this}scaleAndAddToRef(e,t){return t.r+=this.r*e,t.g+=this.g*e,t.b+=this.b*e,t.a+=this.a*e,this}clampToRef(e=0,t=1,r){return r.r=wn.Scalar.Clamp(this.r,e,t),r.g=wn.Scalar.Clamp(this.g,e,t),r.b=wn.Scalar.Clamp(this.b,e,t),r.a=wn.Scalar.Clamp(this.a,e,t),this}multiply(e){return new q(this.r*e.r,this.g*e.g,this.b*e.b,this.a*e.a)}multiplyToRef(e,t){return t.r=this.r*e.r,t.g=this.g*e.g,t.b=this.b*e.b,t.a=this.a*e.a,t}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"}getClassName(){return"Color4"}getHashCode(){let e=this.r||0;return e=e*397^(this.g||0),e=e*397^(this.b||0),e=e*397^(this.a||0),e}clone(){return new q(this.r,this.g,this.b,this.a)}copyFrom(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this}copyFromFloats(e,t,r,i){return this.r=e,this.g=t,this.b=r,this.a=i,this}set(e,t,r,i){return this.copyFromFloats(e,t,r,i)}toHexString(){let e=this.r*255|0,t=this.g*255|0,r=this.b*255|0,i=this.a*255|0;return"#"+wn.Scalar.ToHex(e)+wn.Scalar.ToHex(t)+wn.Scalar.ToHex(r)+wn.Scalar.ToHex(i)}toLinearSpace(){let e=new q;return this.toLinearSpaceToRef(e),e}toLinearSpaceToRef(e){return e.r=Math.pow(this.r,et.ToLinearSpace),e.g=Math.pow(this.g,et.ToLinearSpace),e.b=Math.pow(this.b,et.ToLinearSpace),e.a=this.a,this}toGammaSpace(){let e=new q;return this.toGammaSpaceToRef(e),e}toGammaSpaceToRef(e){return e.r=Math.pow(this.r,et.ToGammaSpace),e.g=Math.pow(this.g,et.ToGammaSpace),e.b=Math.pow(this.b,et.ToGammaSpace),e.a=this.a,this}};Nr.Color4=q});var au=x(Or=>{f();"use strict";Object.defineProperty(Or,"__esModule",{value:!0});Or.Color3=void 0;var nt=Ze(),jp=Vi(),tt=Rn(),L=class{constructor(e=0,t=0,r=0){this.r=e,this.g=t,this.b=r}static FromHexString(e){if(e.substring(0,1)!=="#"||e.length!==7)return new L(0,0,0);let t=parseInt(e.substring(1,3),16),r=parseInt(e.substring(3,5),16),i=parseInt(e.substring(5,7),16);return L.FromInts(t,r,i)}static FromArray(e,t=0){return new L(e[t],e[t+1],e[t+2])}static FromInts(e,t,r){return new L(e/255,t/255,r/255)}static Lerp(e,t,r){let i=new L(0,0,0);return L.LerpToRef(e,t,r,i),i}static LerpToRef(e,t,r,i){i.r=e.r+(t.r-e.r)*r,i.g=e.g+(t.g-e.g)*r,i.b=e.b+(t.b-e.b)*r}static Red(){return new L(1,0,0)}static Green(){return new L(0,1,0)}static Blue(){return new L(0,0,1)}static Black(){return new L(0,0,0)}static White(){return new L(1,1,1)}static Purple(){return new L(.5,0,.5)}static Magenta(){return new L(1,0,1)}static Yellow(){return new L(1,1,0)}static Gray(){return new L(.5,.5,.5)}static Teal(){return new L(0,1,1)}static Random(){return new L(Math.random(),Math.random(),Math.random())}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"}getClassName(){return"Color3"}getHashCode(){let e=this.r||0;return e=e*397^(this.g||0),e=e*397^(this.b||0),e}toArray(e,t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,this}toColor4(e=1){return new jp.Color4(this.r,this.g,this.b,e)}asArray(){let e=new Array;return this.toArray(e,0),e}toLuminance(){return this.r*.3+this.g*.59+this.b*.11}multiply(e){return new L(this.r*e.r,this.g*e.g,this.b*e.b)}multiplyToRef(e,t){return t.r=this.r*e.r,t.g=this.g*e.g,t.b=this.b*e.b,this}equals(e){return e&&this.r===e.r&&this.g===e.g&&this.b===e.b}equalsFloats(e,t,r){return this.r===e&&this.g===t&&this.b===r}scale(e){return new L(this.r*e,this.g*e,this.b*e)}scaleToRef(e,t){return t.r=this.r*e,t.g=this.g*e,t.b=this.b*e,this}scaleAndAddToRef(e,t){return t.r+=this.r*e,t.g+=this.g*e,t.b+=this.b*e,this}clampToRef(e=0,t=1,r){return r.r=tt.Scalar.Clamp(this.r,e,t),r.g=tt.Scalar.Clamp(this.g,e,t),r.b=tt.Scalar.Clamp(this.b,e,t),this}add(e){return new L(this.r+e.r,this.g+e.g,this.b+e.b)}addToRef(e,t){return t.r=this.r+e.r,t.g=this.g+e.g,t.b=this.b+e.b,this}subtract(e){return new L(this.r-e.r,this.g-e.g,this.b-e.b)}subtractToRef(e,t){return t.r=this.r-e.r,t.g=this.g-e.g,t.b=this.b-e.b,this}clone(){return new L(this.r,this.g,this.b)}copyFrom(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copyFromFloats(e,t,r){return this.r=e,this.g=t,this.b=r,this}set(e,t,r){return this.copyFromFloats(e,t,r)}toHexString(){let e=this.r*255|0,t=this.g*255|0,r=this.b*255|0;return"#"+tt.Scalar.ToHex(e)+tt.Scalar.ToHex(t)+tt.Scalar.ToHex(r)}toLinearSpace(){let e=new L;return this.toLinearSpaceToRef(e),e}toLinearSpaceToRef(e){return e.r=Math.pow(this.r,nt.ToLinearSpace),e.g=Math.pow(this.g,nt.ToLinearSpace),e.b=Math.pow(this.b,nt.ToLinearSpace),this}toGammaSpace(){let e=new L;return this.toGammaSpaceToRef(e),e}toGammaSpaceToRef(e){return e.r=Math.pow(this.r,nt.ToGammaSpace),e.g=Math.pow(this.g,nt.ToGammaSpace),e.b=Math.pow(this.b,nt.ToGammaSpace),this}toJSON(){return{r:this.r,g:this.g,b:this.b}}};Or.Color3=L});var su=x(Mr=>{f();"use strict";Object.defineProperty(Mr,"__esModule",{value:!0});Mr.Curve3=void 0;var rt=sn(),Cn=class{constructor(e){this._length=0,this._points=e,this._length=this._computeLength(e)}static CreateQuadraticBezier(e,t,r,i){i=i>2?i:3;let o=new Array,a=(d,s,l,u)=>(1-d)*(1-d)*s+2*d*(1-d)*l+d*d*u;for(let d=0;d<=i;d++)o.push(new rt.Vector3(a(d/i,e.x,t.x,r.x),a(d/i,e.y,t.y,r.y),a(d/i,e.z,t.z,r.z)));return new Cn(o)}static CreateCubicBezier(e,t,r,i,o){o=o>3?o:4;let a=new Array,d=(s,l,u,c,h)=>(1-s)*(1-s)*(1-s)*l+3*s*(1-s)*(1-s)*u+3*s*s*(1-s)*c+s*s*s*h;for(let s=0;s<=o;s++)a.push(new rt.Vector3(d(s/o,e.x,t.x,r.x,i.x),d(s/o,e.y,t.y,r.y,i.y),d(s/o,e.z,t.z,r.z,i.z)));return new Cn(a)}static CreateHermiteSpline(e,t,r,i,o){let a=new Array,d=1/o;for(let s=0;s<=o;s++)a.push(rt.Vector3.Hermite(e,t,r,i,s*d));return new Cn(a)}static CreateCatmullRomSpline(e,t,r){let i=new Array,o=1/t,a=0;if(r){let d=e.length;for(let s=0;s<d;s++){a=0;for(let l=0;l<t;l++)i.push(rt.Vector3.CatmullRom(e[s%d],e[(s+1)%d],e[(s+2)%d],e[(s+3)%d],a)),a+=o}i.push(i[0])}else{let d=new Array;d.push(e[0].clone()),Array.prototype.push.apply(d,e),d.push(e[e.length-1].clone());let s=0;for(s=0;s<d.length-3;s++){a=0;for(let l=0;l<t;l++)i.push(rt.Vector3.CatmullRom(d[s],d[s+1],d[s+2],d[s+3],a)),a+=o}s--,i.push(rt.Vector3.CatmullRom(d[s],d[s+1],d[s+2],d[s+3],a))}return new Cn(i)}getPoints(){return this._points}length(){return this._length}continue(e){let t=this._points[this._points.length-1],r=this._points.slice(),i=e.getPoints();for(let a=1;a<i.length;a++)r.push(i[a].subtract(i[0]).add(t));return new Cn(r)}_computeLength(e){let t=0;for(let r=1;r<e.length;r++)t+=e[r].subtract(e[r-1]).length();return t}};Mr.Curve3=Cn});var Zi=x(Dr=>{f();"use strict";Object.defineProperty(Dr,"__esModule",{value:!0});Dr.Plane=void 0;var Ur=sn(),eh=Vt(),nh=Zn(),Bn=class{constructor(e,t,r,i){this.normal=new Ur.Vector3(e,t,r),this.d=i}static FromArray(e){return new Bn(e[0],e[1],e[2],e[3])}static FromPoints(e,t,r){let i=new Bn(0,0,0,0);return i.copyFromPoints(e,t,r),i}static FromPositionAndNormal(e,t){let r=new Bn(0,0,0,0);return t.normalize(),r.normal=t,r.d=-(t.x*e.x+t.y*e.y+t.z*e.z),r}static SignedDistanceToPlaneFromPositionAndNormal(e,t,r){let i=-(t.x*e.x+t.y*e.y+t.z*e.z);return Ur.Vector3.Dot(r,t)+i}asArray(){return[this.normal.x,this.normal.y,this.normal.z,this.d]}clone(){return new Bn(this.normal.x,this.normal.y,this.normal.z,this.d)}getClassName(){return"Plane"}getHashCode(){let e=this.normal.getHashCode();return e=e*397^(this.d||0),e}normalize(){let e=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z),t=0;return e!==0&&(t=1/e),this.normal.x*=t,this.normal.y*=t,this.normal.z*=t,this.d*=t,this}transform(e){let t=nh.MathTmp.Matrix[0];eh.Matrix.TransposeToRef(e,t);let r=t.m,i=this.normal.x,o=this.normal.y,a=this.normal.z,d=this.d,s=i*r[0]+o*r[1]+a*r[2]+d*r[3],l=i*r[4]+o*r[5]+a*r[6]+d*r[7],u=i*r[8]+o*r[9]+a*r[10]+d*r[11],c=i*r[12]+o*r[13]+a*r[14]+d*r[15];return new Bn(s,l,u,c)}dotCoordinate(e){return this.normal.x*e.x+this.normal.y*e.y+this.normal.z*e.z+this.d}copyFromPoints(e,t,r){let i=t.x-e.x,o=t.y-e.y,a=t.z-e.z,d=r.x-e.x,s=r.y-e.y,l=r.z-e.z,u=o*l-a*s,c=a*d-i*l,h=i*s-o*d,p=Math.sqrt(u*u+c*c+h*h),y;return p!==0?y=1/p:y=0,this.normal.x=u*y,this.normal.y=c*y,this.normal.z=h*y,this.d=-(this.normal.x*e.x+this.normal.y*e.y+this.normal.z*e.z),this}isFrontFacingTo(e,t){return Ur.Vector3.Dot(this.normal,e)<=t}signedDistanceTo(e){return Ur.Vector3.Dot(e,this.normal)+this.d}};Dr.Plane=Bn});var du=x(Wr=>{f();"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});Wr.Frustum=void 0;var th=Zi(),dn=class{static GetPlanes(e){let t=[];for(let r=0;r<6;r++)t.push(new th.Plane(0,0,0,0));return dn.GetPlanesToRef(e,t),t}static GetNearPlaneToRef(e,t){let r=e.m;t.normal.x=r[3]+r[2],t.normal.y=r[7]+r[6],t.normal.z=r[11]+r[10],t.d=r[15]+r[14],t.normalize()}static GetFarPlaneToRef(e,t){let r=e.m;t.normal.x=r[3]-r[2],t.normal.y=r[7]-r[6],t.normal.z=r[11]-r[10],t.d=r[15]-r[14],t.normalize()}static GetLeftPlaneToRef(e,t){let r=e.m;t.normal.x=r[3]+r[0],t.normal.y=r[7]+r[4],t.normal.z=r[11]+r[8],t.d=r[15]+r[12],t.normalize()}static GetRightPlaneToRef(e,t){let r=e.m;t.normal.x=r[3]-r[0],t.normal.y=r[7]-r[4],t.normal.z=r[11]-r[8],t.d=r[15]-r[12],t.normalize()}static GetTopPlaneToRef(e,t){let r=e.m;t.normal.x=r[3]-r[1],t.normal.y=r[7]-r[5],t.normal.z=r[11]-r[9],t.d=r[15]-r[13],t.normalize()}static GetBottomPlaneToRef(e,t){let r=e.m;t.normal.x=r[3]+r[1],t.normal.y=r[7]+r[5],t.normal.z=r[11]+r[9],t.d=r[15]+r[13],t.normalize()}static GetPlanesToRef(e,t){dn.GetNearPlaneToRef(e,t[0]),dn.GetFarPlaneToRef(e,t[1]),dn.GetLeftPlaneToRef(e,t[2]),dn.GetRightPlaneToRef(e,t[3]),dn.GetTopPlaneToRef(e,t[4]),dn.GetBottomPlaneToRef(e,t[5])}};Wr.Frustum=dn});var lu=x(Fr=>{f();"use strict";Object.defineProperty(Fr,"__esModule",{value:!0});Fr.Path2=void 0;var Jn=wr(),rh=Xi(),ih=Ze(),qr=class{constructor(e,t){this.closed=!1,this._points=new Array,this._length=0,this._points.push(new Jn.Vector2(e,t))}static StartingAt(e,t){return new qr(e,t)}addLineTo(e,t){if(this.closed)return this;let r=new Jn.Vector2(e,t),i=this._points[this._points.length-1];return this._points.push(r),this._length+=r.subtract(i).length(),this}addArcTo(e,t,r,i,o=36){if(this.closed)return this;let a=this._points[this._points.length-1],d=new Jn.Vector2(e,t),s=new Jn.Vector2(r,i),l=new rh.Arc2(a,d,s),u=l.angle.radians()/o;l.orientation===ih.Orientation.CW&&(u*=-1);let c=l.startAngle.radians()+u;for(let h=0;h<o;h++){let p=Math.cos(c)*l.radius+l.centerPoint.x,y=Math.sin(c)*l.radius+l.centerPoint.y;this.addLineTo(p,y),c+=u}return this}close(){return this.closed=!0,this}length(){let e=this._length;if(!this.closed){let t=this._points[this._points.length-1];e+=this._points[0].subtract(t).length()}return e}getPoints(){return this._points}getPointAtLengthPosition(e){if(e<0||e>1)return Jn.Vector2.Zero();let t=e*this.length(),r=0;for(let i=0;i<this._points.length;i++){let o=(i+1)%this._points.length,a=this._points[i],s=this._points[o].subtract(a),l=s.length()+r;if(t>=r&&t<=l){let u=s.normalize(),c=t-r;return new Jn.Vector2(a.x+u.x*c,a.y+u.y*c)}r=l}return Jn.Vector2.Zero()}};Fr.Path2=qr});var cu=x(Jr=>{f();"use strict";Object.defineProperty(Jr,"__esModule",{value:!0});Jr.Path3D=void 0;var ln=sn(),ji=Ze(),eo=Rn(),uu=class{constructor(e,t=null,r){this.path=e,this._curve=new Array,this._distances=new Array,this._tangents=new Array,this._normals=new Array,this._binormals=new Array;for(let i=0;i<e.length;i++)this._curve[i]=e[i].clone();this._raw=r||!1,this._compute(t)}getCurve(){return this._curve}getTangents(){return this._tangents}getNormals(){return this._normals}getBinormals(){return this._binormals}getDistances(){return this._distances}update(e,t=null){for(let r=0;r<e.length;r++)this._curve[r].x=e[r].x,this._curve[r].y=e[r].y,this._curve[r].z=e[r].z;return this._compute(t),this}_compute(e){let t=this._curve.length;this._tangents[0]=this._getFirstNonNullVector(0),this._raw||this._tangents[0].normalize(),this._tangents[t-1]=this._curve[t-1].subtract(this._curve[t-2]),this._raw||this._tangents[t-1].normalize();let r=this._tangents[0],i=this._normalVector(this._curve[0],r,e);this._normals[0]=i,this._raw||this._normals[0].normalize(),this._binormals[0]=ln.Vector3.Cross(r,this._normals[0]),this._raw||this._binormals[0].normalize(),this._distances[0]=0;let o,a,d,s;for(let l=1;l<t;l++)o=this._getLastNonNullVector(l),l<t-1&&(a=this._getFirstNonNullVector(l),this._tangents[l]=o.add(a),this._tangents[l].normalize()),this._distances[l]=this._distances[l-1]+o.length(),d=this._tangents[l],s=this._binormals[l-1],this._normals[l]=ln.Vector3.Cross(s,d),this._raw||this._normals[l].normalize(),this._binormals[l]=ln.Vector3.Cross(d,this._normals[l]),this._raw||this._binormals[l].normalize()}_getFirstNonNullVector(e){let t=1,r=this._curve[e+t].subtract(this._curve[e]);for(;r.length()===0&&e+t+1<this._curve.length;)t++,r=this._curve[e+t].subtract(this._curve[e]);return r}_getLastNonNullVector(e){let t=1,r=this._curve[e].subtract(this._curve[e-t]);for(;r.length()===0&&e>t+1;)t++,r=this._curve[e].subtract(this._curve[e-t]);return r}_normalVector(e,t,r){let i,o=t.length();if(o===0&&(o=1),r==null){let a;eo.Scalar.WithinEpsilon(Math.abs(t.y)/o,1,ji.Epsilon)?eo.Scalar.WithinEpsilon(Math.abs(t.x)/o,1,ji.Epsilon)?eo.Scalar.WithinEpsilon(Math.abs(t.z)/o,1,ji.Epsilon)?a=ln.Vector3.Zero():a=new ln.Vector3(0,0,1):a=new ln.Vector3(1,0,0):a=new ln.Vector3(0,-1,0),i=ln.Vector3.Cross(t,a)}else i=ln.Vector3.Cross(t,r),ln.Vector3.CrossToRef(i,t,i);return i.normalize(),i}};Jr.Path3D=uu});var fu=x(zr=>{f();"use strict";Object.defineProperty(zr,"__esModule",{value:!0});zr.Size=void 0;var Pn=class{constructor(e,t){this.width=e,this.height=t}get surface(){return this.width*this.height}static Zero(){return new Pn(0,0)}static Lerp(e,t,r){let i=e.width+(t.width-e.width)*r,o=e.height+(t.height-e.height)*r;return new Pn(i,o)}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let e=this.width||0;return e=e*397^(this.height||0),e}copyFrom(e){this.width=e.width,this.height=e.height}copyFromFloats(e,t){return this.width=e,this.height=t,this}set(e,t){return this.copyFromFloats(e,t)}multiplyByFloats(e,t){return new Pn(this.width*e,this.height*t)}clone(){return new Pn(this.width,this.height)}equals(e){return e?this.width===e.width&&this.height===e.height:!1}add(e){return new Pn(this.width+e.width,this.height+e.height)}subtract(e){return new Pn(this.width-e.width,this.height-e.height)}};zr.Size=Pn});var Lr=x(G=>{f();"use strict";var oh=G&&G.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),ie=G&&G.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&oh(e,n,t)};Object.defineProperty(G,"__esModule",{value:!0});ie(Ze(),G);ie(Zn(),G);ie(Yi(),G);ie(Xi(),G);ie(ru(),G);ie(ou(),G);ie(au(),G);ie(Vi(),G);ie(su(),G);ie(du(),G);ie(Vt(),G);ie(lu(),G);ie(cu(),G);ie(Zi(),G);ie(Zt(),G);ie(Rn(),G);ie(fu(),G);ie(wr(),G);ie(sn(),G);ie(zi(),G);ie(Lr(),G)});var Iu=x(($m,Tu)=>{f();Tu.exports=Y;var $e=null;try{$e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(n){}function Y(n,e,t){this.low=n|0,this.high=e|0,this.unsigned=!!t}Y.prototype.__isLong__;Object.defineProperty(Y.prototype,"__isLong__",{value:!0});function be(n){return(n&&n.__isLong__)===!0}Y.isLong=be;var pu={},hu={};function zn(n,e){var t,r,i;return e?(n>>>=0,(i=0<=n&&n<256)&&(r=hu[n],r)?r:(t=K(n,(n|0)<0?-1:0,!0),i&&(hu[n]=t),t)):(n|=0,(i=-128<=n&&n<128)&&(r=pu[n],r)?r:(t=K(n,n<0?-1:0,!1),i&&(pu[n]=t),t))}Y.fromInt=zn;function He(n,e){if(isNaN(n))return e?Ln:Ye;if(e){if(n<0)return Ln;if(n>=mu)return xu}else{if(n<=-Ru)return Ae;if(n+1>=Ru)return Su}return n<0?He(-n,e).neg():K(n%it|0,n/it|0,e)}Y.fromNumber=He;function K(n,e,t){return new Y(n,e,t)}Y.fromBits=K;var Gr=Math.pow;function no(n,e,t){if(n.length===0)throw Error("empty string");if(n==="NaN"||n==="Infinity"||n==="+Infinity"||n==="-Infinity")return Ye;if(typeof e=="number"?(t=e,e=!1):e=!!e,t=t||10,t<2||36<t)throw RangeError("radix");var r;if((r=n.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return no(n.substring(1),e,t).neg();for(var i=He(Gr(t,8)),o=Ye,a=0;a<n.length;a+=8){var d=Math.min(8,n.length-a),s=parseInt(n.substring(a,a+d),t);if(d<8){var l=He(Gr(t,d));o=o.mul(l).add(He(s))}else o=o.mul(i),o=o.add(He(s))}return o.unsigned=e,o}Y.fromString=no;function je(n,e){return typeof n=="number"?He(n,e):typeof n=="string"?no(n,e):K(n.low,n.high,typeof e=="boolean"?e:n.unsigned)}Y.fromValue=je;var yu=1<<16,ah=1<<24,it=yu*yu,mu=it*it,Ru=mu/2,Pu=zn(ah),Ye=zn(0);Y.ZERO=Ye;var Ln=zn(0,!0);Y.UZERO=Ln;var ot=zn(1);Y.ONE=ot;var gu=zn(1,!0);Y.UONE=gu;var to=zn(-1);Y.NEG_ONE=to;var Su=K(4294967295|0,2147483647|0,!1);Y.MAX_VALUE=Su;var xu=K(4294967295|0,4294967295|0,!0);Y.MAX_UNSIGNED_VALUE=xu;var Ae=K(0,2147483648|0,!1);Y.MIN_VALUE=Ae;var P=Y.prototype;P.toInt=function(){return this.unsigned?this.low>>>0:this.low};P.toNumber=function(){return this.unsigned?(this.high>>>0)*it+(this.low>>>0):this.high*it+(this.low>>>0)};P.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Ae)){var t=He(e),r=this.div(t),i=r.mul(t).sub(this);return r.toString(e)+i.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var o=He(Gr(e,6),this.unsigned),a=this,d="";;){var s=a.div(o),l=a.sub(s.mul(o)).toInt()>>>0,u=l.toString(e);if(a=s,a.isZero())return u+d;for(;u.length<6;)u="0"+u;d=""+u+d}};P.getHighBits=function(){return this.high};P.getHighBitsUnsigned=function(){return this.high>>>0};P.getLowBits=function(){return this.low};P.getLowBitsUnsigned=function(){return this.low>>>0};P.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Ae)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return this.high!=0?t+33:t+1};P.isZero=function(){return this.high===0&&this.low===0};P.eqz=P.isZero;P.isNegative=function(){return!this.unsigned&&this.high<0};P.isPositive=function(){return this.unsigned||this.high>=0};P.isOdd=function(){return(this.low&1)==1};P.isEven=function(){return(this.low&1)==0};P.equals=function(e){return be(e)||(e=je(e)),this.unsigned!==e.unsigned&&this.high>>>31==1&&e.high>>>31==1?!1:this.high===e.high&&this.low===e.low};P.eq=P.equals;P.notEquals=function(e){return!this.eq(e)};P.neq=P.notEquals;P.ne=P.notEquals;P.lessThan=function(e){return this.comp(e)<0};P.lt=P.lessThan;P.lessThanOrEqual=function(e){return this.comp(e)<=0};P.lte=P.lessThanOrEqual;P.le=P.lessThanOrEqual;P.greaterThan=function(e){return this.comp(e)>0};P.gt=P.greaterThan;P.greaterThanOrEqual=function(e){return this.comp(e)>=0};P.gte=P.greaterThanOrEqual;P.ge=P.greaterThanOrEqual;P.compare=function(e){if(be(e)||(e=je(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};P.comp=P.compare;P.negate=function(){return!this.unsigned&&this.eq(Ae)?Ae:this.not().add(ot)};P.neg=P.negate;P.add=function(e){be(e)||(e=je(e));var t=this.high>>>16,r=this.high&65535,i=this.low>>>16,o=this.low&65535,a=e.high>>>16,d=e.high&65535,s=e.low>>>16,l=e.low&65535,u=0,c=0,h=0,p=0;return p+=o+l,h+=p>>>16,p&=65535,h+=i+s,c+=h>>>16,h&=65535,c+=r+d,u+=c>>>16,c&=65535,u+=t+a,u&=65535,K(h<<16|p,u<<16|c,this.unsigned)};P.subtract=function(e){return be(e)||(e=je(e)),this.add(e.neg())};P.sub=P.subtract;P.multiply=function(e){if(this.isZero())return Ye;if(be(e)||(e=je(e)),$e){var t=$e.mul(this.low,this.high,e.low,e.high);return K(t,$e.get_high(),this.unsigned)}if(e.isZero())return Ye;if(this.eq(Ae))return e.isOdd()?Ae:Ye;if(e.eq(Ae))return this.isOdd()?Ae:Ye;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(Pu)&&e.lt(Pu))return He(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,i=this.high&65535,o=this.low>>>16,a=this.low&65535,d=e.high>>>16,s=e.high&65535,l=e.low>>>16,u=e.low&65535,c=0,h=0,p=0,y=0;return y+=a*u,p+=y>>>16,y&=65535,p+=o*u,h+=p>>>16,p&=65535,p+=a*l,h+=p>>>16,p&=65535,h+=i*u,c+=h>>>16,h&=65535,h+=o*l,c+=h>>>16,h&=65535,h+=a*s,c+=h>>>16,h&=65535,c+=r*u+i*l+o*s+a*d,c&=65535,K(p<<16|y,c<<16|h,this.unsigned)};P.mul=P.multiply;P.divide=function(e){if(be(e)||(e=je(e)),e.isZero())throw Error("division by zero");if($e){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?$e.div_u:$e.div_s)(this.low,this.high,e.low,e.high);return K(t,$e.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Ln:Ye;var r,i,o;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Ln;if(e.gt(this.shru(1)))return gu;o=Ln}else{if(this.eq(Ae)){if(e.eq(ot)||e.eq(to))return Ae;if(e.eq(Ae))return ot;var a=this.shr(1);return r=a.div(e).shl(1),r.eq(Ye)?e.isNegative()?ot:to:(i=this.sub(e.mul(r)),o=r.add(i.div(e)),o)}else if(e.eq(Ae))return this.unsigned?Ln:Ye;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=Ye}for(i=this;i.gte(e);){r=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var d=Math.ceil(Math.log(r)/Math.LN2),s=d<=48?1:Gr(2,d-48),l=He(r),u=l.mul(e);u.isNegative()||u.gt(i);)r-=s,l=He(r,this.unsigned),u=l.mul(e);l.isZero()&&(l=ot),o=o.add(l),i=i.sub(u)}return o};P.div=P.divide;P.modulo=function(e){if(be(e)||(e=je(e)),$e){var t=(this.unsigned?$e.rem_u:$e.rem_s)(this.low,this.high,e.low,e.high);return K(t,$e.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};P.mod=P.modulo;P.rem=P.modulo;P.not=function(){return K(~this.low,~this.high,this.unsigned)};P.and=function(e){return be(e)||(e=je(e)),K(this.low&e.low,this.high&e.high,this.unsigned)};P.or=function(e){return be(e)||(e=je(e)),K(this.low|e.low,this.high|e.high,this.unsigned)};P.xor=function(e){return be(e)||(e=je(e)),K(this.low^e.low,this.high^e.high,this.unsigned)};P.shiftLeft=function(e){return be(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?K(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):K(0,this.low<<e-32,this.unsigned)};P.shl=P.shiftLeft;P.shiftRight=function(e){return be(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?K(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):K(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};P.shr=P.shiftRight;P.shiftRightUnsigned=function(e){if(be(e)&&(e=e.toInt()),e&=63,e===0)return this;var t=this.high;if(e<32){var r=this.low;return K(r>>>e|t<<32-e,t>>>e,this.unsigned)}else return e===32?K(t,0,this.unsigned):K(t>>>e-32,0,this.unsigned)};P.shru=P.shiftRightUnsigned;P.shr_u=P.shiftRightUnsigned;P.toSigned=function(){return this.unsigned?K(this.low,this.high,!1):this};P.toUnsigned=function(){return this.unsigned?this:K(this.low,this.high,!0)};P.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};P.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};P.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};Y.fromBytes=function(e,t,r){return r?Y.fromBytesLE(e,t):Y.fromBytesBE(e,t)};Y.fromBytesLE=function(e,t){return new Y(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};Y.fromBytesBE=function(e,t){return new Y(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}});var Mu=x((jm,so)=>{f();"use strict";var hh=Object.prototype.hasOwnProperty,_e="~";function tr(){}Object.create&&(tr.prototype=Object.create(null),new tr().__proto__||(_e=!1));function yh(n,e,t){this.fn=n,this.context=e,this.once=t||!1}function Ou(n,e,t,r,i){if(typeof t!="function")throw new TypeError("The listener must be a function");var o=new yh(t,r||n,i),a=_e?_e+e:e;return n._events[a]?n._events[a].fn?n._events[a]=[n._events[a],o]:n._events[a].push(o):(n._events[a]=o,n._eventsCount++),n}function Kr(n,e){--n._eventsCount==0?n._events=new tr:delete n._events[e]}function Pe(){this._events=new tr,this._eventsCount=0}Pe.prototype.eventNames=function(){var e=[],t,r;if(this._eventsCount===0)return e;for(r in t=this._events)hh.call(t,r)&&e.push(_e?r.slice(1):r);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};Pe.prototype.listeners=function(e){var t=_e?_e+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,a=new Array(o);i<o;i++)a[i]=r[i].fn;return a};Pe.prototype.listenerCount=function(e){var t=_e?_e+e:e,r=this._events[t];return r?r.fn?1:r.length:0};Pe.prototype.emit=function(e,t,r,i,o,a){var d=_e?_e+e:e;if(!this._events[d])return!1;var s=this._events[d],l=arguments.length,u,c;if(s.fn){switch(s.once&&this.removeListener(e,s.fn,void 0,!0),l){case 1:return s.fn.call(s.context),!0;case 2:return s.fn.call(s.context,t),!0;case 3:return s.fn.call(s.context,t,r),!0;case 4:return s.fn.call(s.context,t,r,i),!0;case 5:return s.fn.call(s.context,t,r,i,o),!0;case 6:return s.fn.call(s.context,t,r,i,o,a),!0}for(c=1,u=new Array(l-1);c<l;c++)u[c-1]=arguments[c];s.fn.apply(s.context,u)}else{var h=s.length,p;for(c=0;c<h;c++)switch(s[c].once&&this.removeListener(e,s[c].fn,void 0,!0),l){case 1:s[c].fn.call(s[c].context);break;case 2:s[c].fn.call(s[c].context,t);break;case 3:s[c].fn.call(s[c].context,t,r);break;case 4:s[c].fn.call(s[c].context,t,r,i);break;default:if(!u)for(p=1,u=new Array(l-1);p<l;p++)u[p-1]=arguments[p];s[c].fn.apply(s[c].context,u)}}return!0};Pe.prototype.on=function(e,t,r){return Ou(this,e,t,r,!1)};Pe.prototype.once=function(e,t,r){return Ou(this,e,t,r,!0)};Pe.prototype.removeListener=function(e,t,r,i){var o=_e?_e+e:e;if(!this._events[o])return this;if(!t)return Kr(this,o),this;var a=this._events[o];if(a.fn)a.fn===t&&(!i||a.once)&&(!r||a.context===r)&&Kr(this,o);else{for(var d=0,s=[],l=a.length;d<l;d++)(a[d].fn!==t||i&&!a[d].once||r&&a[d].context!==r)&&s.push(a[d]);s.length?this._events[o]=s.length===1?s[0]:s:Kr(this,o)}return this};Pe.prototype.removeAllListeners=function(e){var t;return e?(t=_e?_e+e:e,this._events[t]&&Kr(this,t)):(this._events=new tr,this._eventsCount=0),this};Pe.prototype.off=Pe.prototype.removeListener;Pe.prototype.addListener=Pe.prototype.on;Pe.prefixed=_e;Pe.EventEmitter=Pe;typeof so!="undefined"&&(so.exports=Pe)});var Du=x((e0,Uu)=>{f();"use strict";Uu.exports=(n,e)=>(e=e||(()=>{}),n.then(t=>new Promise(r=>{r(e())}).then(()=>t),t=>new Promise(r=>{r(e())}).then(()=>{throw t})))});var qu=x((n0,Xr)=>{f();"use strict";var mh=Du(),lo=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},Wu=(n,e,t)=>new Promise((r,i)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===Infinity){r(n);return}let o=setTimeout(()=>{if(typeof t=="function"){try{r(t())}catch(s){i(s)}return}let a=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,d=t instanceof Error?t:new lo(a);typeof n.cancel=="function"&&n.cancel(),i(d)},e);mh(n.then(r,i),()=>{clearTimeout(o)})});Xr.exports=Wu;Xr.exports.default=Wu;Xr.exports.TimeoutError=lo});var Fu=x(uo=>{f();"use strict";Object.defineProperty(uo,"__esModule",{value:!0});function Rh(n,e,t){let r=0,i=n.length;for(;i>0;){let o=i/2|0,a=r+o;t(n[a],e)<=0?(r=++a,i-=o+1):i=o}return r}uo.default=Rh});var zu=x(co=>{f();"use strict";Object.defineProperty(co,"__esModule",{value:!0});var Ph=Fu(),Ju=class{constructor(){this._queue=[]}enqueue(e,t){t=Object.assign({priority:0},t);let r={priority:t.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority){this._queue.push(r);return}let i=Ph.default(this._queue,r,(o,a)=>a.priority-o.priority);this._queue.splice(i,0,r)}dequeue(){let e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return this._queue.length}};co.default=Ju});var $u=x(fo=>{f();"use strict";Object.defineProperty(fo,"__esModule",{value:!0});var gh=Mu(),Lu=qu(),Sh=zu(),Qr=()=>{},xh=new Lu.TimeoutError,Gu=class extends gh{constructor(e){var t,r,i,o;super();if(this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=Qr,this._resolveIdle=Qr,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:Infinity,interval:0,concurrency:Infinity,autoStart:!0,queueClass:Sh.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(r=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(o=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===Infinity||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=Qr,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=Qr,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(this._intervalId===void 0){let t=this._intervalEnd-e;if(t<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let t=this._queue.dequeue();return t?(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((r,i)=>{let o=async()=>{this._pendingCount++,this._intervalCount++;try{let a=this._timeout===void 0&&t.timeout===void 0?e():Lu.default(Promise.resolve(e()),t.timeout===void 0?this._timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?this._throwOnTimeout:t.throwOnTimeout)&&i(xh)});r(await a)}catch(a){i(a)}this._next()};this._queue.enqueue(o,t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async r=>this.add(r,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{let t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{let t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}};fo.default=Gu});f();var tc=C(Za()),rc=C(ja());f();f();f();var Ti=C(fe());f();var Dn=C($());function us(){return{message:""}}var yf={encode(n,e=Dn.default.Writer.create()){return n.message!==""&&e.uint32(10).string(n.message),e},decode(n,e){let t=n instanceof Dn.default.Reader?n:new Dn.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=us();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.message=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{message:Rf(n.message)?String(n.message):""}},toJSON(n){let e={};return n.message!==void 0&&(e.message=n.message),e},fromPartial(n){let e=us();return e.message=n.message??"",e}};function cs(){return{}}var mf={encode(n,e=Dn.default.Writer.create()){return e},decode(n,e){let t=n instanceof Dn.default.Reader?n:new Dn.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=cs();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return cs()}},xi={name:"CommunicationsControllerService",fullName:"decentraland.kernel.apis.CommunicationsControllerService",methods:{send:{name:"Send",requestType:yf,requestStream:!1,responseType:mf,responseStream:!1,options:{}}}};function Rf(n){return n!=null}var ft;(function(t){function n(r){return Ti.loadService(r,xi)}t.create=n;function e(r){let i=Ti.loadService(r,xi);return{...i,async send(o){await i.send({message:o})}}}t.createLegacy=e})(ft||(ft={}));f();var ms=C(fe());f();var Wn=C($());function fs(){return{type:"",jsonPayload:""}}var Pf={encode(n,e=Wn.default.Writer.create()){return n.type!==""&&e.uint32(10).string(n.type),n.jsonPayload!==""&&e.uint32(18).string(n.jsonPayload),e},decode(n,e){let t=n instanceof Wn.default.Reader?n:new Wn.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=fs();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.type=t.string();break;case 2:i.jsonPayload=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{type:ys(n.type)?String(n.type):"",jsonPayload:ys(n.jsonPayload)?String(n.jsonPayload):""}},toJSON(n){let e={};return n.type!==void 0&&(e.type=n.type),n.jsonPayload!==void 0&&(e.jsonPayload=n.jsonPayload),e},fromPartial(n){let e=fs();return e.type=n.type??"",e.jsonPayload=n.jsonPayload??"",e}};function ps(){return{}}var gf={encode(n,e=Wn.default.Writer.create()){return e},decode(n,e){let t=n instanceof Wn.default.Reader?n:new Wn.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=ps();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return ps()}},hs={name:"DevToolsService",fullName:"decentraland.kernel.apis.DevToolsService",methods:{event:{name:"Event",requestType:Pf,requestStream:!1,responseType:gf,responseStream:!1,options:{}}}};function ys(n){return n!=null}function Rs(n){return ms.loadService(n,hs)}f();var Hs=C(fe());f();var R=C($());var Ce;(function(a){a[a.QT_INVALID_QUERY_TYPE=0]="QT_INVALID_QUERY_TYPE",a[a.QT_HIT_FIRST=1]="QT_HIT_FIRST",a[a.QT_HIT_ALL=2]="QT_HIT_ALL",a[a.QT_HIT_FIRST_AVATAR=3]="QT_HIT_FIRST_AVATAR",a[a.QT_HIT_ALL_AVATARS=4]="QT_HIT_ALL_AVATARS",a[a.UNRECOGNIZED=-1]="UNRECOGNIZED"})(Ce||(Ce={}));function Ii(n){switch(n){case 0:case"QT_INVALID_QUERY_TYPE":return 0;case 1:case"QT_HIT_FIRST":return 1;case 2:case"QT_HIT_ALL":return 2;case 3:case"QT_HIT_FIRST_AVATAR":return 3;case 4:case"QT_HIT_ALL_AVATARS":return 4;case-1:case"UNRECOGNIZED":default:return-1}}function Sf(n){switch(n){case 0:return"QT_INVALID_QUERY_TYPE";case 1:return"QT_HIT_FIRST";case 2:return"QT_HIT_ALL";case 3:return"QT_HIT_FIRST_AVATAR";case 4:return"QT_HIT_ALL_AVATARS";case-1:default:return"UNRECOGNIZED"}}var v;(function(g){g[g.EAT_INVALID_EA_TYPE=0]="EAT_INVALID_EA_TYPE",g[g.EAT_OPEN_EXTERNAL_URL=1]="EAT_OPEN_EXTERNAL_URL",g[g.EAT_OPEN_NFT_DIALOG=2]="EAT_OPEN_NFT_DIALOG",g[g.EAT_CREATE_ENTITY=3]="EAT_CREATE_ENTITY",g[g.EAT_REMOVE_ENTITY=4]="EAT_REMOVE_ENTITY",g[g.EAT_UPDATE_ENTITY_COMPONENT=5]="EAT_UPDATE_ENTITY_COMPONENT",g[g.EAT_ATTACH_ENTITY_COMPONENT=6]="EAT_ATTACH_ENTITY_COMPONENT",g[g.EAT_COMPONENT_REMOVED=7]="EAT_COMPONENT_REMOVED",g[g.EAT_SET_ENTITY_PARENT=8]="EAT_SET_ENTITY_PARENT",g[g.EAT_QUERY=9]="EAT_QUERY",g[g.EAT_COMPONENT_CREATED=10]="EAT_COMPONENT_CREATED",g[g.EAT_COMPONENT_DISPOSED=11]="EAT_COMPONENT_DISPOSED",g[g.EAT_COMPONENT_UPDATED=12]="EAT_COMPONENT_UPDATED",g[g.EAT_INIT_MESSAGES_FINISHED=13]="EAT_INIT_MESSAGES_FINISHED",g[g.UNRECOGNIZED=-1]="UNRECOGNIZED"})(v||(v={}));function xf(n){switch(n){case 0:case"EAT_INVALID_EA_TYPE":return 0;case 1:case"EAT_OPEN_EXTERNAL_URL":return 1;case 2:case"EAT_OPEN_NFT_DIALOG":return 2;case 3:case"EAT_CREATE_ENTITY":return 3;case 4:case"EAT_REMOVE_ENTITY":return 4;case 5:case"EAT_UPDATE_ENTITY_COMPONENT":return 5;case 6:case"EAT_ATTACH_ENTITY_COMPONENT":return 6;case 7:case"EAT_COMPONENT_REMOVED":return 7;case 8:case"EAT_SET_ENTITY_PARENT":return 8;case 9:case"EAT_QUERY":return 9;case 10:case"EAT_COMPONENT_CREATED":return 10;case 11:case"EAT_COMPONENT_DISPOSED":return 11;case 12:case"EAT_COMPONENT_UPDATED":return 12;case 13:case"EAT_INIT_MESSAGES_FINISHED":return 13;case-1:case"UNRECOGNIZED":default:return-1}}function Tf(n){switch(n){case 0:return"EAT_INVALID_EA_TYPE";case 1:return"EAT_OPEN_EXTERNAL_URL";case 2:return"EAT_OPEN_NFT_DIALOG";case 3:return"EAT_CREATE_ENTITY";case 4:return"EAT_REMOVE_ENTITY";case 5:return"EAT_UPDATE_ENTITY_COMPONENT";case 6:return"EAT_ATTACH_ENTITY_COMPONENT";case 7:return"EAT_COMPONENT_REMOVED";case 8:return"EAT_SET_ENTITY_PARENT";case 9:return"EAT_QUERY";case 10:return"EAT_COMPONENT_CREATED";case 11:return"EAT_COMPONENT_DISPOSED";case 12:return"EAT_COMPONENT_UPDATED";case 13:return"EAT_INIT_MESSAGES_FINISHED";case-1:default:return"UNRECOGNIZED"}}var Be;(function(i){i[i.EDT_GENERIC=0]="EDT_GENERIC",i[i.EDT_POSITION_CHANGED=1]="EDT_POSITION_CHANGED",i[i.EDT_ROTATION_CHANGED=2]="EDT_ROTATION_CHANGED",i[i.UNRECOGNIZED=-1]="UNRECOGNIZED"})(Be||(Be={}));function If(n){switch(n){case 0:case"EDT_GENERIC":return 0;case 1:case"EDT_POSITION_CHANGED":return 1;case 2:case"EDT_ROTATION_CHANGED":return 2;case-1:case"UNRECOGNIZED":default:return-1}}function Ef(n){switch(n){case 0:return"EDT_GENERIC";case 1:return"EDT_POSITION_CHANGED";case 2:return"EDT_ROTATION_CHANGED";case-1:default:return"UNRECOGNIZED"}}function Ps(){return{url:""}}var pt={encode(n,e=R.default.Writer.create()){return n.url!==""&&e.uint32(10).string(n.url),e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Ps();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.url=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{url:S(n.url)?String(n.url):""}},toJSON(n){let e={};return n.url!==void 0&&(e.url=n.url),e},fromPartial(n){let e=Ps();return e.url=n.url??"",e}};function gs(){return{assetContractAddress:"",tokenId:"",comment:void 0}}var ht={encode(n,e=R.default.Writer.create()){return n.assetContractAddress!==""&&e.uint32(10).string(n.assetContractAddress),n.tokenId!==""&&e.uint32(18).string(n.tokenId),n.comment!==void 0&&e.uint32(26).string(n.comment),e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=gs();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.assetContractAddress=t.string();break;case 2:i.tokenId=t.string();break;case 3:i.comment=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{assetContractAddress:S(n.assetContractAddress)?String(n.assetContractAddress):"",tokenId:S(n.tokenId)?String(n.tokenId):"",comment:S(n.comment)?String(n.comment):void 0}},toJSON(n){let e={};return n.assetContractAddress!==void 0&&(e.assetContractAddress=n.assetContractAddress),n.tokenId!==void 0&&(e.tokenId=n.tokenId),n.comment!==void 0&&(e.comment=n.comment),e},fromPartial(n){let e=gs();return e.assetContractAddress=n.assetContractAddress??"",e.tokenId=n.tokenId??"",e.comment=n.comment??void 0,e}};function Ss(){return{id:""}}var yt={encode(n,e=R.default.Writer.create()){return n.id!==""&&e.uint32(10).string(n.id),e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Ss();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.id=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{id:S(n.id)?String(n.id):""}},toJSON(n){let e={};return n.id!==void 0&&(e.id=n.id),e},fromPartial(n){let e=Ss();return e.id=n.id??"",e}};function xs(){return{id:""}}var mt={encode(n,e=R.default.Writer.create()){return n.id!==""&&e.uint32(10).string(n.id),e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=xs();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.id=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{id:S(n.id)?String(n.id):""}},toJSON(n){let e={};return n.id!==void 0&&(e.id=n.id),e},fromPartial(n){let e=xs();return e.id=n.id??"",e}};function Ts(){return{entityId:"",classId:0,name:"",json:""}}var Rt={encode(n,e=R.default.Writer.create()){return n.entityId!==""&&e.uint32(10).string(n.entityId),n.classId!==0&&e.uint32(16).int32(n.classId),n.name!==""&&e.uint32(26).string(n.name),n.json!==""&&e.uint32(34).string(n.json),e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Ts();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.entityId=t.string();break;case 2:i.classId=t.int32();break;case 3:i.name=t.string();break;case 4:i.json=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{entityId:S(n.entityId)?String(n.entityId):"",classId:S(n.classId)?Number(n.classId):0,name:S(n.name)?String(n.name):"",json:S(n.json)?String(n.json):""}},toJSON(n){let e={};return n.entityId!==void 0&&(e.entityId=n.entityId),n.classId!==void 0&&(e.classId=Math.round(n.classId)),n.name!==void 0&&(e.name=n.name),n.json!==void 0&&(e.json=n.json),e},fromPartial(n){let e=Ts();return e.entityId=n.entityId??"",e.classId=n.classId??0,e.name=n.name??"",e.json=n.json??"",e}};function Is(){return{entityId:"",name:"",id:""}}var Pt={encode(n,e=R.default.Writer.create()){return n.entityId!==""&&e.uint32(10).string(n.entityId),n.name!==""&&e.uint32(18).string(n.name),n.id!==""&&e.uint32(26).string(n.id),e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Is();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.entityId=t.string();break;case 2:i.name=t.string();break;case 3:i.id=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{entityId:S(n.entityId)?String(n.entityId):"",name:S(n.name)?String(n.name):"",id:S(n.id)?String(n.id):""}},toJSON(n){let e={};return n.entityId!==void 0&&(e.entityId=n.entityId),n.name!==void 0&&(e.name=n.name),n.id!==void 0&&(e.id=n.id),e},fromPartial(n){let e=Is();return e.entityId=n.entityId??"",e.name=n.name??"",e.id=n.id??"",e}};function Es(){return{entityId:"",name:""}}var gt={encode(n,e=R.default.Writer.create()){return n.entityId!==""&&e.uint32(10).string(n.entityId),n.name!==""&&e.uint32(18).string(n.name),e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Es();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.entityId=t.string();break;case 2:i.name=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{entityId:S(n.entityId)?String(n.entityId):"",name:S(n.name)?String(n.name):""}},toJSON(n){let e={};return n.entityId!==void 0&&(e.entityId=n.entityId),n.name!==void 0&&(e.name=n.name),e},fromPartial(n){let e=Es();return e.entityId=n.entityId??"",e.name=n.name??"",e}};function ks(){return{entityId:"",parentId:""}}var St={encode(n,e=R.default.Writer.create()){return n.entityId!==""&&e.uint32(10).string(n.entityId),n.parentId!==""&&e.uint32(18).string(n.parentId),e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=ks();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.entityId=t.string();break;case 2:i.parentId=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{entityId:S(n.entityId)?String(n.entityId):"",parentId:S(n.parentId)?String(n.parentId):""}},toJSON(n){let e={};return n.entityId!==void 0&&(e.entityId=n.entityId),n.parentId!==void 0&&(e.parentId=n.parentId),e},fromPartial(n){let e=ks();return e.entityId=n.entityId??"",e.parentId=n.parentId??"",e}};function _s(){return{queryId:0,payload:""}}var xt={encode(n,e=R.default.Writer.create()){return n.queryId!==0&&e.uint32(8).int32(n.queryId),n.payload!==""&&e.uint32(18).string(n.payload),e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=_s();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.queryId=t.int32();break;case 2:i.payload=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{queryId:S(n.queryId)?Ii(n.queryId):0,payload:S(n.payload)?String(n.payload):""}},toJSON(n){let e={};return n.queryId!==void 0&&(e.queryId=Sf(n.queryId)),n.payload!==void 0&&(e.payload=n.payload),e},fromPartial(n){let e=_s();return e.queryId=n.queryId??0,e.payload=n.payload??"",e}};function vs(){return{id:"",classId:0,name:""}}var Tt={encode(n,e=R.default.Writer.create()){return n.id!==""&&e.uint32(10).string(n.id),n.classId!==0&&e.uint32(16).int32(n.classId),n.name!==""&&e.uint32(26).string(n.name),e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=vs();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.id=t.string();break;case 2:i.classId=t.int32();break;case 3:i.name=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{id:S(n.id)?String(n.id):"",classId:S(n.classId)?Number(n.classId):0,name:S(n.name)?String(n.name):""}},toJSON(n){let e={};return n.id!==void 0&&(e.id=n.id),n.classId!==void 0&&(e.classId=Math.round(n.classId)),n.name!==void 0&&(e.name=n.name),e},fromPartial(n){let e=vs();return e.id=n.id??"",e.classId=n.classId??0,e.name=n.name??"",e}};function ws(){return{id:""}}var It={encode(n,e=R.default.Writer.create()){return n.id!==""&&e.uint32(10).string(n.id),e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=ws();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.id=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{id:S(n.id)?String(n.id):""}},toJSON(n){let e={};return n.id!==void 0&&(e.id=n.id),e},fromPartial(n){let e=ws();return e.id=n.id??"",e}};function Cs(){return{id:"",json:""}}var Et={encode(n,e=R.default.Writer.create()){return n.id!==""&&e.uint32(10).string(n.id),n.json!==""&&e.uint32(18).string(n.json),e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Cs();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.id=t.string();break;case 2:i.json=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{id:S(n.id)?String(n.id):"",json:S(n.json)?String(n.json):""}},toJSON(n){let e={};return n.id!==void 0&&(e.id=n.id),n.json!==void 0&&(e.json=n.json),e},fromPartial(n){let e=Cs();return e.id=n.id??"",e.json=n.json??"",e}};function Bs(){return{}}var kt={encode(n,e=R.default.Writer.create()){return e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Bs();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return Bs()}};function bs(){return{openExternalUrl:void 0,openNftDialog:void 0,createEntity:void 0,removeEntity:void 0,updateEntityComponent:void 0,attachEntityComponent:void 0,componentRemoved:void 0,setEntityParent:void 0,query:void 0,componentCreated:void 0,componentDisposed:void 0,componentUpdated:void 0,initMessagesFinished:void 0}}var _t={encode(n,e=R.default.Writer.create()){return n.openExternalUrl!==void 0&&pt.encode(n.openExternalUrl,e.uint32(10).fork()).ldelim(),n.openNftDialog!==void 0&&ht.encode(n.openNftDialog,e.uint32(18).fork()).ldelim(),n.createEntity!==void 0&&yt.encode(n.createEntity,e.uint32(26).fork()).ldelim(),n.removeEntity!==void 0&&mt.encode(n.removeEntity,e.uint32(34).fork()).ldelim(),n.updateEntityComponent!==void 0&&Rt.encode(n.updateEntityComponent,e.uint32(42).fork()).ldelim(),n.attachEntityComponent!==void 0&&Pt.encode(n.attachEntityComponent,e.uint32(50).fork()).ldelim(),n.componentRemoved!==void 0&&gt.encode(n.componentRemoved,e.uint32(58).fork()).ldelim(),n.setEntityParent!==void 0&&St.encode(n.setEntityParent,e.uint32(66).fork()).ldelim(),n.query!==void 0&&xt.encode(n.query,e.uint32(74).fork()).ldelim(),n.componentCreated!==void 0&&Tt.encode(n.componentCreated,e.uint32(82).fork()).ldelim(),n.componentDisposed!==void 0&&It.encode(n.componentDisposed,e.uint32(90).fork()).ldelim(),n.componentUpdated!==void 0&&Et.encode(n.componentUpdated,e.uint32(98).fork()).ldelim(),n.initMessagesFinished!==void 0&&kt.encode(n.initMessagesFinished,e.uint32(106).fork()).ldelim(),e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=bs();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.openExternalUrl=pt.decode(t,t.uint32());break;case 2:i.openNftDialog=ht.decode(t,t.uint32());break;case 3:i.createEntity=yt.decode(t,t.uint32());break;case 4:i.removeEntity=mt.decode(t,t.uint32());break;case 5:i.updateEntityComponent=Rt.decode(t,t.uint32());break;case 6:i.attachEntityComponent=Pt.decode(t,t.uint32());break;case 7:i.componentRemoved=gt.decode(t,t.uint32());break;case 8:i.setEntityParent=St.decode(t,t.uint32());break;case 9:i.query=xt.decode(t,t.uint32());break;case 10:i.componentCreated=Tt.decode(t,t.uint32());break;case 11:i.componentDisposed=It.decode(t,t.uint32());break;case 12:i.componentUpdated=Et.decode(t,t.uint32());break;case 13:i.initMessagesFinished=kt.decode(t,t.uint32());break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{openExternalUrl:S(n.openExternalUrl)?pt.fromJSON(n.openExternalUrl):void 0,openNftDialog:S(n.openNftDialog)?ht.fromJSON(n.openNftDialog):void 0,createEntity:S(n.createEntity)?yt.fromJSON(n.createEntity):void 0,removeEntity:S(n.removeEntity)?mt.fromJSON(n.removeEntity):void 0,updateEntityComponent:S(n.updateEntityComponent)?Rt.fromJSON(n.updateEntityComponent):void 0,attachEntityComponent:S(n.attachEntityComponent)?Pt.fromJSON(n.attachEntityComponent):void 0,componentRemoved:S(n.componentRemoved)?gt.fromJSON(n.componentRemoved):void 0,setEntityParent:S(n.setEntityParent)?St.fromJSON(n.setEntityParent):void 0,query:S(n.query)?xt.fromJSON(n.query):void 0,componentCreated:S(n.componentCreated)?Tt.fromJSON(n.componentCreated):void 0,componentDisposed:S(n.componentDisposed)?It.fromJSON(n.componentDisposed):void 0,componentUpdated:S(n.componentUpdated)?Et.fromJSON(n.componentUpdated):void 0,initMessagesFinished:S(n.initMessagesFinished)?kt.fromJSON(n.initMessagesFinished):void 0}},toJSON(n){let e={};return n.openExternalUrl!==void 0&&(e.openExternalUrl=n.openExternalUrl?pt.toJSON(n.openExternalUrl):void 0),n.openNftDialog!==void 0&&(e.openNftDialog=n.openNftDialog?ht.toJSON(n.openNftDialog):void 0),n.createEntity!==void 0&&(e.createEntity=n.createEntity?yt.toJSON(n.createEntity):void 0),n.removeEntity!==void 0&&(e.removeEntity=n.removeEntity?mt.toJSON(n.removeEntity):void 0),n.updateEntityComponent!==void 0&&(e.updateEntityComponent=n.updateEntityComponent?Rt.toJSON(n.updateEntityComponent):void 0),n.attachEntityComponent!==void 0&&(e.attachEntityComponent=n.attachEntityComponent?Pt.toJSON(n.attachEntityComponent):void 0),n.componentRemoved!==void 0&&(e.componentRemoved=n.componentRemoved?gt.toJSON(n.componentRemoved):void 0),n.setEntityParent!==void 0&&(e.setEntityParent=n.setEntityParent?St.toJSON(n.setEntityParent):void 0),n.query!==void 0&&(e.query=n.query?xt.toJSON(n.query):void 0),n.componentCreated!==void 0&&(e.componentCreated=n.componentCreated?Tt.toJSON(n.componentCreated):void 0),n.componentDisposed!==void 0&&(e.componentDisposed=n.componentDisposed?It.toJSON(n.componentDisposed):void 0),n.componentUpdated!==void 0&&(e.componentUpdated=n.componentUpdated?Et.toJSON(n.componentUpdated):void 0),n.initMessagesFinished!==void 0&&(e.initMessagesFinished=n.initMessagesFinished?kt.toJSON(n.initMessagesFinished):void 0),e},fromPartial(n){let e=bs();return e.openExternalUrl=n.openExternalUrl!==void 0&&n.openExternalUrl!==null?pt.fromPartial(n.openExternalUrl):void 0,e.openNftDialog=n.openNftDialog!==void 0&&n.openNftDialog!==null?ht.fromPartial(n.openNftDialog):void 0,e.createEntity=n.createEntity!==void 0&&n.createEntity!==null?yt.fromPartial(n.createEntity):void 0,e.removeEntity=n.removeEntity!==void 0&&n.removeEntity!==null?mt.fromPartial(n.removeEntity):void 0,e.updateEntityComponent=n.updateEntityComponent!==void 0&&n.updateEntityComponent!==null?Rt.fromPartial(n.updateEntityComponent):void 0,e.attachEntityComponent=n.attachEntityComponent!==void 0&&n.attachEntityComponent!==null?Pt.fromPartial(n.attachEntityComponent):void 0,e.componentRemoved=n.componentRemoved!==void 0&&n.componentRemoved!==null?gt.fromPartial(n.componentRemoved):void 0,e.setEntityParent=n.setEntityParent!==void 0&&n.setEntityParent!==null?St.fromPartial(n.setEntityParent):void 0,e.query=n.query!==void 0&&n.query!==null?xt.fromPartial(n.query):void 0,e.componentCreated=n.componentCreated!==void 0&&n.componentCreated!==null?Tt.fromPartial(n.componentCreated):void 0,e.componentDisposed=n.componentDisposed!==void 0&&n.componentDisposed!==null?It.fromPartial(n.componentDisposed):void 0,e.componentUpdated=n.componentUpdated!==void 0&&n.componentUpdated!==null?Et.fromPartial(n.componentUpdated):void 0,e.initMessagesFinished=n.initMessagesFinished!==void 0&&n.initMessagesFinished!==null?kt.fromPartial(n.initMessagesFinished):void 0,e}};function As(){return{type:0,tag:void 0,payload:void 0}}var vt={encode(n,e=R.default.Writer.create()){return n.type!==0&&e.uint32(8).int32(n.type),n.tag!==void 0&&e.uint32(18).string(n.tag),n.payload!==void 0&&_t.encode(n.payload,e.uint32(26).fork()).ldelim(),e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=As();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.type=t.int32();break;case 2:i.tag=t.string();break;case 3:i.payload=_t.decode(t,t.uint32());break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{type:S(n.type)?xf(n.type):0,tag:S(n.tag)?String(n.tag):void 0,payload:S(n.payload)?_t.fromJSON(n.payload):void 0}},toJSON(n){let e={};return n.type!==void 0&&(e.type=Tf(n.type)),n.tag!==void 0&&(e.tag=n.tag),n.payload!==void 0&&(e.payload=n.payload?_t.toJSON(n.payload):void 0),e},fromPartial(n){let e=As();return e.type=n.type??0,e.tag=n.tag??void 0,e.payload=n.payload!==void 0&&n.payload!==null?_t.fromPartial(n.payload):void 0,e}};function Ns(){return{actions:[]}}var kf={encode(n,e=R.default.Writer.create()){for(let t of n.actions)vt.encode(t,e.uint32(10).fork()).ldelim();return e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Ns();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.actions.push(vt.decode(t,t.uint32()));break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{actions:Array.isArray(n?.actions)?n.actions.map(e=>vt.fromJSON(e)):[]}},toJSON(n){let e={};return n.actions?e.actions=n.actions.map(t=>t?vt.toJSON(t):void 0):e.actions=[],e},fromPartial(n){let e=Ns();return e.actions=n.actions?.map(t=>vt.fromPartial(t))||[],e}};function Os(){return{events:[]}}var _f={encode(n,e=R.default.Writer.create()){for(let t of n.events)At.encode(t,e.uint32(10).fork()).ldelim();return e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Os();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.events.push(At.decode(t,t.uint32()));break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{events:Array.isArray(n?.events)?n.events.map(e=>At.fromJSON(e)):[]}},toJSON(n){let e={};return n.events?e.events=n.events.map(t=>t?At.toJSON(t):void 0):e.events=[],e},fromPartial(n){let e=Os();return e.events=n.events?.map(t=>At.fromPartial(t))||[],e}};function Ms(){return{eventId:""}}var vf={encode(n,e=R.default.Writer.create()){return n.eventId!==""&&e.uint32(10).string(n.eventId),e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Ms();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.eventId=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{eventId:S(n.eventId)?String(n.eventId):""}},toJSON(n){let e={};return n.eventId!==void 0&&(e.eventId=n.eventId),e},fromPartial(n){let e=Ms();return e.eventId=n.eventId??"",e}};function Us(){return{eventId:""}}var wf={encode(n,e=R.default.Writer.create()){return n.eventId!==""&&e.uint32(10).string(n.eventId),e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Us();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.eventId=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{eventId:S(n.eventId)?String(n.eventId):""}},toJSON(n){let e={};return n.eventId!==void 0&&(e.eventId=n.eventId),e},fromPartial(n){let e=Us();return e.eventId=n.eventId??"",e}};function Ds(){return{}}var Cf={encode(n,e=R.default.Writer.create()){return e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Ds();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return Ds()}};function Ws(){return{}}var Bf={encode(n,e=R.default.Writer.create()){return e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Ws();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return Ws()}};function qs(){return{eventId:"",eventData:""}}var wt={encode(n,e=R.default.Writer.create()){return n.eventId!==""&&e.uint32(26).string(n.eventId),n.eventData!==""&&e.uint32(34).string(n.eventData),e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=qs();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 3:i.eventId=t.string();break;case 4:i.eventData=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{eventId:S(n.eventId)?String(n.eventId):"",eventData:S(n.eventData)?String(n.eventData):""}},toJSON(n){let e={};return n.eventId!==void 0&&(e.eventId=n.eventId),n.eventData!==void 0&&(e.eventData=n.eventData),e},fromPartial(n){let e=qs();return e.eventId=n.eventId??"",e.eventData=n.eventData??"",e}};function Fs(){return{x:0,y:0,z:0}}var Ee={encode(n,e=R.default.Writer.create()){return n.x!==0&&e.uint32(13).float(n.x),n.y!==0&&e.uint32(21).float(n.y),n.z!==0&&e.uint32(29).float(n.z),e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Fs();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.x=t.float();break;case 2:i.y=t.float();break;case 3:i.z=t.float();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{x:S(n.x)?Number(n.x):0,y:S(n.y)?Number(n.y):0,z:S(n.z)?Number(n.z):0}},toJSON(n){let e={};return n.x!==void 0&&(e.x=n.x),n.y!==void 0&&(e.y=n.y),n.z!==void 0&&(e.z=n.z),e},fromPartial(n){let e=Fs();return e.x=n.x??0,e.y=n.y??0,e.z=n.z??0,e}};function Js(){return{x:0,y:0,z:0,w:0}}var Ct={encode(n,e=R.default.Writer.create()){return n.x!==0&&e.uint32(13).float(n.x),n.y!==0&&e.uint32(21).float(n.y),n.z!==0&&e.uint32(29).float(n.z),n.w!==0&&e.uint32(37).float(n.w),e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Js();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.x=t.float();break;case 2:i.y=t.float();break;case 3:i.z=t.float();break;case 4:i.w=t.float();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{x:S(n.x)?Number(n.x):0,y:S(n.y)?Number(n.y):0,z:S(n.z)?Number(n.z):0,w:S(n.w)?Number(n.w):0}},toJSON(n){let e={};return n.x!==void 0&&(e.x=n.x),n.y!==void 0&&(e.y=n.y),n.z!==void 0&&(e.z=n.z),n.w!==void 0&&(e.w=n.w),e},fromPartial(n){let e=Js();return e.x=n.x??0,e.y=n.y??0,e.z=n.z??0,e.w=n.w??0,e}};function zs(){return{position:void 0,cameraPosition:void 0,playerHeight:0}}var Bt={encode(n,e=R.default.Writer.create()){return n.position!==void 0&&Ee.encode(n.position,e.uint32(10).fork()).ldelim(),n.cameraPosition!==void 0&&Ee.encode(n.cameraPosition,e.uint32(18).fork()).ldelim(),n.playerHeight!==0&&e.uint32(29).float(n.playerHeight),e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=zs();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.position=Ee.decode(t,t.uint32());break;case 2:i.cameraPosition=Ee.decode(t,t.uint32());break;case 3:i.playerHeight=t.float();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{position:S(n.position)?Ee.fromJSON(n.position):void 0,cameraPosition:S(n.cameraPosition)?Ee.fromJSON(n.cameraPosition):void 0,playerHeight:S(n.playerHeight)?Number(n.playerHeight):0}},toJSON(n){let e={};return n.position!==void 0&&(e.position=n.position?Ee.toJSON(n.position):void 0),n.cameraPosition!==void 0&&(e.cameraPosition=n.cameraPosition?Ee.toJSON(n.cameraPosition):void 0),n.playerHeight!==void 0&&(e.playerHeight=n.playerHeight),e},fromPartial(n){let e=zs();return e.position=n.position!==void 0&&n.position!==null?Ee.fromPartial(n.position):void 0,e.cameraPosition=n.cameraPosition!==void 0&&n.cameraPosition!==null?Ee.fromPartial(n.cameraPosition):void 0,e.playerHeight=n.playerHeight??0,e}};function Ls(){return{rotation:void 0,quaternion:void 0}}var bt={encode(n,e=R.default.Writer.create()){return n.rotation!==void 0&&Ee.encode(n.rotation,e.uint32(10).fork()).ldelim(),n.quaternion!==void 0&&Ct.encode(n.quaternion,e.uint32(18).fork()).ldelim(),e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Ls();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.rotation=Ee.decode(t,t.uint32());break;case 2:i.quaternion=Ct.decode(t,t.uint32());break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{rotation:S(n.rotation)?Ee.fromJSON(n.rotation):void 0,quaternion:S(n.quaternion)?Ct.fromJSON(n.quaternion):void 0}},toJSON(n){let e={};return n.rotation!==void 0&&(e.rotation=n.rotation?Ee.toJSON(n.rotation):void 0),n.quaternion!==void 0&&(e.quaternion=n.quaternion?Ct.toJSON(n.quaternion):void 0),e},fromPartial(n){let e=Ls();return e.rotation=n.rotation!==void 0&&n.rotation!==null?Ee.fromPartial(n.rotation):void 0,e.quaternion=n.quaternion!==void 0&&n.quaternion!==null?Ct.fromPartial(n.quaternion):void 0,e}};function Gs(){return{type:0,generic:void 0,positionChanged:void 0,rotationChanged:void 0}}var At={encode(n,e=R.default.Writer.create()){return n.type!==0&&e.uint32(8).int32(n.type),n.generic!==void 0&&wt.encode(n.generic,e.uint32(18).fork()).ldelim(),n.positionChanged!==void 0&&Bt.encode(n.positionChanged,e.uint32(26).fork()).ldelim(),n.rotationChanged!==void 0&&bt.encode(n.rotationChanged,e.uint32(34).fork()).ldelim(),e},decode(n,e){let t=n instanceof R.default.Reader?n:new R.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Gs();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.type=t.int32();break;case 2:i.generic=wt.decode(t,t.uint32());break;case 3:i.positionChanged=Bt.decode(t,t.uint32());break;case 4:i.rotationChanged=bt.decode(t,t.uint32());break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{type:S(n.type)?If(n.type):0,generic:S(n.generic)?wt.fromJSON(n.generic):void 0,positionChanged:S(n.positionChanged)?Bt.fromJSON(n.positionChanged):void 0,rotationChanged:S(n.rotationChanged)?bt.fromJSON(n.rotationChanged):void 0}},toJSON(n){let e={};return n.type!==void 0&&(e.type=Ef(n.type)),n.generic!==void 0&&(e.generic=n.generic?wt.toJSON(n.generic):void 0),n.positionChanged!==void 0&&(e.positionChanged=n.positionChanged?Bt.toJSON(n.positionChanged):void 0),n.rotationChanged!==void 0&&(e.rotationChanged=n.rotationChanged?bt.toJSON(n.rotationChanged):void 0),e},fromPartial(n){let e=Gs();return e.type=n.type??0,e.generic=n.generic!==void 0&&n.generic!==null?wt.fromPartial(n.generic):void 0,e.positionChanged=n.positionChanged!==void 0&&n.positionChanged!==null?Bt.fromPartial(n.positionChanged):void 0,e.rotationChanged=n.rotationChanged!==void 0&&n.rotationChanged!==null?bt.fromPartial(n.rotationChanged):void 0,e}},$s={name:"EngineApiService",fullName:"decentraland.kernel.apis.EngineApiService",methods:{sendBatch:{name:"SendBatch",requestType:kf,requestStream:!1,responseType:_f,responseStream:!1,options:{}},subscribe:{name:"Subscribe",requestType:wf,requestStream:!1,responseType:Cf,responseStream:!1,options:{}},unsubscribe:{name:"Unsubscribe",requestType:vf,requestStream:!1,responseType:Bf,responseStream:!1,options:{}}}};function S(n){return n!=null}function Ys(n){return Hs.loadService(n,$s)}f();var ki=C(fe());f();var k=C($());f();var yr=C($());function Ks(){return{file:"",hash:""}}var ze={encode(n,e=yr.default.Writer.create()){return n.file!==""&&e.uint32(10).string(n.file),n.hash!==""&&e.uint32(18).string(n.hash),e},decode(n,e){let t=n instanceof yr.default.Reader?n:new yr.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Ks();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.file=t.string();break;case 2:i.hash=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{file:Xs(n.file)?String(n.file):"",hash:Xs(n.hash)?String(n.hash):""}},toJSON(n){let e={};return n.file!==void 0&&(e.file=n.file),n.hash!==void 0&&(e.hash=n.hash),e},fromPartial(n){let e=Ks();return e.file=n.file??"",e.hash=n.hash??"",e}};function Xs(n){return n!=null}function Qs(){return{content:[],metadataJson:""}}var Nt={encode(n,e=k.default.Writer.create()){for(let t of n.content)ze.encode(t,e.uint32(10).fork()).ldelim();return n.metadataJson!==""&&e.uint32(18).string(n.metadataJson),e},decode(n,e){let t=n instanceof k.default.Reader?n:new k.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Qs();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.content.push(ze.decode(t,t.uint32()));break;case 2:i.metadataJson=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{content:Array.isArray(n?.content)?n.content.map(e=>ze.fromJSON(e)):[],metadataJson:oe(n.metadataJson)?String(n.metadataJson):""}},toJSON(n){let e={};return n.content?e.content=n.content.map(t=>t?ze.toJSON(t):void 0):e.content=[],n.metadataJson!==void 0&&(e.metadataJson=n.metadataJson),e},fromPartial(n){let e=Qs();return e.content=n.content?.map(t=>ze.fromPartial(t))||[],e.metadataJson=n.metadataJson??"",e}};function Vs(){return{id:"",baseUrl:"",entity:void 0,useFPSThrottling:!1}}var bf={encode(n,e=k.default.Writer.create()){return n.id!==""&&e.uint32(10).string(n.id),n.baseUrl!==""&&e.uint32(34).string(n.baseUrl),n.entity!==void 0&&Nt.encode(n.entity,e.uint32(18).fork()).ldelim(),n.useFPSThrottling===!0&&e.uint32(40).bool(n.useFPSThrottling),e},decode(n,e){let t=n instanceof k.default.Reader?n:new k.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Vs();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.id=t.string();break;case 4:i.baseUrl=t.string();break;case 2:i.entity=Nt.decode(t,t.uint32());break;case 5:i.useFPSThrottling=t.bool();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{id:oe(n.id)?String(n.id):"",baseUrl:oe(n.baseUrl)?String(n.baseUrl):"",entity:oe(n.entity)?Nt.fromJSON(n.entity):void 0,useFPSThrottling:oe(n.useFPSThrottling)?Boolean(n.useFPSThrottling):!1}},toJSON(n){let e={};return n.id!==void 0&&(e.id=n.id),n.baseUrl!==void 0&&(e.baseUrl=n.baseUrl),n.entity!==void 0&&(e.entity=n.entity?Nt.toJSON(n.entity):void 0),n.useFPSThrottling!==void 0&&(e.useFPSThrottling=n.useFPSThrottling),e},fromPartial(n){let e=Vs();return e.id=n.id??"",e.baseUrl=n.baseUrl??"",e.entity=n.entity!==void 0&&n.entity!==null?Nt.fromPartial(n.entity):void 0,e.useFPSThrottling=n.useFPSThrottling??!1,e}};function Zs(){return{isPreview:!1}}var Af={encode(n,e=k.default.Writer.create()){return n.isPreview===!0&&e.uint32(8).bool(n.isPreview),e},decode(n,e){let t=n instanceof k.default.Reader?n:new k.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Zs();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.isPreview=t.bool();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{isPreview:oe(n.isPreview)?Boolean(n.isPreview):!1}},toJSON(n){let e={};return n.isPreview!==void 0&&(e.isPreview=n.isPreview),e},fromPartial(n){let e=Zs();return e.isPreview=n.isPreview??!1,e}};function js(){return{status:!1}}var Nf={encode(n,e=k.default.Writer.create()){return n.status===!0&&e.uint32(8).bool(n.status),e},decode(n,e){let t=n instanceof k.default.Reader?n:new k.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=js();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.status=t.bool();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{status:oe(n.status)?Boolean(n.status):!1}},toJSON(n){let e={};return n.status!==void 0&&(e.status=n.status),e},fromPartial(n){let e=js();return e.status=n.status??!1,e}};function ed(){return{platform:""}}var Of={encode(n,e=k.default.Writer.create()){return n.platform!==""&&e.uint32(10).string(n.platform),e},decode(n,e){let t=n instanceof k.default.Reader?n:new k.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=ed();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.platform=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{platform:oe(n.platform)?String(n.platform):""}},toJSON(n){let e={};return n.platform!==void 0&&(e.platform=n.platform),e},fromPartial(n){let e=ed();return e.platform=n.platform??"",e}};function nd(){return{domain:"",layer:"",room:"",serverName:"",displayName:"",protocol:""}}var Ot={encode(n,e=k.default.Writer.create()){return n.domain!==""&&e.uint32(10).string(n.domain),n.layer!==""&&e.uint32(18).string(n.layer),n.room!==""&&e.uint32(26).string(n.room),n.serverName!==""&&e.uint32(34).string(n.serverName),n.displayName!==""&&e.uint32(42).string(n.displayName),n.protocol!==""&&e.uint32(50).string(n.protocol),e},decode(n,e){let t=n instanceof k.default.Reader?n:new k.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=nd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.domain=t.string();break;case 2:i.layer=t.string();break;case 3:i.room=t.string();break;case 4:i.serverName=t.string();break;case 5:i.displayName=t.string();break;case 6:i.protocol=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{domain:oe(n.domain)?String(n.domain):"",layer:oe(n.layer)?String(n.layer):"",room:oe(n.room)?String(n.room):"",serverName:oe(n.serverName)?String(n.serverName):"",displayName:oe(n.displayName)?String(n.displayName):"",protocol:oe(n.protocol)?String(n.protocol):""}},toJSON(n){let e={};return n.domain!==void 0&&(e.domain=n.domain),n.layer!==void 0&&(e.layer=n.layer),n.room!==void 0&&(e.room=n.room),n.serverName!==void 0&&(e.serverName=n.serverName),n.displayName!==void 0&&(e.displayName=n.displayName),n.protocol!==void 0&&(e.protocol=n.protocol),e},fromPartial(n){let e=nd();return e.domain=n.domain??"",e.layer=n.layer??"",e.room=n.room??"",e.serverName=n.serverName??"",e.displayName=n.displayName??"",e.protocol=n.protocol??"",e}};function td(){return{currentRealm:void 0}}var Mf={encode(n,e=k.default.Writer.create()){return n.currentRealm!==void 0&&Ot.encode(n.currentRealm,e.uint32(10).fork()).ldelim(),e},decode(n,e){let t=n instanceof k.default.Reader?n:new k.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=td();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.currentRealm=Ot.decode(t,t.uint32());break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{currentRealm:oe(n.currentRealm)?Ot.fromJSON(n.currentRealm):void 0}},toJSON(n){let e={};return n.currentRealm!==void 0&&(e.currentRealm=n.currentRealm?Ot.toJSON(n.currentRealm):void 0),e},fromPartial(n){let e=td();return e.currentRealm=n.currentRealm!==void 0&&n.currentRealm!==null?Ot.fromPartial(n.currentRealm):void 0,e}};function rd(){return{clientUri:"",configurations:{}}}var Uf={encode(n,e=k.default.Writer.create()){return n.clientUri!==""&&e.uint32(10).string(n.clientUri),Object.entries(n.configurations).forEach(([t,r])=>{od.encode({key:t,value:r},e.uint32(18).fork()).ldelim()}),e},decode(n,e){let t=n instanceof k.default.Reader?n:new k.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=rd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.clientUri=t.string();break;case 2:let a=od.decode(t,t.uint32());a.value!==void 0&&(i.configurations[a.key]=a.value);break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{clientUri:oe(n.clientUri)?String(n.clientUri):"",configurations:$f(n.configurations)?Object.entries(n.configurations).reduce((e,[t,r])=>(e[t]=String(r),e),{}):{}}},toJSON(n){let e={};return n.clientUri!==void 0&&(e.clientUri=n.clientUri),e.configurations={},n.configurations&&Object.entries(n.configurations).forEach(([t,r])=>{e.configurations[t]=r}),e},fromPartial(n){let e=rd();return e.clientUri=n.clientUri??"",e.configurations=Object.entries(n.configurations??{}).reduce((t,[r,i])=>(i!==void 0&&(t[r]=String(i)),t),{}),e}};function id(){return{key:"",value:""}}var od={encode(n,e=k.default.Writer.create()){return n.key!==""&&e.uint32(10).string(n.key),n.value!==""&&e.uint32(18).string(n.value),e},decode(n,e){let t=n instanceof k.default.Reader?n:new k.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=id();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.key=t.string();break;case 2:i.value=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{key:oe(n.key)?String(n.key):"",value:oe(n.value)?String(n.value):""}},toJSON(n){let e={};return n.key!==void 0&&(e.key=n.key),n.value!==void 0&&(e.value=n.value),e},fromPartial(n){let e=id();return e.key=n.key??"",e.value=n.value??"",e}};function ad(){return{seconds:0}}var Df={encode(n,e=k.default.Writer.create()){return n.seconds!==0&&e.uint32(8).int32(n.seconds),e},decode(n,e){let t=n instanceof k.default.Reader?n:new k.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=ad();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.seconds=t.int32();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{seconds:oe(n.seconds)?Number(n.seconds):0}},toJSON(n){let e={};return n.seconds!==void 0&&(e.seconds=Math.round(n.seconds)),e},fromPartial(n){let e=ad();return e.seconds=n.seconds??0,e}};function sd(){return{}}var Wf={encode(n,e=k.default.Writer.create()){return e},decode(n,e){let t=n instanceof k.default.Reader?n:new k.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=sd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return sd()}};function dd(){return{}}var qf={encode(n,e=k.default.Writer.create()){return e},decode(n,e){let t=n instanceof k.default.Reader?n:new k.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=dd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return dd()}};function ld(){return{}}var Ff={encode(n,e=k.default.Writer.create()){return e},decode(n,e){let t=n instanceof k.default.Reader?n:new k.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=ld();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return ld()}};function ud(){return{}}var Jf={encode(n,e=k.default.Writer.create()){return e},decode(n,e){let t=n instanceof k.default.Reader?n:new k.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=ud();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return ud()}};function cd(){return{}}var zf={encode(n,e=k.default.Writer.create()){return e},decode(n,e){let t=n instanceof k.default.Reader?n:new k.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=cd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return cd()}};function fd(){return{}}var Lf={encode(n,e=k.default.Writer.create()){return e},decode(n,e){let t=n instanceof k.default.Reader?n:new k.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=fd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return fd()}};function pd(){return{}}var Gf={encode(n,e=k.default.Writer.create()){return e},decode(n,e){let t=n instanceof k.default.Reader?n:new k.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=pd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return pd()}},Ei={name:"EnvironmentApiService",fullName:"decentraland.kernel.apis.EnvironmentApiService",methods:{getBootstrapData:{name:"GetBootstrapData",requestType:Wf,requestStream:!1,responseType:bf,responseStream:!1,options:{}},isPreviewMode:{name:"IsPreviewMode",requestType:qf,requestStream:!1,responseType:Af,responseStream:!1,options:{}},getPlatform:{name:"GetPlatform",requestType:Ff,requestStream:!1,responseType:Of,responseStream:!1,options:{}},areUnsafeRequestAllowed:{name:"AreUnsafeRequestAllowed",requestType:Jf,requestStream:!1,responseType:Nf,responseStream:!1,options:{}},getCurrentRealm:{name:"GetCurrentRealm",requestType:zf,requestStream:!1,responseType:Mf,responseStream:!1,options:{}},getExplorerConfiguration:{name:"GetExplorerConfiguration",requestType:Lf,requestStream:!1,responseType:Uf,responseStream:!1,options:{}},getDecentralandTime:{name:"GetDecentralandTime",requestType:Gf,requestStream:!1,responseType:Df,responseStream:!1,options:{}}}};function $f(n){return typeof n=="object"&&n!==null}function oe(n){return n!=null}var hd;(function(t){t.DESKTOP="desktop",t.BROWSER="browser"})(hd||(hd={}));var Mt;(function(t){function n(r){return ki.loadService(r,Ei)}t.create=n;function e(r){let i=ki.loadService(r,Ei);return{...i,async getBootstrapData(){let o=await i.getBootstrapData({}),a=JSON.parse(o.entity?.metadataJson||"{}");return{sceneId:o.id,name:a.display?.title||"Unnamed",main:a.main,baseUrl:o.baseUrl,mappings:o.entity?.content||[],useFPSThrottling:o.useFPSThrottling,data:a}},async areUnsafeRequestAllowed(){return(await i.areUnsafeRequestAllowed({})).status},async getCurrentRealm(){return(await i.getCurrentRealm({})).currentRealm},async isPreviewMode(){return(await i.isPreviewMode({})).isPreview},async getExplorerConfiguration(){return await i.getExplorerConfiguration({})},async getPlatform(){return(await i.getPlatform({})).platform},async getDecentralandTime(){return await i.getDecentralandTime({})}}}t.createLegacy=e})(Mt||(Mt={}));f();var _i=C(fe());f();var b=C($());function yd(){return{toAddress:"",amount:0,currency:""}}var Hf={encode(n,e=b.default.Writer.create()){return n.toAddress!==""&&e.uint32(10).string(n.toAddress),n.amount!==0&&e.uint32(21).float(n.amount),n.currency!==""&&e.uint32(26).string(n.currency),e},decode(n,e){let t=n instanceof b.default.Reader?n:new b.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=yd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.toAddress=t.string();break;case 2:i.amount=t.float();break;case 3:i.currency=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{toAddress:pe(n.toAddress)?String(n.toAddress):"",amount:pe(n.amount)?Number(n.amount):0,currency:pe(n.currency)?String(n.currency):""}},toJSON(n){let e={};return n.toAddress!==void 0&&(e.toAddress=n.toAddress),n.amount!==void 0&&(e.amount=n.amount),n.currency!==void 0&&(e.currency=n.currency),e},fromPartial(n){let e=yd();return e.toAddress=n.toAddress??"",e.amount=n.amount??0,e.currency=n.currency??"",e}};function md(){return{jsonAnyResponse:""}}var Yf={encode(n,e=b.default.Writer.create()){return n.jsonAnyResponse!==""&&e.uint32(10).string(n.jsonAnyResponse),e},decode(n,e){let t=n instanceof b.default.Reader?n:new b.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=md();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.jsonAnyResponse=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{jsonAnyResponse:pe(n.jsonAnyResponse)?String(n.jsonAnyResponse):""}},toJSON(n){let e={};return n.jsonAnyResponse!==void 0&&(e.jsonAnyResponse=n.jsonAnyResponse),e},fromPartial(n){let e=md();return e.jsonAnyResponse=n.jsonAnyResponse??"",e}};function Rd(){return{message:{}}}var Kf={encode(n,e=b.default.Writer.create()){return Object.entries(n.message).forEach(([t,r])=>{gd.encode({key:t,value:r},e.uint32(10).fork()).ldelim()}),e},decode(n,e){let t=n instanceof b.default.Reader?n:new b.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Rd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:let a=gd.decode(t,t.uint32());a.value!==void 0&&(i.message[a.key]=a.value);break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{message:Cd(n.message)?Object.entries(n.message).reduce((e,[t,r])=>(e[t]=String(r),e),{}):{}}},toJSON(n){let e={};return e.message={},n.message&&Object.entries(n.message).forEach(([t,r])=>{e.message[t]=r}),e},fromPartial(n){let e=Rd();return e.message=Object.entries(n.message??{}).reduce((t,[r,i])=>(i!==void 0&&(t[r]=String(i)),t),{}),e}};function Pd(){return{key:"",value:""}}var gd={encode(n,e=b.default.Writer.create()){return n.key!==""&&e.uint32(10).string(n.key),n.value!==""&&e.uint32(18).string(n.value),e},decode(n,e){let t=n instanceof b.default.Reader?n:new b.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Pd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.key=t.string();break;case 2:i.value=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{key:pe(n.key)?String(n.key):"",value:pe(n.value)?String(n.value):""}},toJSON(n){let e={};return n.key!==void 0&&(e.key=n.key),n.value!==void 0&&(e.value=n.value),e},fromPartial(n){let e=Pd();return e.key=n.key??"",e.value=n.value??"",e}};function Sd(){return{message:"",hexEncodedMessage:"",signature:""}}var Xf={encode(n,e=b.default.Writer.create()){return n.message!==""&&e.uint32(10).string(n.message),n.hexEncodedMessage!==""&&e.uint32(18).string(n.hexEncodedMessage),n.signature!==""&&e.uint32(26).string(n.signature),e},decode(n,e){let t=n instanceof b.default.Reader?n:new b.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Sd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.message=t.string();break;case 2:i.hexEncodedMessage=t.string();break;case 3:i.signature=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{message:pe(n.message)?String(n.message):"",hexEncodedMessage:pe(n.hexEncodedMessage)?String(n.hexEncodedMessage):"",signature:pe(n.signature)?String(n.signature):""}},toJSON(n){let e={};return n.message!==void 0&&(e.message=n.message),n.hexEncodedMessage!==void 0&&(e.hexEncodedMessage=n.hexEncodedMessage),n.signature!==void 0&&(e.signature=n.signature),e},fromPartial(n){let e=Sd();return e.message=n.message??"",e.hexEncodedMessage=n.hexEncodedMessage??"",e.signature=n.signature??"",e}};function xd(){return{message:""}}var Qf={encode(n,e=b.default.Writer.create()){return n.message!==""&&e.uint32(10).string(n.message),e},decode(n,e){let t=n instanceof b.default.Reader?n:new b.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=xd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.message=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{message:pe(n.message)?String(n.message):""}},toJSON(n){let e={};return n.message!==void 0&&(e.message=n.message),e},fromPartial(n){let e=xd();return e.message=n.message??"",e}};function Td(){return{dict:{}}}var Vf={encode(n,e=b.default.Writer.create()){return Object.entries(n.dict).forEach(([t,r])=>{Ed.encode({key:t,value:r},e.uint32(10).fork()).ldelim()}),e},decode(n,e){let t=n instanceof b.default.Reader?n:new b.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Td();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:let a=Ed.decode(t,t.uint32());a.value!==void 0&&(i.dict[a.key]=a.value);break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{dict:Cd(n.dict)?Object.entries(n.dict).reduce((e,[t,r])=>(e[t]=String(r),e),{}):{}}},toJSON(n){let e={};return e.dict={},n.dict&&Object.entries(n.dict).forEach(([t,r])=>{e.dict[t]=r}),e},fromPartial(n){let e=Td();return e.dict=Object.entries(n.dict??{}).reduce((t,[r,i])=>(i!==void 0&&(t[r]=String(i)),t),{}),e}};function Id(){return{key:"",value:""}}var Ed={encode(n,e=b.default.Writer.create()){return n.key!==""&&e.uint32(10).string(n.key),n.value!==""&&e.uint32(18).string(n.value),e},decode(n,e){let t=n instanceof b.default.Reader?n:new b.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Id();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.key=t.string();break;case 2:i.value=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{key:pe(n.key)?String(n.key):"",value:pe(n.value)?String(n.value):""}},toJSON(n){let e={};return n.key!==void 0&&(e.key=n.key),n.value!==void 0&&(e.value=n.value),e},fromPartial(n){let e=Id();return e.key=n.key??"",e.value=n.value??"",e}};function kd(){return{id:0,method:"",jsonParams:""}}var Zf={encode(n,e=b.default.Writer.create()){return n.id!==0&&e.uint32(8).int32(n.id),n.method!==""&&e.uint32(18).string(n.method),n.jsonParams!==""&&e.uint32(26).string(n.jsonParams),e},decode(n,e){let t=n instanceof b.default.Reader?n:new b.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=kd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.id=t.int32();break;case 2:i.method=t.string();break;case 3:i.jsonParams=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{id:pe(n.id)?Number(n.id):0,method:pe(n.method)?String(n.method):"",jsonParams:pe(n.jsonParams)?String(n.jsonParams):""}},toJSON(n){let e={};return n.id!==void 0&&(e.id=Math.round(n.id)),n.method!==void 0&&(e.method=n.method),n.jsonParams!==void 0&&(e.jsonParams=n.jsonParams),e},fromPartial(n){let e=kd();return e.id=n.id??0,e.method=n.method??"",e.jsonParams=n.jsonParams??"",e}};function _d(){return{jsonAnyResponse:""}}var jf={encode(n,e=b.default.Writer.create()){return n.jsonAnyResponse!==""&&e.uint32(10).string(n.jsonAnyResponse),e},decode(n,e){let t=n instanceof b.default.Reader?n:new b.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=_d();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.jsonAnyResponse=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{jsonAnyResponse:pe(n.jsonAnyResponse)?String(n.jsonAnyResponse):""}},toJSON(n){let e={};return n.jsonAnyResponse!==void 0&&(e.jsonAnyResponse=n.jsonAnyResponse),e},fromPartial(n){let e=_d();return e.jsonAnyResponse=n.jsonAnyResponse??"",e}};function vd(){return{}}var ep={encode(n,e=b.default.Writer.create()){return e},decode(n,e){let t=n instanceof b.default.Reader?n:new b.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=vd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return vd()}};function wd(){return{address:void 0}}var np={encode(n,e=b.default.Writer.create()){return n.address!==void 0&&e.uint32(10).string(n.address),e},decode(n,e){let t=n instanceof b.default.Reader?n:new b.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=wd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.address=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{address:pe(n.address)?String(n.address):void 0}},toJSON(n){let e={};return n.address!==void 0&&(e.address=n.address),e},fromPartial(n){let e=wd();return e.address=n.address??void 0,e}},Ut={name:"EthereumControllerService",fullName:"decentraland.kernel.apis.EthereumControllerService",methods:{requirePayment:{name:"RequirePayment",requestType:Hf,requestStream:!1,responseType:Yf,responseStream:!1,options:{}},signMessage:{name:"SignMessage",requestType:Kf,requestStream:!1,responseType:Xf,responseStream:!1,options:{}},convertMessageToObject:{name:"ConvertMessageToObject",requestType:Qf,requestStream:!1,responseType:Vf,responseStream:!1,options:{}},sendAsync:{name:"SendAsync",requestType:Zf,requestStream:!1,responseType:jf,responseStream:!1,options:{}},getUserAccount:{name:"GetUserAccount",requestType:ep,requestStream:!1,responseType:np,responseStream:!1,options:{}}}};function Cd(n){return typeof n=="object"&&n!==null}function pe(n){return n!=null}var Dt;(function(t){function n(r){return _i.loadService(r,Ut)}t.create=n;function e(r){let i=_i.loadService(r,Ut);return{...i,async requirePayment(o,a,d){let s=await i.requirePayment({toAddress:o,amount:a,currency:d});return JSON.parse(s.jsonAnyResponse)},async signMessage(o){return await i.signMessage({message:o})},async convertMessageToObject(o){return(await i.convertMessageToObject({message:o})).dict},async sendAsync(o){return JSON.parse((await i.sendAsync({id:o.id,method:o.method,jsonParams:JSON.stringify(o.params)})).jsonAnyResponse)},async getUserAccount(){return(await i.getUserAccount({})).address}}}t.createLegacy=e})(Dt||(Dt={}));f();var Dd=C(fe());f();var Ne=C($());function Bd(){return{data:new Uint8Array}}var tp={encode(n,e=Ne.default.Writer.create()){return n.data.length!==0&&e.uint32(10).bytes(n.data),e},decode(n,e){let t=n instanceof Ne.default.Reader?n:new Ne.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Bd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.data=t.bytes();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{data:ap(n.data)?Md(n.data):new Uint8Array}},toJSON(n){let e={};return n.data!==void 0&&(e.data=Ud(n.data!==void 0?n.data:new Uint8Array)),e},fromPartial(n){let e=Bd();return e.data=n.data??new Uint8Array,e}};function bd(){return{}}var rp={encode(n,e=Ne.default.Writer.create()){return e},decode(n,e){let t=n instanceof Ne.default.Reader?n:new Ne.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=bd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return bd()}};function Ad(){return{}}var ip={encode(n,e=Ne.default.Writer.create()){return e},decode(n,e){let t=n instanceof Ne.default.Reader?n:new Ne.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Ad();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return Ad()}};function Nd(){return{data:[]}}var op={encode(n,e=Ne.default.Writer.create()){for(let t of n.data)e.uint32(10).bytes(t);return e},decode(n,e){let t=n instanceof Ne.default.Reader?n:new Ne.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Nd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.data.push(t.bytes());break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{data:Array.isArray(n?.data)?n.data.map(e=>Md(e)):[]}},toJSON(n){let e={};return n.data?e.data=n.data.map(t=>Ud(t!==void 0?t:new Uint8Array)):e.data=[],e},fromPartial(n){let e=Nd();return e.data=n.data?.map(t=>t)||[],e}},Od={name:"ExperimentalApiService",fullName:"decentraland.kernel.apis.ExperimentalApiService",methods:{sendToRenderer:{name:"SendToRenderer",requestType:tp,requestStream:!1,responseType:rp,responseStream:!1,options:{}},messageFromRenderer:{name:"MessageFromRenderer",requestType:ip,requestStream:!1,responseType:op,responseStream:!1,options:{}}}},_n=(()=>{if(typeof _n!="undefined")return _n;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw"Unable to locate global object"})();function Md(n){if(_n.Buffer)return Uint8Array.from(_n.Buffer.from(n,"base64"));{let e=_n.atob(n),t=new Uint8Array(e.length);for(let r=0;r<e.length;++r)t[r]=e.charCodeAt(r);return t}}function Ud(n){if(_n.Buffer)return _n.Buffer.from(n).toString("base64");{let e=[];return n.forEach(t=>{e.push(String.fromCharCode(t))}),_n.btoa(e.join(""))}}function ap(n){return n!=null}function Wd(n){return Dd.loadService(n,Od)}f();var wi=C(fe());f();var X=C($());function qd(){return{parcelId:"",rootCid:"",contents:[]}}var Wt={encode(n,e=X.default.Writer.create()){n.parcelId!==""&&e.uint32(10).string(n.parcelId),n.rootCid!==""&&e.uint32(18).string(n.rootCid);for(let t of n.contents)ze.encode(t,e.uint32(26).fork()).ldelim();return e},decode(n,e){let t=n instanceof X.default.Reader?n:new X.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=qd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.parcelId=t.string();break;case 2:i.rootCid=t.string();break;case 3:i.contents.push(ze.decode(t,t.uint32()));break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{parcelId:Ve(n.parcelId)?String(n.parcelId):"",rootCid:Ve(n.rootCid)?String(n.rootCid):"",contents:Array.isArray(n?.contents)?n.contents.map(e=>ze.fromJSON(e)):[]}},toJSON(n){let e={};return n.parcelId!==void 0&&(e.parcelId=n.parcelId),n.rootCid!==void 0&&(e.rootCid=n.rootCid),n.contents?e.contents=n.contents.map(t=>t?ze.toJSON(t):void 0):e.contents=[],e},fromPartial(n){let e=qd();return e.parcelId=n.parcelId??"",e.rootCid=n.rootCid??"",e.contents=n.contents?.map(t=>ze.fromPartial(t))||[],e}};function Fd(){return{sceneId:"",sceneJsonData:"",baseUrl:"",baseUrlBundles:"",mappingsResponse:void 0}}var qt={encode(n,e=X.default.Writer.create()){return n.sceneId!==""&&e.uint32(10).string(n.sceneId),n.sceneJsonData!==""&&e.uint32(18).string(n.sceneJsonData),n.baseUrl!==""&&e.uint32(26).string(n.baseUrl),n.baseUrlBundles!==""&&e.uint32(34).string(n.baseUrlBundles),n.mappingsResponse!==void 0&&Wt.encode(n.mappingsResponse,e.uint32(42).fork()).ldelim(),e},decode(n,e){let t=n instanceof X.default.Reader?n:new X.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Fd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.sceneId=t.string();break;case 2:i.sceneJsonData=t.string();break;case 3:i.baseUrl=t.string();break;case 4:i.baseUrlBundles=t.string();break;case 5:i.mappingsResponse=Wt.decode(t,t.uint32());break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{sceneId:Ve(n.sceneId)?String(n.sceneId):"",sceneJsonData:Ve(n.sceneJsonData)?String(n.sceneJsonData):"",baseUrl:Ve(n.baseUrl)?String(n.baseUrl):"",baseUrlBundles:Ve(n.baseUrlBundles)?String(n.baseUrlBundles):"",mappingsResponse:Ve(n.mappingsResponse)?Wt.fromJSON(n.mappingsResponse):void 0}},toJSON(n){let e={};return n.sceneId!==void 0&&(e.sceneId=n.sceneId),n.sceneJsonData!==void 0&&(e.sceneJsonData=n.sceneJsonData),n.baseUrl!==void 0&&(e.baseUrl=n.baseUrl),n.baseUrlBundles!==void 0&&(e.baseUrlBundles=n.baseUrlBundles),n.mappingsResponse!==void 0&&(e.mappingsResponse=n.mappingsResponse?Wt.toJSON(n.mappingsResponse):void 0),e},fromPartial(n){let e=Fd();return e.sceneId=n.sceneId??"",e.sceneJsonData=n.sceneJsonData??"",e.baseUrl=n.baseUrl??"",e.baseUrlBundles=n.baseUrlBundles??"",e.mappingsResponse=n.mappingsResponse!==void 0&&n.mappingsResponse!==null?Wt.fromPartial(n.mappingsResponse):void 0,e}};function Jd(){return{}}var sp={encode(n,e=X.default.Writer.create()){return e},decode(n,e){let t=n instanceof X.default.Reader?n:new X.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Jd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return Jd()}};function zd(){return{land:void 0,cid:""}}var dp={encode(n,e=X.default.Writer.create()){return n.land!==void 0&&qt.encode(n.land,e.uint32(10).fork()).ldelim(),n.cid!==""&&e.uint32(18).string(n.cid),e},decode(n,e){let t=n instanceof X.default.Reader?n:new X.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=zd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.land=qt.decode(t,t.uint32());break;case 2:i.cid=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{land:Ve(n.land)?qt.fromJSON(n.land):void 0,cid:Ve(n.cid)?String(n.cid):""}},toJSON(n){let e={};return n.land!==void 0&&(e.land=n.land?qt.toJSON(n.land):void 0),n.cid!==void 0&&(e.cid=n.cid),e},fromPartial(n){let e=zd();return e.land=n.land!==void 0&&n.land!==null?qt.fromPartial(n.land):void 0,e.cid=n.cid??"",e}};function Ld(){return{}}var lp={encode(n,e=X.default.Writer.create()){return e},decode(n,e){let t=n instanceof X.default.Reader?n:new X.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Ld();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return Ld()}};function Gd(){return{sceneId:""}}var up={encode(n,e=X.default.Writer.create()){return n.sceneId!==""&&e.uint32(10).string(n.sceneId),e},decode(n,e){let t=n instanceof X.default.Reader?n:new X.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Gd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.sceneId=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{sceneId:Ve(n.sceneId)?String(n.sceneId):""}},toJSON(n){let e={};return n.sceneId!==void 0&&(e.sceneId=n.sceneId),e},fromPartial(n){let e=Gd();return e.sceneId=n.sceneId??"",e}};function $d(){return{}}var cp={encode(n,e=X.default.Writer.create()){return e},decode(n,e){let t=n instanceof X.default.Reader?n:new X.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=$d();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return $d()}};function Hd(){return{isEmpty:!1}}var fp={encode(n,e=X.default.Writer.create()){return n.isEmpty===!0&&e.uint32(8).bool(n.isEmpty),e},decode(n,e){let t=n instanceof X.default.Reader?n:new X.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Hd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.isEmpty=t.bool();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{isEmpty:Ve(n.isEmpty)?Boolean(n.isEmpty):!1}},toJSON(n){let e={};return n.isEmpty!==void 0&&(e.isEmpty=n.isEmpty),e},fromPartial(n){let e=Hd();return e.isEmpty=n.isEmpty??!1,e}},vi={name:"ParcelIdentityService",fullName:"decentraland.kernel.apis.ParcelIdentityService",methods:{getParcel:{name:"GetParcel",requestType:sp,requestStream:!1,responseType:dp,responseStream:!1,options:{}},getSceneId:{name:"GetSceneId",requestType:lp,requestStream:!1,responseType:up,responseStream:!1,options:{}},getIsEmpty:{name:"GetIsEmpty",requestType:cp,requestStream:!1,responseType:fp,responseStream:!1,options:{}}}};function Ve(n){return n!=null}var Ft;(function(t){function n(r){return wi.loadService(r,vi)}t.create=n;function e(r){let i=wi.loadService(r,vi);return{...i,async getParcel(){let o=await i.getParcel({});return{land:{sceneId:o.land?.sceneId||"",sceneJsonData:JSON.parse(o.land?.sceneJsonData||"{}"),baseUrl:o.land?.baseUrl||"",baseUrlBundles:o.land?.baseUrlBundles||"",mappingsResponse:{root_cid:o.land?.mappingsResponse?.rootCid||"",parcel_id:o.land?.mappingsResponse?.parcelId||"",contents:o.land?.mappingsResponse?.contents||[]}},cid:o.cid}},async getSceneId(){return(await i.getSceneId({})).sceneId}}}t.createLegacy=e})(Ft||(Ft={}));f();var nl=C(fe());f();var Oe=C($());var he;(function(a){a[a.PI_ALLOW_TO_MOVE_PLAYER_INSIDE_SCENE=0]="PI_ALLOW_TO_MOVE_PLAYER_INSIDE_SCENE",a[a.PI_ALLOW_TO_TRIGGER_AVATAR_EMOTE=1]="PI_ALLOW_TO_TRIGGER_AVATAR_EMOTE",a[a.PI_USE_WEB3_API=2]="PI_USE_WEB3_API",a[a.PI_USE_WEBSOCKET=3]="PI_USE_WEBSOCKET",a[a.PI_USE_FETCH=4]="PI_USE_FETCH",a[a.UNRECOGNIZED=-1]="UNRECOGNIZED"})(he||(he={}));function Yd(n){switch(n){case 0:case"PI_ALLOW_TO_MOVE_PLAYER_INSIDE_SCENE":return 0;case 1:case"PI_ALLOW_TO_TRIGGER_AVATAR_EMOTE":return 1;case 2:case"PI_USE_WEB3_API":return 2;case 3:case"PI_USE_WEBSOCKET":return 3;case 4:case"PI_USE_FETCH":return 4;case-1:case"UNRECOGNIZED":default:return-1}}function Kd(n){switch(n){case 0:return"PI_ALLOW_TO_MOVE_PLAYER_INSIDE_SCENE";case 1:return"PI_ALLOW_TO_TRIGGER_AVATAR_EMOTE";case 2:return"PI_USE_WEB3_API";case 3:return"PI_USE_WEBSOCKET";case 4:return"PI_USE_FETCH";case-1:default:return"UNRECOGNIZED"}}function Xd(){return{hasPermission:!1}}var pp={encode(n,e=Oe.default.Writer.create()){return n.hasPermission===!0&&e.uint32(8).bool(n.hasPermission),e},decode(n,e){let t=n instanceof Oe.default.Reader?n:new Oe.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Xd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.hasPermission=t.bool();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{hasPermission:el(n.hasPermission)?Boolean(n.hasPermission):!1}},toJSON(n){let e={};return n.hasPermission!==void 0&&(e.hasPermission=n.hasPermission),e},fromPartial(n){let e=Xd();return e.hasPermission=n.hasPermission??!1,e}};function Qd(){return{permission:0}}var hp={encode(n,e=Oe.default.Writer.create()){return n.permission!==0&&e.uint32(8).int32(n.permission),e},decode(n,e){let t=n instanceof Oe.default.Reader?n:new Oe.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Qd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.permission=t.int32();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{permission:el(n.permission)?Yd(n.permission):0}},toJSON(n){let e={};return n.permission!==void 0&&(e.permission=Kd(n.permission)),e},fromPartial(n){let e=Qd();return e.permission=n.permission??0,e}};function Vd(){return{permissions:[]}}var yp={encode(n,e=Oe.default.Writer.create()){e.uint32(10).fork();for(let t of n.permissions)e.int32(t);return e.ldelim(),e},decode(n,e){let t=n instanceof Oe.default.Reader?n:new Oe.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Vd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:if((o&7)==2){let a=t.uint32()+t.pos;for(;t.pos<a;)i.permissions.push(t.int32())}else i.permissions.push(t.int32());break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{permissions:Array.isArray(n?.permissions)?n.permissions.map(e=>Yd(e)):[]}},toJSON(n){let e={};return n.permissions?e.permissions=n.permissions.map(t=>Kd(t)):e.permissions=[],e},fromPartial(n){let e=Vd();return e.permissions=n.permissions?.map(t=>t)||[],e}};function Zd(){return{hasManyPermission:[]}}var mp={encode(n,e=Oe.default.Writer.create()){e.uint32(10).fork();for(let t of n.hasManyPermission)e.bool(t);return e.ldelim(),e},decode(n,e){let t=n instanceof Oe.default.Reader?n:new Oe.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Zd();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:if((o&7)==2){let a=t.uint32()+t.pos;for(;t.pos<a;)i.hasManyPermission.push(t.bool())}else i.hasManyPermission.push(t.bool());break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{hasManyPermission:Array.isArray(n?.hasManyPermission)?n.hasManyPermission.map(e=>Boolean(e)):[]}},toJSON(n){let e={};return n.hasManyPermission?e.hasManyPermission=n.hasManyPermission.map(t=>t):e.hasManyPermission=[],e},fromPartial(n){let e=Zd();return e.hasManyPermission=n.hasManyPermission?.map(t=>t)||[],e}},jd={name:"PermissionsService",fullName:"decentraland.kernel.apis.PermissionsService",methods:{hasPermission:{name:"HasPermission",requestType:hp,requestStream:!1,responseType:pp,responseStream:!1,options:{}},hasManyPermissions:{name:"HasManyPermissions",requestType:yp,requestStream:!1,responseType:mp,responseStream:!1,options:{}}}};function el(n){return n!=null}function tl(n){return nl.loadService(n,jd)}f();var bi=C(fe());f();var ae=C($());f();var rn=C($());function rl(){return{face256:"",body:""}}var Jt={encode(n,e=rn.default.Writer.create()){return n.face256!==""&&e.uint32(10).string(n.face256),n.body!==""&&e.uint32(18).string(n.body),e},decode(n,e){let t=n instanceof rn.default.Reader?n:new rn.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=rl();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.face256=t.string();break;case 2:i.body=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{face256:Me(n.face256)?String(n.face256):"",body:Me(n.body)?String(n.body):""}},toJSON(n){let e={};return n.face256!==void 0&&(e.face256=n.face256),n.body!==void 0&&(e.body=n.body),e},fromPartial(n){let e=rl();return e.face256=n.face256??"",e.body=n.body??"",e}};function il(){return{bodyShape:"",skinColor:"",hairColor:"",eyeColor:"",wearables:[],snapshots:void 0}}var zt={encode(n,e=rn.default.Writer.create()){n.bodyShape!==""&&e.uint32(10).string(n.bodyShape),n.skinColor!==""&&e.uint32(18).string(n.skinColor),n.hairColor!==""&&e.uint32(26).string(n.hairColor),n.eyeColor!==""&&e.uint32(34).string(n.eyeColor);for(let t of n.wearables)e.uint32(42).string(t);return n.snapshots!==void 0&&Jt.encode(n.snapshots,e.uint32(50).fork()).ldelim(),e},decode(n,e){let t=n instanceof rn.default.Reader?n:new rn.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=il();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.bodyShape=t.string();break;case 2:i.skinColor=t.string();break;case 3:i.hairColor=t.string();break;case 4:i.eyeColor=t.string();break;case 5:i.wearables.push(t.string());break;case 6:i.snapshots=Jt.decode(t,t.uint32());break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{bodyShape:Me(n.bodyShape)?String(n.bodyShape):"",skinColor:Me(n.skinColor)?String(n.skinColor):"",hairColor:Me(n.hairColor)?String(n.hairColor):"",eyeColor:Me(n.eyeColor)?String(n.eyeColor):"",wearables:Array.isArray(n?.wearables)?n.wearables.map(e=>String(e)):[],snapshots:Me(n.snapshots)?Jt.fromJSON(n.snapshots):void 0}},toJSON(n){let e={};return n.bodyShape!==void 0&&(e.bodyShape=n.bodyShape),n.skinColor!==void 0&&(e.skinColor=n.skinColor),n.hairColor!==void 0&&(e.hairColor=n.hairColor),n.eyeColor!==void 0&&(e.eyeColor=n.eyeColor),n.wearables?e.wearables=n.wearables.map(t=>t):e.wearables=[],n.snapshots!==void 0&&(e.snapshots=n.snapshots?Jt.toJSON(n.snapshots):void 0),e},fromPartial(n){let e=il();return e.bodyShape=n.bodyShape??"",e.skinColor=n.skinColor??"",e.hairColor=n.hairColor??"",e.eyeColor=n.eyeColor??"",e.wearables=n.wearables?.map(t=>t)||[],e.snapshots=n.snapshots!==void 0&&n.snapshots!==null?Jt.fromPartial(n.snapshots):void 0,e}};function ol(){return{displayName:"",publicKey:void 0,hasConnectedWeb3:!1,userId:"",version:0,avatar:void 0}}var Le={encode(n,e=rn.default.Writer.create()){return n.displayName!==""&&e.uint32(10).string(n.displayName),n.publicKey!==void 0&&e.uint32(18).string(n.publicKey),n.hasConnectedWeb3===!0&&e.uint32(24).bool(n.hasConnectedWeb3),n.userId!==""&&e.uint32(34).string(n.userId),n.version!==0&&e.uint32(40).int32(n.version),n.avatar!==void 0&&zt.encode(n.avatar,e.uint32(50).fork()).ldelim(),e},decode(n,e){let t=n instanceof rn.default.Reader?n:new rn.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=ol();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.displayName=t.string();break;case 2:i.publicKey=t.string();break;case 3:i.hasConnectedWeb3=t.bool();break;case 4:i.userId=t.string();break;case 5:i.version=t.int32();break;case 6:i.avatar=zt.decode(t,t.uint32());break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{displayName:Me(n.displayName)?String(n.displayName):"",publicKey:Me(n.publicKey)?String(n.publicKey):void 0,hasConnectedWeb3:Me(n.hasConnectedWeb3)?Boolean(n.hasConnectedWeb3):!1,userId:Me(n.userId)?String(n.userId):"",version:Me(n.version)?Number(n.version):0,avatar:Me(n.avatar)?zt.fromJSON(n.avatar):void 0}},toJSON(n){let e={};return n.displayName!==void 0&&(e.displayName=n.displayName),n.publicKey!==void 0&&(e.publicKey=n.publicKey),n.hasConnectedWeb3!==void 0&&(e.hasConnectedWeb3=n.hasConnectedWeb3),n.userId!==void 0&&(e.userId=n.userId),n.version!==void 0&&(e.version=Math.round(n.version)),n.avatar!==void 0&&(e.avatar=n.avatar?zt.toJSON(n.avatar):void 0),e},fromPartial(n){let e=ol();return e.displayName=n.displayName??"",e.publicKey=n.publicKey??void 0,e.hasConnectedWeb3=n.hasConnectedWeb3??!1,e.userId=n.userId??"",e.version=n.version??0,e.avatar=n.avatar!==void 0&&n.avatar!==null?zt.fromPartial(n.avatar):void 0,e}};function Me(n){return n!=null}function al(){return{userId:""}}var Lt={encode(n,e=ae.default.Writer.create()){return n.userId!==""&&e.uint32(10).string(n.userId),e},decode(n,e){let t=n instanceof ae.default.Reader?n:new ae.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=al();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.userId=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{userId:Bi(n.userId)?String(n.userId):""}},toJSON(n){let e={};return n.userId!==void 0&&(e.userId=n.userId),e},fromPartial(n){let e=al();return e.userId=n.userId??"",e}};function sl(){return{data:void 0}}var Rp={encode(n,e=ae.default.Writer.create()){return n.data!==void 0&&Le.encode(n.data,e.uint32(10).fork()).ldelim(),e},decode(n,e){let t=n instanceof ae.default.Reader?n:new ae.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=sl();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.data=Le.decode(t,t.uint32());break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{data:Bi(n.data)?Le.fromJSON(n.data):void 0}},toJSON(n){let e={};return n.data!==void 0&&(e.data=n.data?Le.toJSON(n.data):void 0),e},fromPartial(n){let e=sl();return e.data=n.data!==void 0&&n.data!==null?Le.fromPartial(n.data):void 0,e}};function dl(){return{players:[]}}var ll={encode(n,e=ae.default.Writer.create()){for(let t of n.players)Lt.encode(t,e.uint32(10).fork()).ldelim();return e},decode(n,e){let t=n instanceof ae.default.Reader?n:new ae.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=dl();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.players.push(Lt.decode(t,t.uint32()));break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{players:Array.isArray(n?.players)?n.players.map(e=>Lt.fromJSON(e)):[]}},toJSON(n){let e={};return n.players?e.players=n.players.map(t=>t?Lt.toJSON(t):void 0):e.players=[],e},fromPartial(n){let e=dl();return e.players=n.players?.map(t=>Lt.fromPartial(t))||[],e}};function ul(){return{userId:""}}var Pp={encode(n,e=ae.default.Writer.create()){return n.userId!==""&&e.uint32(10).string(n.userId),e},decode(n,e){let t=n instanceof ae.default.Reader?n:new ae.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=ul();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.userId=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{userId:Bi(n.userId)?String(n.userId):""}},toJSON(n){let e={};return n.userId!==void 0&&(e.userId=n.userId),e},fromPartial(n){let e=ul();return e.userId=n.userId??"",e}};function cl(){return{}}var gp={encode(n,e=ae.default.Writer.create()){return e},decode(n,e){let t=n instanceof ae.default.Reader?n:new ae.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=cl();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return cl()}};function fl(){return{}}var Sp={encode(n,e=ae.default.Writer.create()){return e},decode(n,e){let t=n instanceof ae.default.Reader?n:new ae.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=fl();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return fl()}},Ci={name:"PlayersService",fullName:"decentraland.kernel.apis.PlayersService",methods:{getPlayerData:{name:"GetPlayerData",requestType:Pp,requestStream:!1,responseType:Rp,responseStream:!1,options:{}},getPlayersInScene:{name:"GetPlayersInScene",requestType:gp,requestStream:!1,responseType:ll,responseStream:!1,options:{}},getConnectedPlayers:{name:"GetConnectedPlayers",requestType:Sp,requestStream:!1,responseType:ll,responseStream:!1,options:{}}}};function Bi(n){return n!=null}var Gt;(function(t){function n(r){return bi.loadService(r,Ci)}t.create=n;function e(r){let i=bi.loadService(r,Ci);return{...i,async getPlayerData(o){let a=await i.getPlayerData({userId:o.userId});return a.data?{...a.data,avatar:{...a.data.avatar,snapshots:a.data.avatar.snapshots},publicKey:a.data.publicKey||null}:null},async getConnectedPlayers(){return(await i.getConnectedPlayers({})).players},async getPlayersInScene(){return(await i.getPlayersInScene({})).players}}}t.createLegacy=e})(Gt||(Gt={}));f();var Ni=C(fe());f();var Q=C($());function pl(){return{pid:""}}var xp={encode(n,e=Q.default.Writer.create()){return n.pid!==""&&e.uint32(10).string(n.pid),e},decode(n,e){let t=n instanceof Q.default.Reader?n:new Q.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=pl();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.pid=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{pid:Xn(n.pid)?String(n.pid):""}},toJSON(n){let e={};return n.pid!==void 0&&(e.pid=n.pid),e},fromPartial(n){let e=pl();return e.pid=n.pid??"",e}};function hl(){return{status:!1}}var Tp={encode(n,e=Q.default.Writer.create()){return n.status===!0&&e.uint32(8).bool(n.status),e},decode(n,e){let t=n instanceof Q.default.Reader?n:new Q.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=hl();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.status=t.bool();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{status:Xn(n.status)?Boolean(n.status):!1}},toJSON(n){let e={};return n.status!==void 0&&(e.status=n.status),e},fromPartial(n){let e=hl();return e.status=n.status??!1,e}};function yl(){return{pid:""}}var Ip={encode(n,e=Q.default.Writer.create()){return n.pid!==""&&e.uint32(10).string(n.pid),e},decode(n,e){let t=n instanceof Q.default.Reader?n:new Q.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=yl();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.pid=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{pid:Xn(n.pid)?String(n.pid):""}},toJSON(n){let e={};return n.pid!==void 0&&(e.pid=n.pid),e},fromPartial(n){let e=yl();return e.pid=n.pid??"",e}};function ml(){return{pid:"",parentCid:""}}var Kn={encode(n,e=Q.default.Writer.create()){return n.pid!==""&&e.uint32(10).string(n.pid),n.parentCid!==""&&e.uint32(18).string(n.parentCid),e},decode(n,e){let t=n instanceof Q.default.Reader?n:new Q.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=ml();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.pid=t.string();break;case 2:i.parentCid=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{pid:Xn(n.pid)?String(n.pid):"",parentCid:Xn(n.parentCid)?String(n.parentCid):""}},toJSON(n){let e={};return n.pid!==void 0&&(e.pid=n.pid),n.parentCid!==void 0&&(e.parentCid=n.parentCid),e},fromPartial(n){let e=ml();return e.pid=n.pid??"",e.parentCid=n.parentCid??"",e}};function Rl(){return{}}var Ep={encode(n,e=Q.default.Writer.create()){return e},decode(n,e){let t=n instanceof Q.default.Reader?n:new Q.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Rl();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return Rl()}};function Pl(){return{loaded:[]}}var kp={encode(n,e=Q.default.Writer.create()){for(let t of n.loaded)Kn.encode(t,e.uint32(10).fork()).ldelim();return e},decode(n,e){let t=n instanceof Q.default.Reader?n:new Q.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Pl();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.loaded.push(Kn.decode(t,t.uint32()));break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{loaded:Array.isArray(n?.loaded)?n.loaded.map(e=>Kn.fromJSON(e)):[]}},toJSON(n){let e={};return n.loaded?e.loaded=n.loaded.map(t=>t?Kn.toJSON(t):void 0):e.loaded=[],e},fromPartial(n){let e=Pl();return e.loaded=n.loaded?.map(t=>Kn.fromPartial(t))||[],e}};function gl(){return{}}var _p={encode(n,e=Q.default.Writer.create()){return e},decode(n,e){let t=n instanceof Q.default.Reader?n:new Q.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=gl();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return gl()}};function Sl(){return{status:!1}}var vp={encode(n,e=Q.default.Writer.create()){return n.status===!0&&e.uint32(8).bool(n.status),e},decode(n,e){let t=n instanceof Q.default.Reader?n:new Q.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Sl();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.status=t.bool();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{status:Xn(n.status)?Boolean(n.status):!1}},toJSON(n){let e={};return n.status!==void 0&&(e.status=n.status),e},fromPartial(n){let e=Sl();return e.status=n.status??!1,e}},Ai={name:"PortableExperiencesService",fullName:"decentraland.kernel.apis.PortableExperiencesService",methods:{spawn:{name:"Spawn",requestType:Ip,requestStream:!1,responseType:Kn,responseStream:!1,options:{}},kill:{name:"Kill",requestType:xp,requestStream:!1,responseType:Tp,responseStream:!1,options:{}},exit:{name:"Exit",requestType:_p,requestStream:!1,responseType:vp,responseStream:!1,options:{}},getPortableExperiencesLoaded:{name:"GetPortableExperiencesLoaded",requestType:Ep,requestStream:!1,responseType:kp,responseStream:!1,options:{}}}};function Xn(n){return n!=null}var $t;(function(t){function n(r){return Ni.loadService(r,Ai)}t.create=n;function e(r){let i=Ni.loadService(r,Ai);return{...i,async spawn(o){return await i.spawn({pid:o})},async kill(o){return(await i.kill({pid:o})).status},async exit(){return(await i.exit({})).status},async getPortableExperiencesLoaded(){return{portableExperiences:(await i.getPortableExperiencesLoaded({})).loaded}}}}t.createLegacy=e})($t||($t={}));f();var Mi=C(fe());f();var ye=C($());function xl(){return{x:0,y:0,z:0}}var on={encode(n,e=ye.default.Writer.create()){return n.x!==0&&e.uint32(13).float(n.x),n.y!==0&&e.uint32(21).float(n.y),n.z!==0&&e.uint32(29).float(n.z),e},decode(n,e){let t=n instanceof ye.default.Reader?n:new ye.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=xl();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.x=t.float();break;case 2:i.y=t.float();break;case 3:i.z=t.float();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{x:Qn(n.x)?Number(n.x):0,y:Qn(n.y)?Number(n.y):0,z:Qn(n.z)?Number(n.z):0}},toJSON(n){let e={};return n.x!==void 0&&(e.x=n.x),n.y!==void 0&&(e.y=n.y),n.z!==void 0&&(e.z=n.z),e},fromPartial(n){let e=xl();return e.x=n.x??0,e.y=n.y??0,e.z=n.z??0,e}};function Tl(){return{}}var wp={encode(n,e=ye.default.Writer.create()){return e},decode(n,e){let t=n instanceof ye.default.Reader?n:new ye.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Tl();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return Tl()}};function Il(){return{newRelativePosition:void 0,cameraTarget:void 0}}var Cp={encode(n,e=ye.default.Writer.create()){return n.newRelativePosition!==void 0&&on.encode(n.newRelativePosition,e.uint32(10).fork()).ldelim(),n.cameraTarget!==void 0&&on.encode(n.cameraTarget,e.uint32(18).fork()).ldelim(),e},decode(n,e){let t=n instanceof ye.default.Reader?n:new ye.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Il();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.newRelativePosition=on.decode(t,t.uint32());break;case 2:i.cameraTarget=on.decode(t,t.uint32());break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{newRelativePosition:Qn(n.newRelativePosition)?on.fromJSON(n.newRelativePosition):void 0,cameraTarget:Qn(n.cameraTarget)?on.fromJSON(n.cameraTarget):void 0}},toJSON(n){let e={};return n.newRelativePosition!==void 0&&(e.newRelativePosition=n.newRelativePosition?on.toJSON(n.newRelativePosition):void 0),n.cameraTarget!==void 0&&(e.cameraTarget=n.cameraTarget?on.toJSON(n.cameraTarget):void 0),e},fromPartial(n){let e=Il();return e.newRelativePosition=n.newRelativePosition!==void 0&&n.newRelativePosition!==null?on.fromPartial(n.newRelativePosition):void 0,e.cameraTarget=n.cameraTarget!==void 0&&n.cameraTarget!==null?on.fromPartial(n.cameraTarget):void 0,e}};function El(){return{}}var Bp={encode(n,e=ye.default.Writer.create()){return e},decode(n,e){let t=n instanceof ye.default.Reader?n:new ye.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=El();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return El()}};function kl(){return{predefinedEmote:""}}var bp={encode(n,e=ye.default.Writer.create()){return n.predefinedEmote!==""&&e.uint32(10).string(n.predefinedEmote),e},decode(n,e){let t=n instanceof ye.default.Reader?n:new ye.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=kl();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.predefinedEmote=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{predefinedEmote:Qn(n.predefinedEmote)?String(n.predefinedEmote):""}},toJSON(n){let e={};return n.predefinedEmote!==void 0&&(e.predefinedEmote=n.predefinedEmote),e},fromPartial(n){let e=kl();return e.predefinedEmote=n.predefinedEmote??"",e}},Oi={name:"RestrictedActionsService",fullName:"decentraland.kernel.apis.RestrictedActionsService",methods:{movePlayerTo:{name:"MovePlayerTo",requestType:Cp,requestStream:!1,responseType:wp,responseStream:!1,options:{}},triggerEmote:{name:"TriggerEmote",requestType:bp,requestStream:!1,responseType:Bp,responseStream:!1,options:{}}}};function Qn(n){return n!=null}var Vn;(function(t){function n(r){return Mi.loadService(r,Oi)}t.create=n;function e(r){let i=Mi.loadService(r,Oi);return{...i,async movePlayerTo(o,a){await i.movePlayerTo({newRelativePosition:o,cameraTarget:a||void 0})},async triggerEmote(o){await i.triggerEmote({predefinedEmote:o.predefined})}}}t.createLegacy=e})(Vn||(Vn={}));f();var Di=C(fe());f();var me=C($());function _l(){return{method:void 0,body:void 0,headers:{}}}var Ht={encode(n,e=me.default.Writer.create()){return n.method!==void 0&&e.uint32(10).string(n.method),n.body!==void 0&&e.uint32(18).string(n.body),Object.entries(n.headers).forEach(([t,r])=>{wl.encode({key:t,value:r},e.uint32(26).fork()).ldelim()}),e},decode(n,e){let t=n instanceof me.default.Reader?n:new me.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=_l();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.method=t.string();break;case 2:i.body=t.string();break;case 3:let a=wl.decode(t,t.uint32());a.value!==void 0&&(i.headers[a.key]=a.value);break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{method:Ge(n.method)?String(n.method):void 0,body:Ge(n.body)?String(n.body):void 0,headers:Nl(n.headers)?Object.entries(n.headers).reduce((e,[t,r])=>(e[t]=String(r),e),{}):{}}},toJSON(n){let e={};return n.method!==void 0&&(e.method=n.method),n.body!==void 0&&(e.body=n.body),e.headers={},n.headers&&Object.entries(n.headers).forEach(([t,r])=>{e.headers[t]=r}),e},fromPartial(n){let e=_l();return e.method=n.method??void 0,e.body=n.body??void 0,e.headers=Object.entries(n.headers??{}).reduce((t,[r,i])=>(i!==void 0&&(t[r]=String(i)),t),{}),e}};function vl(){return{key:"",value:""}}var wl={encode(n,e=me.default.Writer.create()){return n.key!==""&&e.uint32(10).string(n.key),n.value!==""&&e.uint32(18).string(n.value),e},decode(n,e){let t=n instanceof me.default.Reader?n:new me.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=vl();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.key=t.string();break;case 2:i.value=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{key:Ge(n.key)?String(n.key):"",value:Ge(n.value)?String(n.value):""}},toJSON(n){let e={};return n.key!==void 0&&(e.key=n.key),n.value!==void 0&&(e.value=n.value),e},fromPartial(n){let e=vl();return e.key=n.key??"",e.value=n.value??"",e}};function Cl(){return{ok:!1,status:0,statusText:"",headers:{},body:""}}var Ap={encode(n,e=me.default.Writer.create()){return n.ok===!0&&e.uint32(8).bool(n.ok),n.status!==0&&e.uint32(16).int32(n.status),n.statusText!==""&&e.uint32(26).string(n.statusText),Object.entries(n.headers).forEach(([t,r])=>{bl.encode({key:t,value:r},e.uint32(34).fork()).ldelim()}),n.body!==""&&e.uint32(42).string(n.body),e},decode(n,e){let t=n instanceof me.default.Reader?n:new me.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Cl();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.ok=t.bool();break;case 2:i.status=t.int32();break;case 3:i.statusText=t.string();break;case 4:let a=bl.decode(t,t.uint32());a.value!==void 0&&(i.headers[a.key]=a.value);break;case 5:i.body=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{ok:Ge(n.ok)?Boolean(n.ok):!1,status:Ge(n.status)?Number(n.status):0,statusText:Ge(n.statusText)?String(n.statusText):"",headers:Nl(n.headers)?Object.entries(n.headers).reduce((e,[t,r])=>(e[t]=String(r),e),{}):{},body:Ge(n.body)?String(n.body):""}},toJSON(n){let e={};return n.ok!==void 0&&(e.ok=n.ok),n.status!==void 0&&(e.status=Math.round(n.status)),n.statusText!==void 0&&(e.statusText=n.statusText),e.headers={},n.headers&&Object.entries(n.headers).forEach(([t,r])=>{e.headers[t]=r}),n.body!==void 0&&(e.body=n.body),e},fromPartial(n){let e=Cl();return e.ok=n.ok??!1,e.status=n.status??0,e.statusText=n.statusText??"",e.headers=Object.entries(n.headers??{}).reduce((t,[r,i])=>(i!==void 0&&(t[r]=String(i)),t),{}),e.body=n.body??"",e}};function Bl(){return{key:"",value:""}}var bl={encode(n,e=me.default.Writer.create()){return n.key!==""&&e.uint32(10).string(n.key),n.value!==""&&e.uint32(18).string(n.value),e},decode(n,e){let t=n instanceof me.default.Reader?n:new me.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Bl();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.key=t.string();break;case 2:i.value=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{key:Ge(n.key)?String(n.key):"",value:Ge(n.value)?String(n.value):""}},toJSON(n){let e={};return n.key!==void 0&&(e.key=n.key),n.value!==void 0&&(e.value=n.value),e},fromPartial(n){let e=Bl();return e.key=n.key??"",e.value=n.value??"",e}};function Al(){return{url:"",init:void 0}}var Np={encode(n,e=me.default.Writer.create()){return n.url!==""&&e.uint32(10).string(n.url),n.init!==void 0&&Ht.encode(n.init,e.uint32(18).fork()).ldelim(),e},decode(n,e){let t=n instanceof me.default.Reader?n:new me.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Al();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.url=t.string();break;case 2:i.init=Ht.decode(t,t.uint32());break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{url:Ge(n.url)?String(n.url):"",init:Ge(n.init)?Ht.fromJSON(n.init):void 0}},toJSON(n){let e={};return n.url!==void 0&&(e.url=n.url),n.init!==void 0&&(e.init=n.init?Ht.toJSON(n.init):void 0),e},fromPartial(n){let e=Al();return e.url=n.url??"",e.init=n.init!==void 0&&n.init!==null?Ht.fromPartial(n.init):void 0,e}},Ui={name:"SignedFetchService",fullName:"decentraland.kernel.apis.SignedFetchService",methods:{signedFetch:{name:"SignedFetch",requestType:Np,requestStream:!1,responseType:Ap,responseStream:!1,options:{}}}};function Nl(n){return typeof n=="object"&&n!==null}function Ge(n){return n!=null}var Yt;(function(t){function n(r){return Di.loadService(r,Ui)}t.create=n;function e(r){let i=Di.loadService(r,Ui);return{...i,async signedFetch(o,a){let d;a&&(d={headers:{}},a.headers&&typeof a.headers=="object"&&(d.headers=a.headers),a.body&&typeof a.body=="string"&&(d.body=a.body),a.method&&typeof a.method=="string"&&(d.method=a.method));let s=a?.responseBodyType||"text",l=await i.signedFetch({url:o,init:d});return{ok:l.ok,status:l.status,statusText:l.statusText,headers:l.headers,json:s==="json"?JSON.parse(l.body):void 0,text:s==="text"?l.body:void 0}}}}t.createLegacy=e})(Yt||(Yt={}));f();var ql=C(fe());f();var an=C($());function Ol(){return{}}var Op={encode(n,e=an.default.Writer.create()){return e},decode(n,e){let t=n instanceof an.default.Reader?n:new an.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Ol();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return Ol()}};function Ml(){return{event:"",payload:""}}var Kt={encode(n,e=an.default.Writer.create()){return n.event!==""&&e.uint32(10).string(n.event),n.payload!==""&&e.uint32(18).string(n.payload),e},decode(n,e){let t=n instanceof an.default.Reader?n:new an.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Ml();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.event=t.string();break;case 2:i.payload=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{event:Wl(n.event)?String(n.event):"",payload:Wl(n.payload)?String(n.payload):""}},toJSON(n){let e={};return n.event!==void 0&&(e.event=n.event),n.payload!==void 0&&(e.payload=n.payload),e},fromPartial(n){let e=Ml();return e.event=n.event??"",e.payload=n.payload??"",e}};function Ul(){return{events:[]}}var Mp={encode(n,e=an.default.Writer.create()){for(let t of n.events)Kt.encode(t,e.uint32(10).fork()).ldelim();return e},decode(n,e){let t=n instanceof an.default.Reader?n:new an.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Ul();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.events.push(Kt.decode(t,t.uint32()));break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{events:Array.isArray(n?.events)?n.events.map(e=>Kt.fromJSON(e)):[]}},toJSON(n){let e={};return n.events?e.events=n.events.map(t=>t?Kt.toJSON(t):void 0):e.events=[],e},fromPartial(n){let e=Ul();return e.events=n.events?.map(t=>Kt.fromPartial(t))||[],e}},Dl={name:"SocialControllerService",fullName:"decentraland.kernel.apis.SocialControllerService",methods:{pullAvatarEvents:{name:"PullAvatarEvents",requestType:Op,requestStream:!1,responseType:Mp,responseStream:!1,options:{}}}};function Wl(n){return n!=null}function Fl(n){return ql.loadService(n,Dl)}f();var qi=C(fe());f();var qn=C($());function Jl(){return{destination:""}}var Up={encode(n,e=qn.default.Writer.create()){return n.destination!==""&&e.uint32(10).string(n.destination),e},decode(n,e){let t=n instanceof qn.default.Reader?n:new qn.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Jl();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.destination=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{destination:Wp(n.destination)?String(n.destination):""}},toJSON(n){let e={};return n.destination!==void 0&&(e.destination=n.destination),e},fromPartial(n){let e=Jl();return e.destination=n.destination??"",e}};function zl(){return{}}var Dp={encode(n,e=qn.default.Writer.create()){return e},decode(n,e){let t=n instanceof qn.default.Reader?n:new qn.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=zl();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return zl()}},Wi={name:"UserActionModuleService",fullName:"decentraland.kernel.apis.UserActionModuleService",methods:{requestTeleport:{name:"RequestTeleport",requestType:Up,requestStream:!1,responseType:Dp,responseStream:!1,options:{}}}};function Wp(n){return n!=null}var Xt;(function(t){function n(r){return qi.loadService(r,Wi)}t.create=n;function e(r){let i=qi.loadService(r,Wi);return{...i,async requestTeleport(o){await i.requestTeleport({destination:o})}}}t.createLegacy=e})(Xt||(Xt={}));f();var Ji=C(fe());f();var Ue=C($());function Ll(){return{}}var qp={encode(n,e=Ue.default.Writer.create()){return e},decode(n,e){let t=n instanceof Ue.default.Reader?n:new Ue.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Ll();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return Ll()}};function Gl(){return{data:void 0}}var Fp={encode(n,e=Ue.default.Writer.create()){return n.data!==void 0&&Le.encode(n.data,e.uint32(10).fork()).ldelim(),e},decode(n,e){let t=n instanceof Ue.default.Reader?n:new Ue.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Gl();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.data=Le.decode(t,t.uint32());break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{data:Yl(n.data)?Le.fromJSON(n.data):void 0}},toJSON(n){let e={};return n.data!==void 0&&(e.data=n.data?Le.toJSON(n.data):void 0),e},fromPartial(n){let e=Gl();return e.data=n.data!==void 0&&n.data!==null?Le.fromPartial(n.data):void 0,e}};function $l(){return{}}var Jp={encode(n,e=Ue.default.Writer.create()){return e},decode(n,e){let t=n instanceof Ue.default.Reader?n:new Ue.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=$l();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){default:t.skipType(o&7);break}}return i},fromJSON(n){return{}},toJSON(n){return{}},fromPartial(n){return $l()}};function Hl(){return{address:void 0}}var zp={encode(n,e=Ue.default.Writer.create()){return n.address!==void 0&&e.uint32(10).string(n.address),e},decode(n,e){let t=n instanceof Ue.default.Reader?n:new Ue.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=Hl();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.address=t.string();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{address:Yl(n.address)?String(n.address):void 0}},toJSON(n){let e={};return n.address!==void 0&&(e.address=n.address),e},fromPartial(n){let e=Hl();return e.address=n.address??void 0,e}},Fi={name:"UserIdentityService",fullName:"decentraland.kernel.apis.UserIdentityService",methods:{getUserPublicKey:{name:"GetUserPublicKey",requestType:Jp,requestStream:!1,responseType:zp,responseStream:!1,options:{}},getUserData:{name:"GetUserData",requestType:qp,requestStream:!1,responseType:Fp,responseStream:!1,options:{}}}};function Yl(n){return n!=null}var Qt;(function(t){function n(r){return Ji.loadService(r,Fi)}t.create=n;function e(r){let i=Ji.loadService(r,Fi);return{...i,async getUserPublicKey(){return(await i.getUserPublicKey({})).address||null},async getUserData(){let o=await i.getUserData({});return o.data?{...o.data,avatar:{...o.data.avatar,snapshots:o.data.avatar.snapshots},publicKey:o.data.publicKey||null}:null}}}t.createLegacy=e})(Qt||(Qt={}));f();var Kl=C(fe());function Xl(n){let e=Kl.loadService(n,Ut);async function t(r){let i=await e.sendAsync({id:r.id,method:r.method,jsonParams:JSON.stringify(r.params)});return JSON.parse(i.jsonAnyResponse)}return{async getProvider(){return{send(r,i){if(r&&i&&i instanceof Function)t(r).then(o=>i(null,o)).catch(i);else throw new Error("Decentraland provider only allows async calls")},sendAsync(r,i){t(r).then(o=>i(null,o)).catch(i)}}}}}var vn={DevTools:Rs,EngineApi:Ys,ExperimentalApi:Wd,Permissions:tl,SignedFetch:Yt.create,CommunicationsController:ft.create,EnvironmentApi:Mt.create,EthereumController:Dt.create,ParcelIdentity:Ft.create,Players:Gt.create,PortableExperience:$t.create,RestrictedActions:Vn.create,UserActionModule:Xt.create,UserIdentity:Qt.create,LegacySignedFetch:Yt.createLegacy,LegacyCommunicationsController:ft.createLegacy,LegacyEnvironmentAPI:Mt.createLegacy,LegacyEthereumController:Dt.createLegacy,LegacyParcelIdentity:Ft.createLegacy,LegacyPlayers:Gt.createLegacy,LegacyPortableExperience:$t.createLegacy,LegacyRestrictedActions:Vn.createLegacy,LegacyRestrictedActionModule:Vn.createLegacy,LegacyUserActionModule:Xt.createLegacy,LegacyIdentity:Qt.createLegacy,["Legacyweb3-provider"]:Xl,LegacySocialController:Fl};f();var at=C(Lr());f();var ro=C(Iu()),We=C($());f();var sh=C($());var Eu;(function(r){r[r.VERTICAL=0]="VERTICAL",r[r.HORIZONTAL=1]="HORIZONTAL",r[r.UNRECOGNIZED=-1]="UNRECOGNIZED"})(Eu||(Eu={}));function ku(){return{x:0,y:0,z:0}}var un={encode(n,e=We.default.Writer.create()){return n.x!==0&&e.uint32(13).float(n.x),n.y!==0&&e.uint32(21).float(n.y),n.z!==0&&e.uint32(29).float(n.z),e},decode(n,e){let t=n instanceof We.default.Reader?n:new We.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=ku();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.x=t.float();break;case 2:i.y=t.float();break;case 3:i.z=t.float();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{x:cn(n.x)?Number(n.x):0,y:cn(n.y)?Number(n.y):0,z:cn(n.z)?Number(n.z):0}},toJSON(n){let e={};return n.x!==void 0&&(e.x=n.x),n.y!==void 0&&(e.y=n.y),n.z!==void 0&&(e.z=n.z),e},fromPartial(n){let e=ku();return e.x=n.x??0,e.y=n.y??0,e.z=n.z??0,e}};function _u(){return{x:0,y:0,z:0,w:0}}var er={encode(n,e=We.default.Writer.create()){return n.x!==0&&e.uint32(9).double(n.x),n.y!==0&&e.uint32(17).double(n.y),n.z!==0&&e.uint32(25).double(n.z),n.w!==0&&e.uint32(33).double(n.w),e},decode(n,e){let t=n instanceof We.default.Reader?n:new We.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=_u();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.x=t.double();break;case 2:i.y=t.double();break;case 3:i.z=t.double();break;case 4:i.w=t.double();break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{x:cn(n.x)?Number(n.x):0,y:cn(n.y)?Number(n.y):0,z:cn(n.z)?Number(n.z):0,w:cn(n.w)?Number(n.w):0}},toJSON(n){let e={};return n.x!==void 0&&(e.x=n.x),n.y!==void 0&&(e.y=n.y),n.z!==void 0&&(e.z=n.z),n.w!==void 0&&(e.w=n.w),e},fromPartial(n){let e=_u();return e.x=n.x??0,e.y=n.y??0,e.z=n.z??0,e.w=n.w??0,e}};function vu(){return{position:void 0,rotation:void 0,scale:void 0}}var wu={encode(n,e=We.default.Writer.create()){return n.position!==void 0&&un.encode(n.position,e.uint32(10).fork()).ldelim(),n.rotation!==void 0&&er.encode(n.rotation,e.uint32(18).fork()).ldelim(),n.scale!==void 0&&un.encode(n.scale,e.uint32(26).fork()).ldelim(),e},decode(n,e){let t=n instanceof We.default.Reader?n:new We.default.Reader(n),r=e===void 0?t.len:t.pos+e,i=vu();for(;t.pos<r;){let o=t.uint32();switch(o>>>3){case 1:i.position=un.decode(t,t.uint32());break;case 2:i.rotation=er.decode(t,t.uint32());break;case 3:i.scale=un.decode(t,t.uint32());break;default:t.skipType(o&7);break}}return i},fromJSON(n){return{position:cn(n.position)?un.fromJSON(n.position):void 0,rotation:cn(n.rotation)?er.fromJSON(n.rotation):void 0,scale:cn(n.scale)?un.fromJSON(n.scale):void 0}},toJSON(n){let e={};return n.position!==void 0&&(e.position=n.position?un.toJSON(n.position):void 0),n.rotation!==void 0&&(e.rotation=n.rotation?er.toJSON(n.rotation):void 0),n.scale!==void 0&&(e.scale=n.scale?un.toJSON(n.scale):void 0),e},fromPartial(n){let e=vu();return e.position=n.position!==void 0&&n.position!==null?un.fromPartial(n.position):void 0,e.rotation=n.rotation!==void 0&&n.rotation!==null?er.fromPartial(n.rotation):void 0,e.scale=n.scale!==void 0&&n.scale!==null?un.fromPartial(n.scale):void 0,e}};var Cu=(()=>{if(typeof Cu!="undefined")return Cu;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw"Unable to locate global object"})();We.default.util.Long!==ro.default&&(We.default.util.Long=ro.default,We.default.configure());function cn(n){return n!=null}var $r=1e6,st={position:at.Vector3.Zero(),rotation:at.Quaternion.Identity,scale:at.Vector3.One()},dh=1,Bu=new ArrayBuffer(40),fn=new DataView(Bu),io={useBinaryTransform:!0};function bu(n,e){if(n===dh){let t=JSON.parse(e);return io.useBinaryTransform?uh(t):lh(t)}return e}function lh(n){st.position.set(Math.fround(n.position.x),Math.fround(n.position.y),Math.fround(n.position.z)),Hr(st.position,$r),st.rotation.copyFrom(n.rotation),st.scale.set(Math.fround(n.scale.x),Math.fround(n.scale.y),Math.fround(n.scale.z)),Hr(st.scale,$r);let e=wu.encode(st).finish();return btoa(String.fromCharCode(...e))}function uh(n){let e=new at.Vector3(Math.fround(n.position.x),Math.fround(n.position.y),Math.fround(n.position.z));Hr(e,$r);let t=0;fn.setFloat32(t,e.x,!0),fn.setFloat32(t+=4,e.y,!0),fn.setFloat32(t+=4,e.z,!0),fn.setFloat32(t+=4,n.rotation.x,!0),fn.setFloat32(t+=4,n.rotation.y,!0),fn.setFloat32(t+=4,n.rotation.z,!0),fn.setFloat32(t+=4,n.rotation.w,!0),e.set(Math.fround(n.scale.x),Math.fround(n.scale.y),Math.fround(n.scale.z)),Hr(e,$r),fn.setFloat32(t+=4,e.x,!0),fn.setFloat32(t+=4,e.y,!0),fn.setFloat32(t+=4,e.z,!0);let r=new Uint8Array(Bu);return btoa(String.fromCharCode(...r))}function Hr(n,e){Math.abs(n.x)>e&&(n.x=e*Math.sign(n.x)),Math.abs(n.y)>e&&(n.y=e*Math.sign(n.y)),Math.abs(n.z)>e&&(n.z=e*Math.sign(n.z))}var ch=/^data:[^/]+\/[^;]+;base64,/,fh=/^blob:http/,gn=/^(engine\.)/;function Au(n,e,t){let r=e;return n&&(r=n),ch.test(r)||fh.test(r)?r:(t.endsWith("/")?t:t+"/")+r}var oo={},Yr={},ao=10;function ph(n,e){oo[n]=e,Yr[e]=n}function Nu(n){return oo.hasOwnProperty(n)?oo[n]:(ao++,ph(n,ao),ao)}function nr(){return{type:v.EAT_INIT_MESSAGES_FINISHED,tag:"scene",payload:{initMessagesFinished:{}}}}f();f();var Hu=C($u()),Th=29e3;function Yu({canUseFetch:n,previewMode:e,log:t,originalFetch:r}){let i=new Hu.default({concurrency:1});return async(o,a)=>{let d=o instanceof Request?o.url:o;if(d.toLowerCase().substr(0,8)!=="https://")if(e)t("\u26A0\uFE0F Warning: Can't make an unsafe http request in deployed scenes, please consider upgrading to https. url="+d);else return Promise.reject(new Error("Can't make an unsafe http request, please upgrade to https. url="+d));if(!n)return Promise.reject(new Error("This scene is not allowed to use fetch."));async function s(){let l=new AbortController,u=setTimeout(()=>{l.abort()},Math.max(a?.timeout||Th,1));try{return await r(o,{signal:l.signal,...a})}finally{clearTimeout(u)}}return i.add(s)}}f();function Ku({canUseWebsocket:n,previewMode:e,log:t}){return class extends WebSocket{constructor(i,o){if(i.toString().toLowerCase().substr(0,4)!=="wss:")if(e)t("\u26A0\uFE0F Warning: can't connect to unsafe WebSocket (ws) server in deployed scenes, consider upgrading to wss.");else throw new Error("Can't connect to unsafe WebSocket server");if(!n)throw new Error("This scene doesn't have allowed to use WebSocket");super(i.toString(),o)}}}var Ih=["eval","parseInt","parseFloat","isNaN","isFinite","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape","Object","Function","String","Boolean","Number","Math","Date","RegExp","Error","EvalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError","JSON","Array","Promise","NaN","Infinity"],Eh=Promise.resolve().then.bind(Promise.resolve());async function Xu(n,e){let t={},r="SAFE_EVAL_"+Math.floor(Math.random()*1e6);return t[r]={},Object.keys(e).forEach(function(i){t[i]=e[i]}),t.window=t,t.self=t,Eh(()=>new Function("code",`with (this) { ${n} }`).call(t,n))}function kh(n){return Ih.forEach(e=>n[e]=globalThis[e]),n}function Qu(n){let e=globalThis.fetch,t=Ku(n),r=Yu({...n,originalFetch:e});globalThis.fetch=r,globalThis.WebSocket=t;let i={dcl:n.dcl,WebSocket:t,fetch:r};return kh(i)}f();function Vu(n){let{batchEvents:e,onError:t,onLog:r,sceneId:i,onEventFunctions:o,clientPort:a,eventState:d}=n,s={};return{DEBUG:!0,log(...u){r(...u)},openExternalUrl(u){try{if(new URL(u).protocol!=="https:")throw new Error("Only https: external links are allowed")}catch(c){t(c);return}if(JSON.stringify(u).length>49e3){t(new Error("URL payload cannot exceed 49.000 bytes"));return}d.allowOpenExternalUrl?e.events.push({type:v.EAT_OPEN_EXTERNAL_URL,tag:"",payload:{openExternalUrl:{url:u}}}):this.error("openExternalUrl can only be used inside a pointerEvent")},openNFTDialog(u,c,h){if(d.allowOpenExternalUrl){if(u.length+c.length+(h?.length||0)>49e3){t(new Error("OpenNFT payload cannot exceed 49.000 bytes"));return}e.events.push({type:v.EAT_OPEN_NFT_DIALOG,tag:"",payload:{openNftDialog:{assetContractAddress:u,tokenId:c,comment:h||""}}})}else this.error("openNFTDialog can only be used inside a pointerEvent")},addEntity(u){u!=="0"&&e.events.push({type:v.EAT_CREATE_ENTITY,payload:{createEntity:{id:u}}})},removeEntity(u){e.events.push({type:v.EAT_REMOVE_ENTITY,payload:{removeEntity:{id:u}}})},onUpdate(u){typeof u!="function"?t(new Error("onUpdate must be called with only a function argument")):n.onUpdateFunctions.push(u)},onEvent(u){typeof u!="function"?t(new Error("onEvent must be called with only a function argument")):o.push(u)},updateEntityComponent(u,c,h,p){if(p.length>49e3){t(new Error("Component payload cannot exceed 49.000 bytes"));return}gn.test(c)&&e.events.push({type:v.EAT_UPDATE_ENTITY_COMPONENT,tag:i+"_"+u+"_"+h,payload:{updateEntityComponent:{entityId:u,classId:h,name:c.replace(gn,""),json:bu(h,p)}}})},attachEntityComponent(u,c,h){gn.test(c)&&e.events.push({type:v.EAT_ATTACH_ENTITY_COMPONENT,tag:u,payload:{attachEntityComponent:{entityId:u,name:c.replace(gn,""),id:h}}})},removeEntityComponent(u,c){gn.test(c)&&e.events.push({type:v.EAT_COMPONENT_REMOVED,tag:u,payload:{componentRemoved:{entityId:u,name:c.replace(gn,"")}}})},setParent(u,c){e.events.push({type:v.EAT_SET_ENTITY_PARENT,tag:u,payload:{setEntityParent:{entityId:u,parentId:c}}})},query(u,c){c.queryId=Nu(c.queryId).toString(),e.events.push({type:v.EAT_QUERY,tag:i+"_"+c.queryId,payload:{query:{queryId:Ii(u),payload:JSON.stringify(c)}}})},subscribe(u){n.EngineApi.subscribe({eventId:u}).catch(c=>t(c))},unsubscribe(u){n.EngineApi.unsubscribe({eventId:u}).catch(c=>t(c))},componentCreated(u,c,h){gn.test(c)&&e.events.push({type:v.EAT_COMPONENT_CREATED,tag:u,payload:{componentCreated:{id:u,classId:h,name:c.replace(gn,"")}}})},componentDisposed(u){e.events.push({type:v.EAT_COMPONENT_DISPOSED,tag:u,payload:{componentDisposed:{id:u}}})},componentUpdated(u,c){e.events.push({type:v.EAT_COMPONENT_UPDATED,tag:u,payload:{componentUpdated:{id:u,json:c}}})},loadModule:async u=>{if(!(u in s)){let c=_h(a,u);s[u]={rpcHandle:u,__INTERNAL_UNSAFE_loadedModule:c,methods:Object.keys(c).map(h=>({name:h}))}}return s[u]},callRpc:async(u,c,h)=>{let p=s[u];if(!p)throw new Error(`RPCHandle: ${u} is not loaded`);return p.__INTERNAL_UNSAFE_loadedModule[c].apply(p,h)},onStart(u){n.onStartFunctions.push(u)},error(u,c){t(Object.assign(new Error(u),{data:c}))}}}function _h(n,e){let t=e.replace(/^@decentraland\//,"Legacy").replace(/^~system\//,"");try{if(t in vn)return vn[t](n);throw new Error("The module is not available in the list!")}catch(r){throw Object.assign(new Error(`Error getting the methods of ${t}: `+r.message),{original:r})}}f();var po=C(Lr());function Zu(n,e,t){n.subscribe("positionChanged"),n.onEvent(r=>{if(r.type!=="positionChanged")return;let i=r.data,o=16,a=new po.Vector2(Math.floor(i.cameraPosition.x/o),Math.floor(i.cameraPosition.z/o));if(a===void 0)return;let d=a,s=10*10,l=!1;for(let c of e)s=Math.min(s,po.Vector2.DistanceSquared(d,c)),c.x===d.x&&c.y===d.y&&(l=!0);let u=1;l?u=30:s<=2*2?u=20:s<=3*3?u=10:s<=4*4&&(u=5),t(1e3/u)})}f();var ho=class{constructor(e){this.devTools=e;this.exceptions=[];this.catchHandler=(...e)=>console.log(...e)}log(...e){let t={type:"log",timestamp:performance.now(),executionContextId:0,args:e.map(r=>{let i,o,a=typeof r;if(a==="object"&&r!==null)try{JSON.stringify(r),i=r}catch(s){o=Object.prototype.toString.apply(r)}else a==="number"&&(isNaN(r)||!isFinite(r))?o=Object.prototype.toString.apply(r):i=r;return{type:typeof r,value:i,unserializableValue:o}})};this.devTools.event({type:"Runtime.consoleAPICalled",jsonPayload:JSON.stringify([t])}).catch(this.catchHandler)}error(e){let t=this.exceptions.push(e)-1,r,i;try{r=JSON.stringify(e),r==="{}"&&e instanceof Error&&(r=JSON.stringify({message:e.message,name:e.name,stack:e.stack}))}catch(d){i=e.toString()}let o={type:typeof e,value:r,unserializableValue:i},a={timestamp:performance.now(),exceptionDetails:{text:e.toString()+`
`+e.stack,exceptionId:t,columnNumber:0,lineNumber:0,exception:o}};this.devTools.event({type:"Runtime.exceptionThrown",jsonPayload:JSON.stringify([a])}).catch(this.catchHandler)}};f();function ju(n){switch(n.type){case Be.EDT_GENERIC:return{type:n.generic?.eventId||"",data:JSON.parse(n.generic.eventData||"{}")};case Be.EDT_POSITION_CHANGED:return{type:"positionChanged",data:n.positionChanged};case Be.EDT_ROTATION_CHANGED:return{type:"rotationChanged",data:n.rotationChanged}}return{type:"",data:"{}"}}function vh(n){let[e,t]=n.trim().split(/\s*,\s*/).map(r=>parseInt(r,10));return{x:e,y:t}}async function ec(n){let e=self.name,t=await n.createPort(`scene-${e}`),[r,i,o,a]=await Promise.all([vn.EngineApi(t),vn.EnvironmentApi(t),vn.Permissions(t),vn.DevTools(t)]),[d,s]=(await o.hasManyPermissions({permissions:[he.PI_USE_WEBSOCKET,he.PI_USE_FETCH]})).hasManyPermission,l=new ho(a),u={allowOpenExternalUrl:!1},c=[],h=[],p=[],y={events:[]},g=await i.getBootstrapData({}),E=JSON.parse(g.entity?.metadataJson||"{}"),M=await i.isPreviewMode({}),T=await i.areUnsafeRequestAllowed({}),F=await i.getExplorerConfiguration({});if(!E||!E.main)throw new Error("No boostrap data");let V=E.main,ue=g.entity?.content.find(D=>D.file===V);if(!ue)throw await r.sendBatch({actions:[nr()]}),new Error("SDK: Error while loading scene. Main file missing.");let ge=Au(ue.hash,V,g.baseUrl),Se=await fetch(ge);if(!Se.ok)throw await r.sendBatch({actions:[nr()]}),new Error(`SDK: Error while loading ${ge} (${V} -> ${ue?.file}:${ue?.hash}) the mapping was not found`);io.useBinaryTransform=F.configurations.enableBinaryTransform==="true";let xe=!1,qe=1e3/30;async function Fe(){let D=y.events;D.length&&(y.events=[]);let j=await r.sendBatch({actions:D});for(let ce of j.events)Ke(ju(ce))}function Ke(D){if(D.type==="raycastResponse"){let j=parseInt(D.data.queryId,10);Yr[j]&&(D.data.queryId=Yr[j].toString())}if(!xe&&D.type==="sceneStart"){xe=!0;for(let j of p)try{j()}catch(ce){l.error(ce)}}wh(D)&&(u.allowOpenExternalUrl=!0);for(let j of c)try{j(D)}catch(ce){l.error(ce)}u.allowOpenExternalUrl=!1}let Xe=performance.now();function pn(){let D=Math.max(qe-(performance.now()-Xe)|0,0);setTimeout(Z,D)}function Z(){let D=performance.now(),j=D-Xe;Xe=D;let ce=j/1e3;for(let Te of h)try{Te(ce)}catch(hn){l.error(hn)}Fe().catch(l.error).finally(pn)}try{let D=await Se.text(),j=Vu({clientPort:t,onError:Te=>l.error(Te),onLog:(...Te)=>l.log(...Te),sceneId:g.id,eventState:u,batchEvents:y,EngineApi:r,onEventFunctions:c,onStartFunctions:p,onUpdateFunctions:h}),ce=Qu({dcl:j,canUseFetch:s,canUseWebsocket:d,log:j.log,previewMode:M.isPreview||T.status});g.useFPSThrottling===!0&&Zu(j,E.scene.parcels.map(vh),Te=>{qe=Te}),await Xu(D,ce)}catch(D){throw await r.sendBatch({actions:[nr()]}),l.error(new Error(`SceneRuntime: Error while evaluating the scene ${e}`)),await nc(100),D}y.events.push(nr());do await Fe();while(!xe&&await nc(100));Z()}function wh(n){switch(n.type){case"uuidEvent":return n.data?.payload?.buttonId!==void 0}return!1}async function nc(n){return await new Promise(e=>setTimeout(e,Math.max(n|0,0))),!0}(0,tc.createRpcClient)((0,rc.WebWorkerTransport)(self)).then(ec).catch(n=>console.error(n));})();
