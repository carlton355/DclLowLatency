var DCLQuests=(()=>{var b=(r,i)=>()=>(i||(i={exports:{}},r(i.exports,i)),i.exports);var R=b(O=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0});O.fromBase64=O.toBase64=void 0;var U=typeof btoa=="function"?btoa:function(r){return Buffer.from(r).toString("base64")},k=typeof atob=="function"?atob:function(r){return Buffer.from(r,"base64").toString("utf-8")};function G(r){return U(r)}O.toBase64=G;function Q(r){return k(r)}O.fromBase64=Q});var I=b(p=>{"use strict";Object.defineProperty(p,"__esModule",{value:!0});p.DefObf=void 0;var P=R();function B(r){return r.split("").reverse().join("")}p.DefObf=new(function(){function r(){}return r.prototype.obf=function(i){return B(P.toBase64(i)).replace(/=/g,"_")},r.prototype.deobf=function(i){return P.fromBase64(B(i.replace(/_/g,"=")))},r}())});var M=b(y=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0});y.AUTH_METADATA_HEADER=y.AUTH_TIMESTAMP_HEADER=y.AUTH_CHAIN_HEADER_PREFIX=void 0;y.AUTH_CHAIN_HEADER_PREFIX="x-identity-auth-chain-";y.AUTH_TIMESTAMP_HEADER="x-identity-timestamp";y.AUTH_METADATA_HEADER="x-identity-metadata"});var S=b(h=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});h.GivenRewardStatus=h.Visibility=h.ProgressStatus=void 0;var J;(function(r){r.BLOCKED="blocked",r.NOT_STARTED="not_started",r.ON_GOING="on_going",r.COMPLETED="completed",r.FAILED="failed",r.REVERTED="reverted"})(J=h.ProgressStatus||(h.ProgressStatus={}));var V;(function(r){r.VISIBLE="visible",r.VISIBLE_IF_CAN_START="visible_if_can_start",r.SECRET="secret"})(V=h.Visibility||(h.Visibility={}));var x;(function(r){r.OK="ok",r.ALREADY_GIVEN="already_given",r.TASK_ALREADY_COMPLETED="task_already_completed",r.FAILED="failed"})(x=h.GivenRewardStatus||(h.GivenRewardStatus={}))});var F=b(v=>{"use strict";var K=v&&v.__createBinding||(Object.create?function(r,i,t,u){u===void 0&&(u=t),Object.defineProperty(r,u,{enumerable:!0,get:function(){return i[t]}})}:function(r,i,t,u){u===void 0&&(u=t),r[u]=i[t]}),j=v&&v.__exportStar||function(r,i){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(i,t)&&K(i,r,t)};Object.defineProperty(v,"__esModule",{value:!0});j(I(),v);j(M(),v);j(S(),v)});var D=b(w=>{"use strict";var X=w&&w.__awaiter||function(r,i,t,u){function a(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(c){try{n(u.next(c))}catch(l){o(l)}}function f(c){try{n(u.throw(c))}catch(l){o(l)}}function n(c){c.done?e(c.value):a(c.value).then(s,f)}n((u=u.apply(r,i||[])).next())})},Y=w&&w.__generator||function(r,i){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},u,a,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(n){return function(c){return f([n,c])}}function f(n){if(u)throw new TypeError("Generator is already executing.");for(;t;)try{if(u=1,a&&(e=n[0]&2?a.return:n[0]?a.throw||((e=a.return)&&e.call(a),0):a.next)&&!(e=e.call(a,n[1])).done)return e;switch(a=0,e&&(n=[n[0]&2,e.value]),n[0]){case 0:case 1:e=n;break;case 4:return t.label++,{value:n[1],done:!1};case 5:t.label++,a=n[1],n=[0];continue;case 7:n=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(n[0]===6||n[0]===2)){t=0;continue}if(n[0]===3&&(!e||n[1]>e[0]&&n[1]<e[3])){t.label=n[1];break}if(n[0]===6&&t.label<e[1]){t.label=e[1],e=n;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(n);break}e[2]&&t.ops.pop(),t.trys.pop();continue}n=i.call(r,t)}catch(c){n=[6,c],a=0}finally{u=e=0}if(n[0]&5)throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(w,"__esModule",{value:!0});w.flatFetch=void 0;function z(r,i){return X(this,void 0,void 0,function(){var t,u,a,e,o,s,f;return Y(this,function(n){switch(n.label){case 0:return[4,fetch(r,i)];case 1:switch(t=n.sent(),u=(i==null?void 0:i.responseBodyType)||"text",a={},t.headers.forEach(function(c,l){return a[l]=c}),e={ok:t.ok,status:t.status,statusText:t.statusText,headers:a},o=u,o){case"json":return[3,2];case"text":return[3,4]}return[3,6];case 2:return s=e,[4,t.json()];case 3:return s.json=n.sent(),[3,6];case 4:return f=e,[4,t.text()];case 5:return f.text=n.sent(),[3,6];case 6:return[2,e]}})})}w.flatFetch=z});var C=b(d=>{"use strict";var T=d&&d.__assign||function(){return T=Object.assign||function(r){for(var i,t=1,u=arguments.length;t<u;t++){i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(r[a]=i[a])}return r},T.apply(this,arguments)},W=d&&d.__awaiter||function(r,i,t,u){function a(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(c){try{n(u.next(c))}catch(l){o(l)}}function f(c){try{n(u.throw(c))}catch(l){o(l)}}function n(c){c.done?e(c.value):a(c.value).then(s,f)}n((u=u.apply(r,i||[])).next())})},Z=d&&d.__generator||function(r,i){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},u,a,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(n){return function(c){return f([n,c])}}function f(n){if(u)throw new TypeError("Generator is already executing.");for(;t;)try{if(u=1,a&&(e=n[0]&2?a.return:n[0]?a.throw||((e=a.return)&&e.call(a),0):a.next)&&!(e=e.call(a,n[1])).done)return e;switch(a=0,e&&(n=[n[0]&2,e.value]),n[0]){case 0:case 1:e=n;break;case 4:return t.label++,{value:n[1],done:!1};case 5:t.label++,a=n[1],n=[0];continue;case 7:n=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(n[0]===6||n[0]===2)){t=0;continue}if(n[0]===3&&(!e||n[1]>e[0]&&n[1]<e[3])){t.label=n[1];break}if(n[0]===6&&t.label<e[1]){t.label=e[1],e=n;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(n);break}e[2]&&t.ops.pop(),t.trys.pop();continue}n=i.call(r,t)}catch(c){n=[6,c],a=0}finally{u=e=0}if(n[0]&5)throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(d,"__esModule",{value:!0});d.authFetch=void 0;var H=F(),$=D();function tt(r,i,t,u){var a={},e=Date.now(),o=JSON.stringify(t),s=[r.toLowerCase(),i.toLowerCase(),e.toString(),o],f=s.join(":").toLowerCase(),n=u(f);return n.forEach(function(c,l){a[""+H.AUTH_CHAIN_HEADER_PREFIX+l]=JSON.stringify(c)}),a[H.AUTH_TIMESTAMP_HEADER]=e.toString(),a[H.AUTH_METADATA_HEADER]=o,a}function et(r){return function(i,t){var u,a;return W(this,void 0,void 0,function(){var e,o;return Z(this,function(s){return e=new URL(i).pathname,o=T(T({},t),{headers:T(T({},tt((u=t==null?void 0:t.method)!==null&&u!==void 0?u:"get",e,(a=t==null?void 0:t.metadata)!==null&&a!==void 0?a:{},r)),t==null?void 0:t.headers)}),[2,$.flatFetch(i,o)]})})}}d.authFetch=et});var q=b(_=>{"use strict";var E=_&&_.__assign||function(){return E=Object.assign||function(r){for(var i,t=1,u=arguments.length;t<u;t++){i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(r[a]=i[a])}return r},E.apply(this,arguments)},g=_&&_.__awaiter||function(r,i,t,u){function a(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(c){try{n(u.next(c))}catch(l){o(l)}}function f(c){try{n(u.throw(c))}catch(l){o(l)}}function n(c){c.done?e(c.value):a(c.value).then(s,f)}n((u=u.apply(r,i||[])).next())})},A=_&&_.__generator||function(r,i){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},u,a,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(n){return function(c){return f([n,c])}}function f(n){if(u)throw new TypeError("Generator is already executing.");for(;t;)try{if(u=1,a&&(e=n[0]&2?a.return:n[0]?a.throw||((e=a.return)&&e.call(a),0):a.next)&&!(e=e.call(a,n[1])).done)return e;switch(a=0,e&&(n=[n[0]&2,e.value]),n[0]){case 0:case 1:e=n;break;case 4:return t.label++,{value:n[1],done:!1};case 5:t.label++,a=n[1],n=[0];continue;case 7:n=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(n[0]===6||n[0]===2)){t=0;continue}if(n[0]===3&&(!e||n[1]>e[0]&&n[1]<e[3])){t.label=n[1];break}if(n[0]===6&&t.label<e[1]){t.label=e[1],e=n;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(n);break}e[2]&&t.ops.pop(),t.trys.pop();continue}n=i.call(r,t)}catch(c){n=[6,c],a=0}finally{u=e=0}if(n[0]&5)throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(_,"__esModule",{value:!0});_.QuestsClient=void 0;var nt=F(),rt=C(),it=D();function at(r){try{return JSON.parse(r)}catch(i){return r}}var ut=function(){function r(i){var t;this.options=i,this.obf=nt.DefObf,i.authChainProvider?this.fetchFn=rt.authFetch(i.authChainProvider):this.fetchFn=(t=i.fetchFn)!==null&&t!==void 0?t:it.flatFetch}return r.prototype.urlFor=function(i){return""+this.options.baseUrl+i},r.prototype.fetch=function(i,t){return g(this,void 0,void 0,function(){var u,a=this;return A(this,function(e){return(t==null?void 0:t.bodyObject)&&(t.body=JSON.stringify(t.bodyObject),t.obf?(t.body=this.obf.obf(t.body),t.headers=E(E({},t.headers),{"Content-Type":"application/quests"})):t.headers=E(E({},t.headers),{"Content-Type":"application/json"})),u=E(E({},t),{metadata:this.options.metadata,responseBodyType:"text"}),[2,this.fetchFn(this.urlFor(i),u).then(function(o){return g(a,void 0,void 0,function(){var s,f;return A(this,function(n){return s=o.text||"",(t==null?void 0:t.deobf)&&o.ok&&(s=this.obf.deobf(s)),f=at(s),[2,{ok:o.ok,status:o.status,body:f}]})})})]})})},r.prototype.getQuests=function(){return g(this,void 0,void 0,function(){return A(this,function(i){return[2,this.fetch("/quests")]})})},r.prototype.getQuestDetails=function(i){return g(this,void 0,void 0,function(){return A(this,function(t){return[2,this.fetch("/quests/"+i)]})})},r.prototype.startQuest=function(i){return g(this,void 0,void 0,function(){return A(this,function(t){return[2,this.fetch("/s/"+this.obf.obf(i),{method:"post",deobf:!0})]})})},r.prototype.updateArbitraryState=function(i,t){return g(this,void 0,void 0,function(){return A(this,function(u){return[2,this.fetch("/kv/"+this.obf.obf(i),{method:"put",deobf:!0,obf:!0,bodyObject:t})]})})},r.prototype.makeProgress=function(i,t,u){return g(this,void 0,void 0,function(){return A(this,function(a){return[2,this.fetch("/p/"+this.obf.obf(i)+"/"+this.obf.obf(t),{method:"post",deobf:!0,obf:!0,bodyObject:u})]})})},r}();_.QuestsClient=ut});var N=b(m=>{"use strict";var ot=m&&m.__createBinding||(Object.create?function(r,i,t,u){u===void 0&&(u=t),Object.defineProperty(r,u,{enumerable:!0,get:function(){return i[t]}})}:function(r,i,t,u){u===void 0&&(u=t),r[u]=i[t]}),L=m&&m.__exportStar||function(r,i){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(i,t)&&ot(i,r,t)};Object.defineProperty(m,"__esModule",{value:!0});L(q(),m);L(S(),m)});return N();})();
